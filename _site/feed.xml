<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>éä¸“ä¸šç¨‹åºå‘˜</title>
    <description>Hello-World</description>
    <link>http://localhost:4000/</link>
    <atom:link href="http://localhost:4000/feed.xml" rel="self" type="application/rss+xml" />
    <pubDate>Sun, 19 Oct 2025 22:40:40 +0800</pubDate>
    <lastBuildDate>Sun, 19 Oct 2025 22:40:40 +0800</lastBuildDate>
    <generator>Jekyll v3.8.5</generator>
    
      <item>
        <title>æ·±å…¥ç†è§£iOS CoreText API</title>
        <description>&lt;p&gt;è¿™ç¯‡æ–‡ç« æ˜¯ä»0åˆ°1è‡ªå®šä¹‰å¯Œæ–‡æœ¬æ¸²æŸ“çš„åŸç†ç¯‡ä¹‹ä¸€ï¼Œæ­¤å¤–ä½ è¿˜å¯èƒ½æ„Ÿå…´è¶£ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://mp.weixin.qq.com/s/EYPO3sSjtIstD3RmlRCs9w&quot;&gt;ä¸€æ–‡è¯»æ‡‚å­—ç¬¦ä¸ç¼–ç &lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://mp.weixin.qq.com/s/96YJGYKLoxENC4qT9tYNoQ&quot;&gt;ä¸€æ–‡è¯»æ‡‚å­—ç¬¦ã€å­—å½¢ã€å­—ä½“&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://mp.weixin.qq.com/s/D0A8HAQaQNart7KAdWXyJg&quot;&gt;ä¸€æ–‡è¯»æ‡‚å­—ä½“æ–‡ä»¶&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://mp.weixin.qq.com/s/fcL6if52qYQUTChEjntHJg&quot;&gt;ä»0åˆ°1è‡ªå®šä¹‰æ–‡å­—æ’ç‰ˆå¼•æ“ï¼šåŸç†ç¯‡&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://mp.weixin.qq.com/s/EpaNjLcG6DZBc128A2gdIQ&quot;&gt;é€†å‘åˆ†æCoreTextä¸­çš„å­—ä½“çº§è”/Font Fallbackæœºåˆ¶&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://mp.weixin.qq.com/s/1oOSJkTIJ8njV49B6PsfgA&quot;&gt;æ–°æ‰‹å°ç™½ä¹Ÿèƒ½çœ‹æ‡‚çš„LLDBæŠ€å·§/é€†å‘æŠ€å·§&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;æ›´å¤šå†…å®¹å¯è®¢é˜…å…¬ä¼—å·ã€Œéä¸“ä¸šç¨‹åºå‘˜Pingã€ï¼Œæ–‡ä¸­æ‰€æœ‰ä»£ç å¯åœ¨å…¬ä¼—å·åå°å›å¤ â€œCoreTextâ€ è·å–ã€‚&lt;/p&gt;

&lt;h1 id=&quot;ä¸€å¼•è¨€&quot;&gt;ä¸€ã€å¼•è¨€&lt;/h1&gt;

&lt;p&gt;CoreTextæ˜¯iOS/macOSä¸­çš„æ–‡å­—æ’ç‰ˆå¼•æ“ï¼Œæä¾›äº†ä¸€ç³»åˆ—å¯¹æ–‡æœ¬ç²¾ç¡®æ“ä½œçš„APIï¼›UIKitä¸­UILabelã€UITextViewç­‰æ–‡æœ¬ç»„ä»¶åº•å±‚éƒ½æ˜¯åŸºäºCoreTextçš„ï¼Œå¯ä»¥çœ‹å®˜æ–¹æä¾›çš„å±‚çº§å›¾ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://lk9v5zgfb4.feishu.cn/space/api/box/stream/download/asynccode/?code=NzEzNDNiNmRiMWNjNTA1OTgzOWE0ZDZjMjgxNmUyODlfdTZzbzZMZGk3U0dRRG9UQ0lNTjI1QUJ2SDNpcGJxeXhfVG9rZW46Q1RrY2JYeDJQb0NEM3N4QmxxMGNVcVVxbjRmXzE3NjA4Nzc2MjY6MTc2MDg4MTIyNl9WNA&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;æœ¬æ–‡çš„ç›®çš„æ˜¯ç»“åˆå®é™…ä½¿ç”¨ä¾‹å­ï¼Œæ¥ä»‹ç»å’Œæ€»ç»“CoreTextä¸­çš„é‡è¦æ¦‚å¿µå’ŒAPIã€‚&lt;/p&gt;

&lt;h1 id=&quot;äºŒé‡è¦æ¦‚å¿µ&quot;&gt;äºŒã€é‡è¦æ¦‚å¿µ&lt;/h1&gt;

&lt;p&gt;CoreTextä¸­æœ‰å‡ ä¸ªé‡è¦æ¦‚å¿µï¼šCTTypesetterã€CTFramesetterã€CTFrameã€CTLineã€CTRunï¼›å®ƒä»¬ä¹‹é—´çš„å…³ç³»å¯ä»¥çœ‹å®˜æ–¹æä¾›çš„å±‚çº§å›¾ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://lk9v5zgfb4.feishu.cn/space/api/box/stream/download/asynccode/?code=MGJhNmI2NDlmZDU0ODM2YTNlZDU4MjQ2YzM5MjkyZWJfZzFWV2tjY0tKdW5nSWQxWnZZUHF5TUhkbkY1SGl0RVNfVG9rZW46WE5tSWJYTDhVbzc1M3J4RnRwdmNCUlczbnRjXzE3NjA4Nzc2MjY6MTc2MDg4MTIyNl9WNA&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ä¸€ç¯‡æ–‡æ¡£å¯ä»¥åˆ†ä¸ºï¼šæ–‡æ¡£ -&amp;gt; æ®µè½ -&amp;gt; æ®µè½ä¸­çš„è¡Œ -&amp;gt; è¡Œä¸­çš„æ–‡å­—ï¼Œç±»ä¼¼çš„ï¼ŒCoreTextä¹Ÿæ˜¯æŒ‰è¿™ä¸ªç»“æ„æ¥ç»„ç»‡å’Œç®¡ç†APIçš„ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æ ¹æ®è¯‰æ±‚æ¥é€‰æ‹©ä¸åŒå±‚çº§çš„APIã€‚&lt;/p&gt;

&lt;h2 id=&quot;21-ctframesetter&quot;&gt;2.1 CTFramesetter&lt;/h2&gt;

&lt;p&gt;CTFramesetterç±»ä¼¼äºæ–‡æ¡£çš„æ¦‚å¿µï¼Œå®ƒè´Ÿè´£å°†å¤šæ®µæ–‡æœ¬è¿›è¡Œæ’ç‰ˆï¼Œç®¡ç†å¤šä¸ªæ®µè½ï¼ˆCTFrameï¼‰ã€‚&lt;/p&gt;

&lt;p&gt;CTFramesetterçš„è¾“å…¥æ˜¯å±æ€§å­—ç¬¦ä¸²ï¼ˆNSAttributedStringï¼‰å’Œè·¯å¾„ï¼ˆCGPathï¼‰ï¼Œè´Ÿè´£å°†æ–‡æœ¬åœ¨æŒ‡å®šè·¯å¾„ä¸Šè¿›è¡Œæ’ç‰ˆã€‚&lt;/p&gt;

&lt;h2 id=&quot;22-ctframe&quot;&gt;2.2 CTFrame&lt;/h2&gt;

&lt;p&gt;CTFrameç±»ä¼¼äºæ®µè½çš„æ¦‚å¿µï¼Œå…¶ä¸­åŒ…å«äº†è‹¥å¹²è¡Œï¼ˆCTLineï¼‰ä»¥åŠå¯¹åº”è¡Œçš„ä½ç½®ã€æ–¹å‘ã€è¡Œé—´è·ç­‰ä¿¡æ¯ã€‚&lt;/p&gt;

&lt;h2 id=&quot;23-ctline&quot;&gt;2.3 CTLine&lt;/h2&gt;

&lt;p&gt;CTLineç±»ä¼¼äºè¡Œçš„æ¦‚å¿µï¼Œå…¶ä¸­åŒ…å«äº†è‹¥å¹²ä¸ªå­—å½¢ï¼ˆCTRunï¼‰ä»¥åŠå¯¹åº”å­—å½¢çš„ä½ç½®ç­‰ä¿¡æ¯ã€‚&lt;/p&gt;

&lt;h2 id=&quot;24-ctrun&quot;&gt;2.4 CTRun&lt;/h2&gt;

&lt;p&gt;éœ€è¦æ³¨æ„CTRunä¸æ˜¯å•ä¸ªçš„å­—ç¬¦ï¼Œè€Œæ˜¯&lt;strong&gt;ä¸€æ®µè¿ç»­çš„ä¸”å…·æœ‰ç›¸åŒå±æ€§ï¼ˆå­—ä½“ã€é¢œè‰²ç­‰ï¼‰çš„å­—å½¢ï¼ˆGlyphï¼‰ã€‚&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;å¦‚ä¸‹ï¼Œæ¯ä¸ªè™šçº¿æ¡†éƒ½ä»£è¡¨ä¸€ä¸ªCTRunï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/post/æ·±å…¥ç†è§£CoreText/CTRun.png&quot; alt=&quot;CTRun&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;25-cttypesetter&quot;&gt;2.5 CTTypesetter&lt;/h2&gt;

&lt;p&gt;CTTypesetteræ”¯æŒå¯¹å±æ€§å­—ç¬¦ä¸²è¿›è¡Œæ¢è¡Œï¼Œå¯ä»¥é€šè¿‡CTTypesetteræ¥è‡ªå®šä¹‰æ¢è¡Œï¼ˆæ¯”å¦‚æŒ‰wordæ¢è¡Œã€æŒ‰charæ¢è¡Œç­‰ï¼‰æˆ–æ§åˆ¶æ¯è¡Œçš„å†…å®¹ï¼Œå¯ä»¥ç†è§£æˆæ›´ç²¾ç»†åŒ–çš„æ§åˆ¶ã€‚&lt;/p&gt;

&lt;h1 id=&quot;ä¸‰é‡è¦api&quot;&gt;ä¸‰ã€é‡è¦API&lt;/h1&gt;

&lt;h2 id=&quot;31-ctframesetter&quot;&gt;3.1 CTFramesetter&lt;/h2&gt;

&lt;p&gt;&lt;strong&gt;1ï¼‰CTFramesetterCreateWithAttributedString&lt;/strong&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-Swift&quot;&gt;func CTFramesetterCreateWithAttributedString(_ attrString: CFAttributedString) -&amp;gt; CTFramesetter
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;é€šè¿‡å±æ€§å­—ç¬¦ä¸²æ¥åˆ›å»ºCTFramesetterã€‚&lt;/p&gt;

&lt;p&gt;æˆ‘ä»¬å¯ä»¥æ„é€ ä¸åŒå­—ä½“ã€é¢œè‰²ã€å¤§å°çš„å±æ€§å­—ç¬¦ä¸²ï¼Œç„¶åä»å±æ€§å­—ç¬¦ä¸²æ„é€ CTFramesetterï¼Œä¹‹åå¯ä»¥ç»§ç»­å¾€ä¸‹æ‹†åˆ†å¾—åˆ°æ®µè½ã€è¡Œã€å­—å½¢ç­‰ä¿¡æ¯ï¼Œè¿™æ ·å¯ä»¥å®ç°è‡ªå®šä¹‰æ’ç‰ˆã€å›¾æ–‡æ··æ’ç­‰å¤æ‚å¯Œæ–‡æœ¬æ ·å¼ã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;2ï¼‰CTFramesetterCreateWithTypesetter&lt;/strong&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-Swift&quot;&gt;func CTFramesetterCreateWithTypesetter(_ typesetter: CTTypesetter) -&amp;gt; CTFramesetter
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;é€šè¿‡CTTypesetteræ¥åˆ›å»ºCTFramesetterï¼Œå½“æˆ‘ä»¬éœ€è¦å¯¹æ–‡æœ¬å®ç°æ›´ç²¾ç»†æ§åˆ¶ï¼Œæ¯”å¦‚è‡ªå®šä¹‰æ¢è¡Œæ—¶ï¼Œå¯ä»¥è‡ªå·±æ„é€ CTTypesetterã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;3ï¼‰CTFramesetterCreateFrame&lt;/strong&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-Swift&quot;&gt;func CTFramesetterCreateFrame(
    _ framesetter: CTFramesetter,
    _ stringRange: CFRange,
    _ path: CGPath,
    _ frameAttributes: CFDictionary?
) -&amp;gt; CTFrame
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ç”ŸæˆCTFrameï¼šåœ¨æŒ‡å®šè·¯å¾„ï¼ˆpathï¼‰ä¸ºå±æ€§å­—ç¬¦ä¸²çš„æŒ‡å®šèŒƒå›´ï¼ˆstringRangeï¼‰ç”ŸæˆCTFrameã€‚&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;framesetter&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;stringRange&lt;/code&gt;ï¼šå­—ç¬¦èŒƒå›´ï¼Œæ³¨æ„éœ€è¦ä»¥UTF-16ç¼–ç æ ¼å¼è®¡ç®—ï¼›å½“ stringRange.length = 0 æ—¶ï¼Œè¡¨ç¤ºä»èµ·ç‚¹ï¼ˆstringRange.locationï¼‰åˆ°å­—ç¬¦ç»“æŸä¸ºæ­¢ï¼›æ¯”å¦‚å½“ CFRangeMake(0, 0) è¡¨ç¤ºå…¨å­—ç¬¦èŒƒå›´&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;path&lt;/code&gt;ï¼šæ’ç‰ˆè·¯å¾„ï¼Œå¯ä»¥æ˜¯ä¸è§„åˆ™çŸ©å½¢ï¼Œè¿™æ„å‘³ç€å¯ä»¥ä¼ å…¥ä¸è§„åˆ™å›¾å½¢æ¥å®ç°æ–‡å­—ç¯ç»•ç­‰é«˜çº§æ•ˆæœ&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;frameAttributes&lt;/code&gt;ï¼šä¸€ä¸ªå¯é€‰çš„å­—å…¸ï¼Œå¯ä»¥ç”¨äºæ§åˆ¶æ®µè½çº§åˆ«çš„å¸ƒå±€è¡Œä¸ºï¼Œæ¯”å¦‚è¡Œé—´è·ç­‰ï¼Œä¸€èˆ¬ç”¨ä¸åˆ°ï¼Œå¯ä¼  nil&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;4ï¼‰CTFramesetterSuggestFrameSizeWithConstraints&lt;/strong&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-Swift&quot;&gt;func CTFramesetterSuggestFrameSizeWithConstraints(
    _ framesetter: CTFramesetter,
    _ stringRange: CFRange,
    _ frameAttributes: CFDictionary?,
    _ constraints: CGSize,
    _ fitRange: UnsafeMutablePointer&amp;lt;CFRange&amp;gt;?
) -&amp;gt; CGSize
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è®¡ç®—æ–‡æœ¬å®½é«˜ï¼šåœ¨ç»™å®šçº¦æŸå°ºå¯¸ï¼ˆconstraintsï¼‰ä¸‹è®¡ç®—æ–‡æœ¬èŒƒå›´ï¼ˆstringRangeï¼‰çš„å®é™…å®½é«˜ã€‚&lt;/p&gt;

&lt;p&gt;å¦‚ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥è®¡ç®—å‡ºåœ¨å®½é«˜ 100 x 100 çš„èŒƒå›´å†…æ’ç‰ˆï¼Œå®é™…èƒ½æ”¾ä¸‹çš„æ–‡æœ¬èŒƒå›´ï¼ˆfitRangeï¼‰ä»¥åŠå®é™…çš„æ–‡æœ¬å°ºå¯¸ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-Swift&quot;&gt;let attr = NSAttributedString(string: &quot;è¿™æ˜¯ä¸€æ®µæµ‹è¯•æ–‡æœ¬ï¼Œé€šè¿‡è°ƒç”¨CTFramesetterSuggestFrameSizeWithConstraintsæ¥è®¡ç®—æ–‡æœ¬çš„å®½é«˜ä¿¡æ¯ï¼Œå¹¶è¿”å›å®é™…çš„range&quot;, attributes: [
    .font: UIFont.systemFont(ofSize: 16),
    .foregroundColor: UIColor.black
])
let framesetter = CTFramesetterCreateWithAttributedString(attr)
var fitRange = CFRange(location: 0, length: 0)
let size = CTFramesetterSuggestFrameSizeWithConstraints(
    framesetter,
    CFRangeMake(0, 0),
    nil,
    CGSize(width: 100, height: 100),
    &amp;amp;fitRange
)
print(size, fitRange, attr.length)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¿™ä¸ªAPIåœ¨åˆ†é¡µæ—¶éå¸¸æœ‰ç”¨ï¼Œæ¯”å¦‚å¾®ä¿¡è¯»ä¹¦çš„ç¿»é¡µæ•ˆæœï¼Œéœ€è¦çŸ¥é“åœ¨å“ªä¸ªåœ°æ–¹æˆªæ–­ï¼ŒPDFçš„åˆ†é¡µæ’ç‰ˆç­‰ã€‚&lt;/p&gt;

&lt;h3 id=&quot;311-ctframesetterä½¿ç”¨ç¤ºä¾‹&quot;&gt;3.1.1 CTFramesetterä½¿ç”¨ç¤ºä¾‹&lt;/h3&gt;

&lt;p&gt;&lt;strong&gt;1ï¼‰å®ç°ä¸€ä¸ªæ”¯æŒAutoLayoutä¸”é«˜åº¦é å†…å®¹æ’‘å¼€çš„å¯Œæ–‡æœ¬View&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://lk9v5zgfb4.feishu.cn/space/api/box/stream/download/asynccode/?code=Mzc4YmRjMzQxZTdhM2ZmZDYxODIxYTRkNjUyZDU1ZGRfV2hMUHBaTk8yZ1o4RnlZZFNreWw3c1lIVEtQSHVkTnBfVG9rZW46RmNrN2JkOFlXb3dmaHV4bllHNmNwdmpqblFlXzE3NjA4Nzc2MjY6MTc2MDg4MTIyNl9WNA&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;2ï¼‰åœ¨åœ†å½¢è·¯å¾„ä¸­ç»˜åˆ¶æ–‡æœ¬&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://lk9v5zgfb4.feishu.cn/space/api/box/stream/download/asynccode/?code=M2I0NzA4ODA4OGUzOTAxMmYyNGQ4MjM0NzFiMDg4YmZfOGdRdVA4aUk5UUNvZ3FpclIzSlY5SVNuaHNzdXVpODlfVG9rZW46TzFiOWJzQlRUb1FuVmZ4cjhBNWNIZzl4blR0XzE3NjA4Nzc2MjY6MTc2MDg4MTIyNl9WNA&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;3ï¼‰æ–‡æœ¬åˆ†é¡µï¼šæ¨¡æ‹Ÿå¾®ä¿¡è¯»ä¹¦çš„åˆ†é¡µé€»è¾‘&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://lk9v5zgfb4.feishu.cn/space/api/box/stream/download/asynccode/?code=YTJlZGY5YjRkNjIxNDVkMzgxMGY5YWE5NjJkNGQ3OTdfa3hTYzNwZTV2UWx3bENCTWpLMHZodHdFckFxRUU0TThfVG9rZW46RXBNeWI4UGw4b0Y4dGp4UGVhQ2N0VE0ybkhkXzE3NjA4Nzc2MjY6MTc2MDg4MTIyNl9WNA&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;32-ctframe&quot;&gt;3.2 CTFrame&lt;/h2&gt;

&lt;p&gt;&lt;strong&gt;1ï¼‰CTFramesetterCreateFrame&lt;/strong&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-Swift&quot;&gt;func CTFramesetterCreateFrame(
    _ framesetter: CTFramesetter,
    _ stringRange: CFRange,
    _ path: CGPath,
    _ frameAttributes: CFDictionary?
) -&amp;gt; CTFrame
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;åˆ›å»ºCTFrameï¼Œåœ¨CTFramesetterä¸€èŠ‚ä¸­æœ‰ä»‹ç»è¿‡ï¼Œè¿™æ˜¯åˆ›å»ºCTFrameçš„å”¯ä¸€æ–¹å¼ã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;2ï¼‰CTFrameGetStringRange&lt;/strong&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-Swift&quot;&gt;func CTFrameGetStringRange(_ frame: CTFrame) -&amp;gt; CFRange
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è·å–CTFrameåŒ…å«çš„å­—ç¬¦èŒƒå›´ã€‚&lt;/p&gt;

&lt;p&gt;æˆ‘ä»¬åœ¨è°ƒç”¨CTFramesetterCreateFrameåˆ›å»ºCTFrameæ—¶ï¼Œä¼šä¼ å…¥ä¸€ä¸ª stringRange çš„å‚æ•°ï¼ŒCTFrameGetStringRangeä¹Ÿå¯ä»¥ç†è§£æˆè·å–è¿™ä¸ª stringRangeï¼ŒåŒºåˆ«æ˜¯å¤„ç†äº†å½“ stringRange.length ä¸º0çš„æƒ…å†µã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;3ï¼‰CTFrameGetVisibleStringRange&lt;/strong&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-Swift&quot;&gt;func CTFrameGetVisibleStringRange(_ frame: CTFrame) -&amp;gt; CFRange
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è·å–CTFrameå®é™…å¯è§çš„å­—ç¬¦èŒƒå›´ã€‚&lt;/p&gt;

&lt;p&gt;æˆ‘ä»¬åœ¨è°ƒç”¨CTFramesetterCreateFrameåˆ›å»ºCTFrameæ—¶ï¼Œä¼šä¼ å…¥pathï¼Œå¯èƒ½ä¼šæŠŠå­—ç¬¦æˆªæ–­ï¼ŒCTFrameGetVisibleStringRangeè¿”å›çš„å°±æ˜¯å¯è§çš„å­—ç¬¦èŒƒå›´ã€‚&lt;/p&gt;

&lt;p&gt;éœ€è¦æ³¨æ„å’ŒCTFrameGetStringRangeè¿›è¡ŒåŒºåˆ†ï¼Œå¯ä»¥ç”¨å¦‚ä¸‹DemoéªŒè¯ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-Swift&quot;&gt;let longText = String(repeating: &quot;è¿™æ˜¯ä¸€ä¸ªåˆ†æ å¸ƒå±€çš„ä¾‹å­ã€‚Core Text å…è®¸æˆ‘ä»¬å°†ä¸€ä¸ªé•¿çš„å±æ€§å­—ç¬¦ä¸²ï¼ˆCFAttributedStringï¼‰æµåŠ¨åˆ°å¤šä¸ªä¸åŒçš„è·¯å¾„ï¼ˆCGPathï¼‰ä¸­ã€‚æˆ‘ä»¬åªéœ€è¦åˆ›å»ºä¸€ä¸ª CTFramesetterï¼Œç„¶åå¾ªç¯è°ƒç”¨ CTFramesetterCreateFrameã€‚æ¯æ¬¡è°ƒç”¨åï¼Œæˆ‘ä»¬ä½¿ç”¨ CTFrameGetStringRange æ¥æ‰¾å‡ºæœ‰å¤šå°‘æ–‡æœ¬è¢«æ’å…¥äº†å½“å‰çš„æ¡†æ¶ï¼Œç„¶åå°†ä¸‹ä¸€ä¸ªæ¡†æ¶çš„èµ·å§‹ç´¢å¼•è®¾ç½®ä¸ºè¿™ä¸ªèŒƒå›´çš„æœ«å°¾ã€‚ &quot;, count: 10)
let attributedText = NSAttributedString(string: longText, attributes: [
    .font: UIFont.systemFont(ofSize: 12),
    .foregroundColor: UIColor.darkText
])
let framesetter = CTFramesetterCreateWithAttributedString(attributedText as CFAttributedString)
let path = CGPath(rect: .init(x: 10, y: 100, width: 400, height: 200), transform: nil)
let frame = CTFramesetterCreateFrame(
    framesetter,
    CFRange(location: 100, length: 0),
    path,
    nil
)
// è¾“å‡ºï¼šCFRange(location: 100, length: 1980)
print(CTFrameGetStringRange(frame))
// è¾“å‡ºï¼šCFRange(location: 100, length: 584)
print(CTFrameGetVisibleStringRange(frame))
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;strong&gt;4ï¼‰CTFrameGetPath&lt;/strong&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-Swift&quot;&gt;func CTFrameGetPath(_ frame: CTFrame) -&amp;gt; CGPath
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è·å–åˆ›å»ºCTFrameæ—¶ä¼ å…¥çš„pathã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;5ï¼‰CTFrameGetLines&lt;/strong&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-Swift&quot;&gt;func CTFrameGetLines(_ frame: CTFrame) -&amp;gt; CFArray
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è·å–CTFrameä¸­æ‰€æœ‰çš„è¡Œï¼ˆCTLineï¼‰ã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;6ï¼‰CTFrameGetLineOrigins&lt;/strong&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-Swift&quot;&gt;func CTFrameGetLineOrigins(
    _ frame: CTFrame,
    _ range: CFRange,
    _ origins: UnsafeMutablePointer&amp;lt;CGPoint&amp;gt;
)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è·å–æ¯ä¸€è¡Œçš„èµ·ç‚¹åæ ‡ã€‚&lt;/p&gt;

&lt;p&gt;ç”¨æ³•ç¤ºä¾‹ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-Swift&quot;&gt;let lines = CTFrameGetLines(frame) as! [CTLine]
var origins = [CGPoint](repeating: .zero, count: lines.count)
CTFrameGetLineOrigins(frame, CFRangeMake(0, 0), &amp;amp;origins)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;strong&gt;7ï¼‰CTFrameDraw&lt;/strong&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-Swift&quot;&gt;func CTFrameDraw(
    _ frame: CTFrame,
    _ context: CGContext
)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ç»˜åˆ¶CTFrameã€‚&lt;/p&gt;

&lt;h3 id=&quot;321-ctframeä½¿ç”¨ç¤ºä¾‹&quot;&gt;3.2.1 CTFrameä½¿ç”¨ç¤ºä¾‹&lt;/h3&gt;

&lt;p&gt;&lt;strong&gt;1ï¼‰ç»˜åˆ¶CTFrame&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://lk9v5zgfb4.feishu.cn/space/api/box/stream/download/asynccode/?code=Yzc3YzE1YTFmZjJiOGY5NjE3ZGY2YWI2ZTVhMWE1ZmVfVUtqQVB3eEU3QWtsQ3JlcWJ2VDFwOXRFZkViQ2FHV0ZfVG9rZW46TXhlM2J0T0Nlb3NPTTJ4MWpuaGN2R0ZNbnhjXzE3NjA4Nzc2MjY6MTc2MDg4MTIyNl9WNA&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;2ï¼‰é«˜äº®æŸä¸€è¡Œ&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://lk9v5zgfb4.feishu.cn/space/api/box/stream/download/asynccode/?code=OGY4MzMxMjYxYWE4NTdjYzcyMDZiNjc2OGE0MzBjZjRfQzExaE44ZzNjaG8wRmtaeGZIcnJ1QmNWYWJ4WldtbGtfVG9rZW46U0FZQ2JXTXhBb2JNWDd4eDVGZmN0Rk5zbmlnXzE3NjA4Nzc2MjY6MTc2MDg4MTIyNl9WNA&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;3ï¼‰æ£€æµ‹ç‚¹å‡»å­—ç¬¦&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://lk9v5zgfb4.feishu.cn/space/api/box/stream/download/asynccode/?code=MzFkZGU0MjBkMmUxMjg5NDRjZTJlM2E2MDdhOWZiYjdfRmttZVJyNXJIUkdWblZpQjRESlFzd2VPYVE4bmlXd3VfVG9rZW46U0JvRmJpRzhyb1h4RGF4dHNaaWNraTdjbmpoXzE3NjA4Nzc2MjY6MTc2MDg4MTIyNl9WNA&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;33-ctline&quot;&gt;3.3 CTLine&lt;/h2&gt;

&lt;p&gt;&lt;strong&gt;1ï¼‰CTLineCreateWithAttributedString&lt;/strong&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-Swift&quot;&gt;func CTLineCreateWithAttributedString(_ attrString: CFAttributedString) -&amp;gt; CTLine
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ä»å±æ€§å­—ç¬¦ä¸²åˆ›å»º&lt;strong&gt;å•è¡Œ&lt;/strong&gt;CTLineï¼Œå¦‚æœå­—ç¬¦ä¸²ä¸­æœ‰æ¢è¡Œç¬¦ï¼ˆ\nï¼‰çš„è¯ï¼Œæ¢è¡Œç¬¦ä¼šè¢«è½¬æ¢æˆç©ºæ ¼ï¼Œå¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-Swift&quot;&gt;let line = CTLineCreateWithAttributedString(
    NSAttributedString(string: &quot;Hello CoreText\nWorld&quot;, attributes: [.font: UIFont.systemFont(ofSize: 16)])
)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;strong&gt;2ï¼‰CTLineCreateTruncatedLine&lt;/strong&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-Swift&quot;&gt;func CTLineCreateTruncatedLine(
    _ line: CTLine,
    _ width: Double,
    _ truncationType: CTLineTruncationType,
    _ truncationToken: CTLine?
) -&amp;gt; CTLine?
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;åˆ›å»ºä¸€ä¸ªè¢«æˆªæ–­çš„æ–°è¡Œã€‚&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;line&lt;/code&gt;ï¼šå¾…æˆªæ–­çš„è¡Œ&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;width&lt;/code&gt;ï¼šåœ¨å¤šå°‘å®½åº¦æˆªæ–­&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;truncationType&lt;/code&gt;ï¼šstart/end/middleï¼Œæˆªæ–­ç±»å‹&lt;/li&gt;
  &lt;li&gt;truncationTokenï¼šåœ¨æˆªæ–­å¤„æ·»åŠ çš„å­—ç¬¦ï¼Œnilè¡¨ç¤ºä¸æ·»åŠ ï¼Œä¸€èˆ¬ä½¿ç”¨çœç•¥ç¬¦ï¼ˆâ€¦ï¼‰&lt;/li&gt;
&lt;/ul&gt;

&lt;pre&gt;&lt;code class=&quot;language-Swift&quot;&gt;let truncationToken = CTLineCreateWithAttributedString(
    NSAttributedString(string: &quot;â€¦&quot;, attributes: [.font: UIFont.systemFont(ofSize: 16)])
)
let truncated = CTLineCreateTruncatedLine(line, 100, .end, truncationToken)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;strong&gt;3ï¼‰CTLineCreateJustifiedLine&lt;/strong&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-Swift&quot;&gt;func CTLineCreateJustifiedLine(
    _ line: CTLine,
    _ justificationFactor: CGFloat,
    _ justificationWidth: Double
) -&amp;gt; CTLine?
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;åˆ›å»ºä¸€ä¸ªä¸¤ç«¯å¯¹é½çš„æ–°è¡Œï¼Œç±»ä¼¼ä¹¦ç±æˆ–æŠ¥çº¸ä¸­ä¸¤ç«¯å¯¹é½çš„æ’ç‰ˆæ•ˆæœã€‚&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;line&lt;/code&gt;ï¼šåŸå§‹è¡Œ&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;justificationFactor&lt;/code&gt;ï¼š&lt;code class=&quot;highlighter-rouge&quot;&gt;justificationFactor &amp;lt;= 0&lt;/code&gt;è¡¨ç¤ºä¸ç¼©æ”¾ï¼Œå³ä¸åŸå§‹è¡Œç›¸åŒï¼›&lt;code class=&quot;highlighter-rouge&quot;&gt;justificationFactor &amp;gt;= 1&lt;/code&gt;è¡¨ç¤ºå®Œå…¨ç¼©æ”¾åˆ°æŒ‡å®šå®½åº¦ï¼›&lt;code class=&quot;highlighter-rouge&quot;&gt;0 &amp;lt; justificationFactor &amp;lt; 1&lt;/code&gt;è¡¨ç¤ºéƒ¨åˆ†ç¼©æ”¾åˆ°æŒ‡å®šå®½åº¦ï¼Œå¯ä»¥çœ‹ç¤ºä¾‹ä»£ç &lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;justificationWidth&lt;/code&gt;ï¼šç¼©æ”¾æŒ‡å®šå®½åº¦&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ç¤ºä¾‹ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://lk9v5zgfb4.feishu.cn/space/api/box/stream/download/asynccode/?code=ZTYwMGVkMjhkY2YzOWQ3ZTg3ZDc4OTNlYzQ5YmFjNWNfMXpWbGNJcDFRakk4bmVJNjJOa1dEWXFlU2RkZGpaNnpfVG9rZW46T1dPbmJ4bHZPb3NCZEJ4VkExZ2MxWjVZbjhiXzE3NjA4Nzc2MjY6MTc2MDg4MTIyNl9WNA&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;4ï¼‰CTLineDraw&lt;/strong&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-Swift&quot;&gt;func CTLineDraw(
    _ line: CTLine,
    _ context: CGContext
)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ç»˜åˆ¶è¡Œã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;5ï¼‰CTLineGetGlyphCount&lt;/strong&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-Swift&quot;&gt;func CTLineGetGlyphCount(_ line: CTLine) -&amp;gt; CFIndex
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è·å–è¡Œå†…å­—å½¢æ€»æ•°ã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;6ï¼‰CTLineGetGlyphRuns&lt;/strong&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-Swift&quot;&gt;func CTLineGetGlyphRuns(_ line: CTLine) -&amp;gt; CFArray
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è·å–è¡Œå†…æ‰€æœ‰çš„CTRunã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;7ï¼‰CTLineGetStringRange&lt;/strong&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-Swift&quot;&gt;func CTLineGetStringRange(_ line: CTLine) -&amp;gt; CFRange
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è·å–è¯¥è¡Œå¯¹åº”çš„å­—ç¬¦èŒƒå›´ã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;8ï¼‰CTLineGetPenOffsetForFlush&lt;/strong&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-Swift&quot;&gt;func CTLineGetPenOffsetForFlush(
    _ line: CTLine,
    _ flushFactor: CGFloat,
    _ flushWidth: Double
) -&amp;gt; Double
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è·å–åœ¨æŒ‡å®šå®½åº¦ç»˜åˆ¶æ—¶çš„æ°´å¹³åç§»ï¼Œä¸€èˆ¬é…åˆ CGContext.textPosition ä½¿ç”¨ï¼Œå¯ç”¨äºå®ç°åœ¨å›ºå®šå®½åº¦ä¸‹æ–‡æœ¬çš„å·¦å¯¹é½ã€å³å¯¹é½ã€å±…ä¸­å¯¹é½åŠè‡ªå®šä¹‰æ°´å¹³åç§»ç­‰ã€‚&lt;/p&gt;

&lt;p&gt;ç¤ºä¾‹ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://lk9v5zgfb4.feishu.cn/space/api/box/stream/download/asynccode/?code=MjdkYjRmN2VhZDljNzlkOGJlM2YwOTE2MjY0ZjYwZjZfUnA3UEpkUFFDWUlUajdRRkp1d0NEd1lBejBMTnVRSk5fVG9rZW46RmFQSGJ6UG9wb1lSckt4WUg3V2N3WjhvbndlXzE3NjA4Nzc2MjY6MTc2MDg4MTIyNl9WNA&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;9ï¼‰CTLineGetImageBounds&lt;/strong&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-Swift&quot;&gt;func CTLineGetImageBounds(
    _ line: CTLine,
    _ context: CGContext?
) -&amp;gt; CGRect
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è·å–è¡Œçš„&lt;strong&gt;è§†è§‰è¾¹ç•Œ&lt;/strong&gt;ï¼›æ³¨æ„ CTLineGetImageBounds è·å–çš„æ˜¯&lt;strong&gt;ç›¸å¯¹äºCTLineå±€éƒ¨åæ ‡ç³»çš„çŸ©å½¢&lt;/strong&gt;ï¼Œå³ä»¥textPositionä¸ºåŸç‚¹çš„çŸ©å½¢ã€‚&lt;/p&gt;

&lt;p&gt;è§†è§‰è¾¹ç•Œå¯ä»¥çœ‹ä¸‹é¢çš„ä¾‹å­ï¼Œä¸ä¹‹ç›¸å¯¹çš„æ˜¯å¸ƒå±€è¾¹ç•Œï¼›è¿™ä¸ªAPIåœ¨å®é™…åº”ç”¨ä¸­ä¸å¸¸è§ï¼Œé™¤éæœ‰ç‰¹æ®Šè¯‰æ±‚ï¼Œæ¯”å¦‚è¦æ£€æµ‹ç²¾ç¡®çš„å†…å®¹ç‚¹å‡»èŒƒå›´ï¼Œç»™è¡Œç»˜åˆ¶ç´§è´´èƒŒæ™¯ç­‰ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://lk9v5zgfb4.feishu.cn/space/api/box/stream/download/asynccode/?code=MTliN2NkOGE4NzRmZjE2NDY4YzNmZGM0YTc3NzUxM2VfQmFXUWNycVhUekY5TzE5aFAzOHl3UjE0RWVCY0NlWVVfVG9rZW46RWVZaWJ0Vkgzb09FRld4bktIN2NGYkZxbkZkXzE3NjA4Nzc2MjY6MTc2MDg4MTIyNl9WNA&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;10ï¼‰CTLineGetTypographicBounds&lt;/strong&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-Swift&quot;&gt;func CTLineGetTypographicBounds(
    _ line: CTLine,
    _ ascent: UnsafeMutablePointer&amp;lt;CGFloat&amp;gt;?,
    _ descent: UnsafeMutablePointer&amp;lt;CGFloat&amp;gt;?,
    _ leading: UnsafeMutablePointer&amp;lt;CGFloat&amp;gt;?
) -&amp;gt; Double
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è·å–ä¸Šè¡Œï¼ˆascentï¼‰ã€ä¸‹è¡Œï¼ˆdescentï¼‰ã€è¡Œè·ï¼ˆleadingï¼‰ã€‚&lt;/p&gt;

&lt;p&gt;è¿™å‡ ä¸ªæ¦‚å¿µä¸ç†Ÿæ‚‰çš„å¯ä»¥å‚è€ƒï¼š&lt;a href=&quot;https://mp.weixin.qq.com/s/96YJGYKLoxENC4qT9tYNoQ&quot;&gt;ä¸€æ–‡è¯»æ‡‚å­—ç¬¦ã€å­—å½¢ã€å­—ä½“&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;æƒ³äº†è§£è¿™å‡ ä¸ªæ•°å€¼æœ€ç»ˆæ˜¯ä»å“ªä¸ªåœ°æ–¹è¯»å–çš„å¯ä»¥å‚è€ƒï¼š&lt;a href=&quot;https://mp.weixin.qq.com/s/D0A8HAQaQNart7KAdWXyJg&quot;&gt;ä¸€æ–‡è¯»æ‡‚å­—ä½“æ–‡ä»¶&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;é€šè¿‡è¿™ä¸ªAPIæˆ‘ä»¬å¯ä»¥æ‰‹åŠ¨æ„é€ &lt;strong&gt;å¸ƒå±€è¾¹ç•Œ&lt;/strong&gt;ï¼ˆè§ä¸Šé¢çš„ä¾‹å­ï¼‰ï¼Œä¸€èˆ¬ç”¨äºç‚¹å‡»æ£€æµ‹ã€ç»˜åˆ¶è¡ŒèƒŒæ™¯ç­‰ã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;11ï¼‰CTLineGetTrailingWhitespaceWidth&lt;/strong&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-Swift&quot;&gt;func CTLineGetTrailingWhitespaceWidth(_ line: CTLine) -&amp;gt; Double
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è·å–è¡Œå°¾ç©ºç™½å­—ç¬¦çš„å®½åº¦ï¼ˆæ¯”å¦‚ç©ºæ ¼ã€åˆ¶è¡¨ç¬¦ (\t) ç­‰ï¼‰ï¼Œä¸€èˆ¬ç”¨äºå®ç°å¯¹é½æ—¶åŸºäºå¯è§æ–‡æœ¬å¯¹é½ç­‰ã€‚&lt;/p&gt;

&lt;p&gt;ç¤ºä¾‹ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-Swift&quot;&gt;let line = CTLineCreateWithAttributedString(
    NSAttributedString(string: &quot;Hello  &quot;, attributes: [.font: UIFont.systemFont(ofSize: 16)])
)

let totalWidth = CTLineGetTypographicBounds(line, nil, nil, nil)
let trailingWidth = CTLineGetTrailingWhitespaceWidth(line)

print(&quot;æ€»å®½åº¦: \(totalWidth)&quot;)
print(&quot;å°¾éƒ¨ç©ºç™½å®½åº¦: \(trailingWidth)&quot;)
print(&quot;å¯è§æ–‡å­—å®½åº¦: \(totalWidth - trailingWidth)&quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;strong&gt;12ï¼‰CTLineGetStringIndexForPosition&lt;/strong&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-Swift&quot;&gt;func CTLineGetStringIndexForPosition(
    _ line: CTLine,
    _ position: CGPoint
) -&amp;gt; CFIndex
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è·å–ç»™å®šä½ç½®å¤„çš„å­—ç¬¦ä¸²ç´¢å¼•ã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;æ³¨æ„ï¼š&lt;/strong&gt;è™½ç„¶å®˜æ–¹æ–‡æ¡£è¯´è¿™ä¸ªAPIä¸€èˆ¬ç”¨äºç‚¹å‡»æ£€æµ‹ï¼Œä½†å®é™…æµ‹è¯•ä¸‹æ¥&lt;strong&gt;è¿™ä¸ªAPIè¿”å›çš„ç‚¹å‡»ç´¢å¼•ä¸å‡†ç¡®&lt;/strong&gt;ï¼Œæ¯”å¦‚è™½ç„¶ç‚¹å‡»çš„æ˜¯å½“å‰å­—ç¬¦ï¼Œä½†å®é™…è¿”å›çš„ç´¢å¼•æ˜¯åä¸€ä¸ªå­—ç¬¦çš„ï¼Œå¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/post/æ·±å…¥ç†è§£CoreText/CTLineGetStringIndexForPosition.png&quot; alt=&quot;CTLineGetStringIndexForPosition&quot; /&gt;&lt;/p&gt;

&lt;p&gt;æŸ¥äº†ä¸‹ï¼Œå‘ç°è¿™ä¸ªAPIä¸€èˆ¬æ˜¯ç”¨äºè®¡ç®—å…‰æ ‡ä½ç½®çš„ï¼Œæ¯”å¦‚ç‚¹å‡»ã€Œè¡Œã€çš„å·¦åŠéƒ¨åˆ†ï¼Œå¸Œæœ›å…‰æ ‡å‡ºç°åœ¨ã€Œè¡Œã€å·¦ä¾§ï¼Œå¦‚æœç‚¹å‡»ã€Œè¡Œã€çš„å³åŠéƒ¨åˆ†ï¼Œå¸Œæœ›å…‰æ ‡å‡ºç°åœ¨ã€Œè¡Œã€çš„å³ä¾§ã€‚&lt;/p&gt;

&lt;p&gt;å¦‚æœæˆ‘ä»¬æƒ³ç²¾ç¡®åšå­—ç¬¦çš„ç‚¹å‡»æ£€æµ‹ï¼Œæ¨èä½¿ç”¨å­—ç¬¦/è¡Œçš„boundsæ¥è®¡ç®—ï¼Œå‚è€ƒã€ŒCTFrameä½¿ç”¨ç¤ºä¾‹-3ã€ä¾‹å­ã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;13ï¼‰CTLineGetOffsetForStringIndex&lt;/strong&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-Swift&quot;&gt;func CTLineGetOffsetForStringIndex(
    _ line: CTLine,
    _ charIndex: CFIndex,
    _ secondaryOffset: UnsafeMutablePointer&amp;lt;CGFloat&amp;gt;?
) -&amp;gt; CGFloat
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è·å–æŒ‡å®šå­—ç¬¦ç´¢å¼•ç›¸å¯¹äºè¡Œçš„ x è½´åç§»é‡ã€‚&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;line&lt;/code&gt;ï¼šå¾…æŸ¥è¯¢çš„è¡Œ&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;charIndex&lt;/code&gt;ï¼šè¦æŸ¥è¯¢çš„å­—ç¬¦åœ¨&lt;strong&gt;åŸå§‹å±æ€§å­—ç¬¦ä¸²&lt;/strong&gt;ä¸­çš„ç´¢å¼•&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;secondaryOffset&lt;/code&gt;ï¼šæ¬¡è¦åç§»å€¼ï¼Œåœ¨ç®€å•çš„LTRæ–‡æœ¬ä¸­ï¼Œå¯ä»¥å¿½ç•¥ï¼ˆä¼ nilå³å¯ï¼‰ï¼Œä½†åœ¨å¤æ‚çš„åŒå‘æ–‡æœ¬ï¼ˆBiDiï¼‰ä¸­ä¼šç”¨åˆ°&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ä½¿ç”¨åœºæ™¯ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;å­—ç¬¦ç‚¹å‡»æ£€æµ‹ï¼šè§ã€ŒCTFrameä½¿ç”¨ç¤ºä¾‹-3ã€ä¾‹å­&lt;/li&gt;
  &lt;li&gt;ç»™æŸæ®µå­—ç¬¦ç»˜åˆ¶é«˜äº®å’Œä¸‹åˆ’çº¿&lt;/li&gt;
  &lt;li&gt;å®šä½æŸä¸ªå­—ç¬¦ï¼šæ¯”å¦‚æƒ³åœ¨ä¸€æ®µæ–‡æœ¬ä¸­çš„æŸä¸ªå­—ç¬¦ä¸Šæ–¹æ˜¾ç¤ºå¼¹çª—ï¼Œå¯ä»¥ç”¨è¿™ä¸ªAPIå…ˆå®šä½è¯¥å­—ç¬¦&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;14ï¼‰CTLineEnumerateCaretOffsets&lt;/strong&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-Swift&quot;&gt;func CTLineEnumerateCaretOffsets(
    _ line: CTLine,
    _ block: @escaping (Double, CFIndex, Bool, UnsafeMutablePointer&amp;lt;Bool&amp;gt;) -&amp;gt; Void
)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;éå†ä¸€è¡Œä¸­å…‰æ ‡æ‰€æœ‰çš„æœ‰æ•ˆä½ç½®ã€‚&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;line&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;block&lt;/code&gt;
    &lt;ul&gt;
      &lt;li&gt;Doubleï¼šoffsetï¼Œç›¸å¯¹äºè¡Œçš„ x è½´åç§»&lt;/li&gt;
      &lt;li&gt;CFIndexï¼šä¸æ­¤å…‰æ ‡ä½ç½®ç›¸å…³çš„å­—ç¬¦ä¸²ç´¢å¼•&lt;/li&gt;
      &lt;li&gt;Boolï¼štrue è¡¨ç¤ºå…‰æ ‡ä½äºå­—ç¬¦çš„å‰è¾¹ï¼ˆåœ¨ LTR ä¸­å³å·¦ä¾§ï¼‰ï¼Œfalse è¡¨ç¤ºå…‰æ ‡ä½äºå­—ç¬¦çš„åè¾¹ï¼ˆåœ¨ LTR ä¸­å³å³ä¾§ï¼‰ï¼›åœ¨ BiDi ä¸­éœ€è¦ç‰¹æ®ŠåŒä¸€ä¸ªå­—ç¬¦å¯èƒ½ä¼šå›è°ƒä¸¤æ¬¡ï¼ˆæ¯”å¦‚ BiDi è¾¹ç•Œçš„åœ°æ–¹ï¼‰ï¼Œéœ€è¦ç”¨è¿™ä¸ªå€¼åŒºåˆ†å‰å&lt;/li&gt;
      &lt;li&gt;UnsafeMutablePointer&lt;Bool&gt;ï¼šstop æŒ‡é’ˆï¼Œèµ‹å€¼ä¸º true ä¼šåœæ­¢éå†&lt;/Bool&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ä½¿ç”¨åœºæ™¯ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;ç»˜åˆ¶å…‰æ ‡ï¼šå¯Œæ–‡æœ¬é€‰åŒºæˆ–è€…æ–‡æœ¬ç¼–è¾‘å™¨ä¸­ï¼Œè¦ç»˜åˆ¶å…‰æ ‡æ—¶ï¼Œå¯ä»¥å…ˆé€šè¿‡ CTLineGetStringIndexForPosition è·å–å­—ç¬¦ç´¢å¼•ï¼Œå†é€šè¿‡è¿™ä¸ªå‡½æ•°æˆ–è€… CTLineGetOffsetForStringIndex è·å–å…‰æ ‡åç§»&lt;/li&gt;
  &lt;li&gt;å®ç°å…‰æ ‡çš„å·¦å³é”®ç§»åŠ¨ï¼šå¯ä»¥ç”¨è¿™ä¸ªAPIå°†æ‰€æœ‰çš„å…‰æ ‡ä½ç½®å­˜å‚¨åˆ°æ•°ç»„ï¼Œå¹¶æŒ‰offsetæ’åºï¼Œå½“ç”¨æˆ·æŒ‰ä¸‹å³ç®­å¤´ -&amp;gt; æ—¶ï¼Œå¯ä»¥æ‰¾åˆ°å½“å‰å…‰æ ‡indexï¼Œå°†index + 1å³æ˜¯ä¸‹ä¸€ä¸ªå…‰æ ‡ä½ç½®&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;331-ctlineä½¿ç”¨ç¤ºä¾‹&quot;&gt;3.3.1 CTLineä½¿ç”¨ç¤ºä¾‹&lt;/h3&gt;

&lt;p&gt;é™¤äº†ä¸Šé¢ä¾‹å­ï¼Œå†ä¸¾ä¸€ä¸ªï¼š&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;1ï¼‰é«˜äº®ç‰¹å®šå­—ç¬¦&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://lk9v5zgfb4.feishu.cn/space/api/box/stream/download/asynccode/?code=MjJjMWYyZjU4MDFlMzY2ZDIxNGQ2MTgxYWQ5MDgwNThfZDI2VzA4WnRETlZ4Ym1hVXIxT1BBc3RoSUZ5ZUV6ck1fVG9rZW46QzlPOGJZRkYzb0NKdFh4NEcweWNudlZybktkXzE3NjA4Nzc2MjY6MTc2MDg4MTIyNl9WNA&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;34-ctrun&quot;&gt;3.4 CTRun&lt;/h2&gt;

&lt;p&gt;CTRunç›¸å…³APIæ¯”è¾ƒåŸºç¡€ï¼Œè¿™é‡Œä¸»è¦ä»‹ç»å¸¸ç”¨çš„ã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;1ï¼‰CTLineGetGlyphRuns&lt;/strong&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-Swift&quot;&gt;func CTLineGetGlyphRuns(_ line: CTLine) -&amp;gt; CFArray
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è·å–CTRunçš„&lt;strong&gt;å”¯ä¸€&lt;/strong&gt;æ–¹å¼ã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;2ï¼‰CTRunGetAttributes&lt;/strong&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-Swift&quot;&gt;func CTRunGetAttributes(_ run: CTRun) -&amp;gt; CFDictionary
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è·å–CTRunçš„å±æ€§ï¼›æ¯”å¦‚æƒ³çŸ¥é“è¿™ä¸ªCTRunæ˜¯ä¸æ˜¯ç²—ä½“ï¼Œæ˜¯ä¸æ˜¯é“¾æ¥ï¼Œæ˜¯ä¸æ˜¯ç›®æ ‡Runç­‰ï¼Œéƒ½å¯ä»¥é€šè¿‡è¿™ä¸ªAPIã€‚&lt;/p&gt;

&lt;p&gt;ç¤ºä¾‹ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-Swift&quot;&gt;guard let attributes = CTRunGetAttributes(run) as? [NSAttributedString.Key: Any] else { continue }
// ç°åœ¨ä½ å¯ä»¥æ£€æŸ¥å±æ€§
if let color = attributes[.foregroundColor] as? UIColor {
    // ...
}
if let font = attributes[.font] as? UIFont {
    // ...
}
if let link = attributes[NSAttributedString.Key(&quot;my_custom_link_key&quot;)] {
    // è¿™å°±æ˜¯é‚£ä¸ªå¯ç‚¹å‡»çš„ runï¼
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;strong&gt;3ï¼‰CTRunGetStringRange&lt;/strong&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-Swift&quot;&gt;func CTRunGetStringRange(_ run: CTRun) -&amp;gt; CFRange
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è·å–CTRunå¯¹åº”äºåŸå§‹å±æ€§å­—ç¬¦ä¸²çš„å“ªä¸ªèŒƒå›´ã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;4ï¼‰CTRunGetTypographicBounds&lt;/strong&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-Swift&quot;&gt;func CTRunGetTypographicBounds(
    _ run: CTRun,
    _ range: CFRange,
    _ ascent: UnsafeMutablePointer&amp;lt;CGFloat&amp;gt;?,
    _ descent: UnsafeMutablePointer&amp;lt;CGFloat&amp;gt;?,
    _ leading: UnsafeMutablePointer&amp;lt;CGFloat&amp;gt;?
) -&amp;gt; Double
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è·å–CTRunçš„åº¦é‡ä¿¡æ¯ï¼ŒåŒä¸Šé¢è®¸å¤šAPIä¸€æ ·ï¼Œå½“ range.length ä¸º0æ—¶è¡¨ç¤ºç›´åˆ°CTRunæ–‡æœ¬æœ«å°¾ã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;5ï¼‰CTRunGetPositions&lt;/strong&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-Swift&quot;&gt;func CTRunGetPositions(
    _ run: CTRun,
    _ range: CFRange,
    _ buffer: UnsafeMutablePointer&amp;lt;CGPoint&amp;gt;
)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è·å–CTRunä¸­æ¯ä¸€ä¸ªå­—å½¢çš„ä½ç½®ï¼Œæ³¨æ„è¿™é‡Œçš„ä½ç½®æ˜¯&lt;strong&gt;ç›¸å¯¹äºCTLineåŸç‚¹&lt;/strong&gt;çš„ã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;6ï¼‰CTRunDelegate&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;CTRunDelegateå…è®¸ä¸ºå±æ€§å­—ç¬¦ä¸²ä¸­çš„ä¸€æ®µæ–‡æœ¬æä¾›è‡ªå®šä¹‰å¸ƒå±€æµ‹é‡ä¿¡æ¯ï¼Œä¸€èˆ¬ç”¨äºåœ¨æ–‡æœ¬ä¸­æ’å…¥å›¾ç‰‡ã€è‡ªå®šä¹‰Viewç­‰éæ–‡æœ¬å…ƒç´ ã€‚&lt;/p&gt;

&lt;p&gt;æ¯”å¦‚åœ¨æ–‡æœ¬ä¸­é—´æ’å…¥å›¾ç‰‡ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://lk9v5zgfb4.feishu.cn/space/api/box/stream/download/asynccode/?code=YmI5MzViNjczMjVlNDQ1ZDYwN2E3MDI0YTMyM2YxZDhfTlNJNmV4aGJtZloydTJPSWlYTUUwZ3NadkZ0NnNDcktfVG9rZW46R3JsM2JUUXZTb3ZNVm14SHV5dGNtZWhKblhjXzE3NjA4Nzc2MjY6MTc2MDg4MTIyNl9WNA&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;341-ctrunä½¿ç”¨ç¤ºä¾‹&quot;&gt;3.4.1 CTRunä½¿ç”¨ç¤ºä¾‹&lt;/h3&gt;

&lt;p&gt;&lt;strong&gt;1ï¼‰åŸºç¡€ç»˜åˆ¶&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://lk9v5zgfb4.feishu.cn/space/api/box/stream/download/asynccode/?code=MTAwM2RiN2M2YTBiZjBkOGU0OWYxM2U0NjE4ZmQyNzRfMEZMUllNV05Ob3NHdzFuTW9jNGxnRE0zNzFRNHdIakRfVG9rZW46QW1XM2JaVzVwb25qUHB4cVh0MGNQamZGbmFjXzE3NjA4Nzc2MjY6MTc2MDg4MTIyNl9WNA&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;2ï¼‰é“¾æ¥ç‚¹å‡»è¯†åˆ«&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://lk9v5zgfb4.feishu.cn/space/api/box/stream/download/asynccode/?code=M2FkMGE5MzBhODAyNWMwNmE4NzFiYTM5NjE3ZDJlYWJfY0tIY1J2NEZicklpbERGTU9hNkNYd0N0VTFrS1hKUGxfVG9rZW46WDlUcGJjRDdyb0d3T1F4UndjQWNOYzRFbnNkXzE3NjA4Nzc2MjY6MTc2MDg4MTIyNl9WNA&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;35-cttypesetter&quot;&gt;3.5 CTTypesetter&lt;/h2&gt;

&lt;p&gt;CTFramesetterä¼šè‡ªåŠ¨å¤„ç†æ¢è¡Œï¼Œå½“æˆ‘ä»¬æƒ³æ‰‹åŠ¨æ§åˆ¶æ¢è¡Œæ—¶ï¼Œå¯ä»¥ç”¨CTTypesetterã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;1ï¼‰CTTypesetterSuggestLineBreak&lt;/strong&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-Swift&quot;&gt;func CTTypesetterSuggestLineBreak(
    _ typesetter: CTTypesetter,
    _ startIndex: CFIndex,
    _ width: Double
) -&amp;gt; CFIndex
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æŒ‰å•è¯ï¼ˆwordï¼‰æ¢è¡Œã€‚&lt;/p&gt;

&lt;p&gt;å¦‚ä¸‹ç¤ºä¾‹ï¼Œè¾“å‡ºï¼š&lt;code class=&quot;highlighter-rouge&quot;&gt;Try word &lt;/code&gt;å’Œ&lt;code class=&quot;highlighter-rouge&quot;&gt;wrapping&lt;/code&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-Swift&quot;&gt;let attrStringWith = NSAttributedString(string: &quot;Try word wrapping&quot;, attributes: [.font: UIFont.systemFont(ofSize: 18)])
let typesetter = CTTypesetterCreateWithAttributedString(attributedString)
let totalLength = attributedString.length // UTF-16 é•¿åº¦
var startIndex = 0
var lineCount = 1

while startIndex &amp;lt; totalLength {
    let charCount = CTTypesetterSuggestLineBreak(typesetter, startIndex, 100)
    // å¦‚æœè¿”å› 0ï¼Œæ„å‘³ç€ä¸€ä¸ªå­—ç¬¦éƒ½æ”¾ä¸ä¸‹ï¼ˆæˆ–å·²ç»“æŸï¼‰
    if charCount == 0 {
        if startIndex &amp;lt; totalLength {
            print(&quot;Line \(lineCount): (Error) æ— æ³•æ”¾ä¸‹å‰©ä½™å­—ç¬¦ã€‚&quot;)
        }
        break
    }
    // è·å–è¿™ä¸€è¡Œçš„å­å­—ç¬¦ä¸²
    let range = NSRange(location: startIndex, length: charCount)
    let lineString = (attributedString.string as NSString).substring(with: range)
    print(&quot;Line \(lineCount): '\(lineString)' (UTF-16 å­—ç¬¦æ•°: \(charCount))&quot;)
    // æ›´æ–°ä¸‹ä¸€æ¬¡å¾ªç¯çš„èµ·å§‹ç´¢å¼•
    startIndex += charCount
    lineCount += 1
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;strong&gt;2ï¼‰CTTypesetterSuggestClusterBreak&lt;/strong&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-Swift&quot;&gt;func CTTypesetterSuggestClusterBreak(
    _ typesetter: CTTypesetter,
    _ startIndex: CFIndex,
    _ width: Double
) -&amp;gt; CFIndex
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æŒ‰å­—ç¬¦ï¼ˆcharï¼‰æ¢è¡Œã€‚&lt;/p&gt;

&lt;p&gt;å¦‚ä¸‹ç¤ºä¾‹ï¼Œè¾“å‡ºï¼š&lt;code class=&quot;highlighter-rouge&quot;&gt;Try word wr&lt;/code&gt;å’Œ&lt;code class=&quot;highlighter-rouge&quot;&gt;apping&lt;/code&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-Swift&quot;&gt;let attrStringWith = NSAttributedString(string: &quot;Try word wrapping&quot;, attributes: [.font: UIFont.systemFont(ofSize: 18)])
let typesetter = CTTypesetterCreateWithAttributedString(attributedString)
let totalLength = attributedString.length // UTF-16 é•¿åº¦
var startIndex = 0
var lineCount = 1

while startIndex &amp;lt; totalLength {
    let charCount = CTTypesetterSuggestClusterBreak(typesetter, startIndex, 100)
    // å¦‚æœè¿”å› 0ï¼Œæ„å‘³ç€ä¸€ä¸ªå­—ç¬¦éƒ½æ”¾ä¸ä¸‹ï¼ˆæˆ–å·²ç»“æŸï¼‰
    if charCount == 0 {
        if startIndex &amp;lt; totalLength {
            print(&quot;Line \(lineCount): (Error) æ— æ³•æ”¾ä¸‹å‰©ä½™å­—ç¬¦ã€‚&quot;)
        }
        break
    }
    // è·å–è¿™ä¸€è¡Œçš„å­å­—ç¬¦ä¸²
    let range = NSRange(location: startIndex, length: charCount)
    let lineString = (attributedString.string as NSString).substring(with: range)
    print(&quot;Line \(lineCount): '\(lineString)' (UTF-16 å­—ç¬¦æ•°: \(charCount))&quot;)
    // æ›´æ–°ä¸‹ä¸€æ¬¡å¾ªç¯çš„èµ·å§‹ç´¢å¼•
    startIndex += charCount
    lineCount += 1
}
&lt;/code&gt;&lt;/pre&gt;

&lt;h1 id=&quot;å››æ€»ç»“&quot;&gt;å››ã€æ€»ç»“&lt;/h1&gt;

&lt;p&gt;ä»¥ä¸Šæ˜¯CoreTextä¸­å¸¸ç”¨çš„APIåŠå…¶åœºæ™¯ä»£ç ä¸¾ä¾‹ï¼Œå®Œæ•´ç¤ºä¾‹ä»£ç å¯åœ¨å…¬ä¼—å·ã€Œéä¸“ä¸šç¨‹åºå‘˜Pingã€å›å¤ â€œCoreTextâ€ è·å–ã€‚&lt;/p&gt;
</description>
        <pubDate>Sat, 18 Oct 2025 00:00:00 +0800</pubDate>
        <link>http://localhost:4000/2025/10/18/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3CoreText-API/</link>
        <guid isPermaLink="true">http://localhost:4000/2025/10/18/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3CoreText-API/</guid>
        
        <category>è·¨ç«¯æ¸²æŸ“</category>
        
        <category>å¯Œæ–‡æœ¬</category>
        
        
      </item>
    
      <item>
        <title>æ–°æ‰‹å°ç™½ä¹Ÿèƒ½çœ‹æ‡‚çš„é€†å‘æŠ€å·§</title>
        <description>&lt;h1 id=&quot;å¼•è¨€&quot;&gt;å¼•è¨€&lt;/h1&gt;

&lt;p&gt;åœ¨æˆ‘ä»¬æ—¥å¸¸å·¥ä½œä¸­ï¼Œéš¾å…ä¼šé‡åˆ°ä¸€äº›Crashç­‰ç–‘éš¾é—®é¢˜éœ€è¦æŸ¥çœ‹ç³»ç»Ÿå®ç°ï¼Œæœ‰æ—¶å€™åœ¨åšä¸€äº›é«˜çº§å®šåˆ¶åŠŸèƒ½æ—¶ï¼Œæ¯”å¦‚è‡ªå®šä¹‰å¯Œæ–‡æœ¬æ¸²æŸ“ç­‰ï¼Œä¹Ÿéœ€è¦æŸ¥çœ‹ç³»ç»Ÿæ˜¯æ€ä¹ˆåšçš„ï¼›ç‰¹åˆ«æ˜¯å¯¹äºiOSç¨‹åºå‘˜æ¥è¯´ï¼Œç”±äºAppleçš„é—­æºç”Ÿæ€ï¼Œé‡åˆ°ä»¥ä¸Šé—®é¢˜åŸºæœ¬åªèƒ½é é€†å‘æ‰‹æ®µæ¥é€æ­¥åˆ†æã€‚å­¦ä¼šæ±‡ç¼–å’Œé€†å‘ï¼Œå¯ä»¥è¯´æ˜¯ä¸€ä¸ªç¨‹åºå‘˜ä»å…¥é—¨èµ°å‘è¿›é˜¶çš„ç¬¬ä¸€æ­¥ã€‚&lt;/p&gt;

&lt;p&gt;å‰é¢æˆ‘ä»¬é€šè¿‡é€†å‘æ‰‹æ®µåˆ†æäº†&lt;a href=&quot;https://mp.weixin.qq.com/s/EpaNjLcG6DZBc128A2gdIQ&quot;&gt;CoreTextä¸­çš„å­—ä½“çº§è”/Font Fallbackæœºåˆ¶&lt;/a&gt;ï¼Œæ­£å¥½å€Ÿæ­¤æœºä¼šèŠèŠä¸€äº›å¸¸ç”¨çš„é€†å‘æ€è·¯ä¸æŠ€å·§ï¼›æœ¬ç¯‡æ–‡ç« æ›´å¤šé¢å‘å°ç™½å…¥é—¨ï¼Œä¸éœ€è¦ä½ æœ‰å¤ªå¤šçš„æ±‡ç¼–ã€LLDBçŸ¥è¯†ï¼Œæˆ‘ä»¬å°†ç»“åˆä¸€äº›å…¸å‹åœºæ™¯æ¥ä¸¾ä¸€åä¸‰ï¼Œå½“ç„¶ï¼Œå¦‚æœå¤§å®¶æœ‰æ›´å¥½çš„å¥‡æŠ€æ·«å·§æ¬¢è¿ä¸€èµ·äº¤æµã€å­¦ä¹ ã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;æŒç»­æ›´æ–°ï¼Œæ›´å¤šå†…å®¹æ¬¢è¿åˆ°æˆ‘çš„å…¬ä¼—å·ã€Œéä¸“ä¸šç¨‹åºå‘˜Pingã€ä¸€èµ·äº¤æµï¼ï¼&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/å…¬ä¼—å·.jpg&quot; alt=&quot;å…¬ä¼—å·&quot; /&gt;&lt;/p&gt;

&lt;h1 id=&quot;ä¸€å·¥æ¬²å–„å…¶äº‹å¿…å…ˆåˆ©å…¶å™¨&quot;&gt;ä¸€ã€å·¥æ¬²å–„å…¶äº‹ï¼Œå¿…å…ˆåˆ©å…¶å™¨&lt;/h1&gt;

&lt;p&gt;åœ¨å¼€å§‹ä¹‹å‰ï¼Œéœ€è¦å…ˆäº†è§£ä¸¤ä¸ªå¸¸ç”¨çš„é€†å‘å·¥å…·ï¼šHopper å’Œ IDAã€‚å…·ä½“å®‰è£…å’Œä½¿ç”¨æˆ‘ä»¬ä¹Ÿæœ‰ä¸“é—¨çš„æ–‡ç« ä»‹ç»ï¼š&lt;a href=&quot;https://mp.weixin.qq.com/s/ubcnejz3St0LD2H0HDO6PA&quot;&gt;å¸¸è§é€†å‘å·¥å…·ä½¿ç”¨&lt;/a&gt;ã€‚&lt;/p&gt;

&lt;p&gt;ä¸€èˆ¬è€Œè¨€æˆ‘ä»¬éƒ½æ˜¯ç»“åˆä¸¤ä¸ªå·¥å…·ä¸€èµ·çœ‹ï¼ŒIDA çš„åæ±‡ç¼–é€šå¸¸æ¯” Hopper è¿˜åŸåº¦æ›´é«˜ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸»ç”¨çš„è¿˜æ˜¯IDAã€‚&lt;/p&gt;

&lt;h1 id=&quot;äºŒæŸ¥æ‰¾äºŒè¿›åˆ¶æ–‡ä»¶è·¯å¾„&quot;&gt;äºŒã€æŸ¥æ‰¾äºŒè¿›åˆ¶æ–‡ä»¶è·¯å¾„&lt;/h1&gt;

&lt;p&gt;åˆ†æçš„ç¬¬ä¸€æ­¥ï¼Œè‚¯å®šæ˜¯æ‰¾åˆ°æˆ‘ä»¬æƒ³è¦åˆ†æçš„å…¥å£å‡½æ•°ï¼Œä»¥&lt;a href=&quot;https://mp.weixin.qq.com/s/EpaNjLcG6DZBc128A2gdIQ&quot;&gt;CoreTextä¸­çš„å­—ä½“çº§è”/Font Fallbackæœºåˆ¶&lt;/a&gt;è¿™ç¯‡æ–‡ç« çš„Caseä¸ºä¾‹å­ï¼Œæˆ‘ä»¬è¦ç ”ç©¶çš„æ˜¯ CTFontCopyDefaultCascadeListForLanguages çš„å®ç°ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨LLDBä¸­é€šè¿‡å¦‚ä¸‹å‘½ä»¤æ‰¾åˆ°è¯¥ç¬¦å·æ‰€åœ¨åº“ï¼š&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;image lookup &lt;span class=&quot;nt&quot;&gt;-rn&lt;/span&gt; CTFontCopyDefaultCascadeListForLanguages
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/img/post/æ–°æ‰‹å°ç™½ä¹Ÿèƒ½çœ‹æ‡‚çš„é€†å‘æŠ€å·§/LLDBæŸ¥çœ‹äºŒè¿›åˆ¶è·¯å¾„.png&quot; alt=&quot;LLDBæŸ¥çœ‹äºŒè¿›åˆ¶è·¯å¾„&quot; /&gt;&lt;/p&gt;

&lt;p&gt;é€šè¿‡è¿™ä¸ªå‘½ä»¤æˆ‘ä»¬å¯ä»¥å¾—åˆ°ä¸¤ä¸ªä¿¡æ¯ï¼š&lt;/p&gt;

&lt;p&gt;1ï¼‰CTFontCopyDefaultCascadeListForLanguages åœ¨CoreTextåº“ä¸­&lt;/p&gt;

&lt;p&gt;2ï¼‰CoreText äºŒè¿›åˆ¶æ–‡ä»¶çš„è·¯å¾„&lt;/p&gt;

&lt;p&gt;å¾—åˆ°è·¯å¾„ä¹‹åï¼Œåœ¨è®¿è¾¾ä¸­å¯ä»¥é€šè¿‡å¿«æ·é”® Command + Shift + G å¯ä»¥å¿«é€Ÿè·³è½¬åˆ°ä½ç½®ï¼Œå¾—åˆ°CoreTextçš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/post/æ–°æ‰‹å°ç™½ä¹Ÿèƒ½çœ‹æ‡‚çš„é€†å‘æŠ€å·§/CoreText.png&quot; alt=&quot;CoreText&quot; /&gt;&lt;/p&gt;

&lt;h1 id=&quot;ä¸‰å–„ç”¨ai&quot;&gt;ä¸‰ã€å–„ç”¨AI&lt;/h1&gt;

&lt;p&gt;å¾—åˆ°CoreTextçš„äºŒè¿›åˆ¶æ–‡ä»¶ä¹‹åï¼Œæˆ‘ä»¬é€šè¿‡IDAè¿›è¡Œåæ±‡ç¼–ã€‚&lt;/p&gt;

&lt;p&gt;ä¹‹åå°† CTFontCopyDefaultCascadeListForLanguages çš„ä¸»è¦è°ƒç”¨é€»è¾‘Copyåˆ°å•ç‹¬çš„æ–‡ä»¶å¤¹ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/post/æ–°æ‰‹å°ç™½ä¹Ÿèƒ½çœ‹æ‡‚çš„é€†å‘æŠ€å·§/CTFontCopyDefaultCascadeListForLanguages.png&quot; alt=&quot;CTFontCopyDefaultCascadeListForLanguages&quot; /&gt;&lt;/p&gt;

&lt;p&gt;åœ¨AIæ²¡æ™®åŠä¹‹å‰ï¼Œæˆ‘ä»¬ä¸€èˆ¬æ˜¯ç»“åˆLLDBç¡¬ç€å¤´çš®é€è¡Œåˆ†æï¼Œæœ‰äº†AIä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥å°†æ•´ä¸ªæ–‡ä»¶å¤¹æ‰”ç»™AIï¼ˆæ¯”å¦‚Cursorã€GPTç­‰ï¼‰ï¼Œè®©AIç»™æˆ‘ä»¬æ¢³ç†æµç¨‹ã€é€è¡Œæ³¨é‡Šï¼Œè¾“å‡ºè°ƒç”¨æµç¨‹å›¾ç­‰ã€‚&lt;/p&gt;

&lt;p&gt;å¦‚ä¸‹ï¼Œæ˜¯AIç”Ÿæˆçš„å‡½æ•°è°ƒç”¨æµç¨‹ï¼›ç»“åˆAIçš„é€»è¾‘æ¢³ç†å’Œæ³¨é‡Šï¼Œæˆ‘ä»¬å¯¹ CTFontCopyDefaultCascadeListForLanguages çš„æ•´ä½“é€»è¾‘ä¼šæœ‰ä¸€ä¸ªå¤§è‡´çš„ç†è§£ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/post/æ–°æ‰‹å°ç™½ä¹Ÿèƒ½çœ‹æ‡‚çš„é€†å‘æŠ€å·§/AIæµç¨‹å›¾.png&quot; alt=&quot;AIæµç¨‹å›¾&quot; /&gt;&lt;/p&gt;

&lt;p&gt;å½“ç„¶ï¼ŒAIä¹Ÿä¸æ˜¯å…¨èƒ½çš„ï¼Œä¸€äº›é€»è¾‘AIä¹Ÿåªæ˜¯çŒœæµ‹ç”šè‡³ä¹±è¯´ğŸ˜©ï¼Œå…·ä½“çš„ç»†èŠ‚è¿˜éœ€è¦æˆ‘ä»¬ç»“åˆLLDBã€IDAä¸€èµ·åˆ†æï¼Œåªæ˜¯è¯´æœ‰äº†AIä¹‹åï¼Œå¯ä»¥å¤§å¤§åŠ å¿«æˆ‘ä»¬çš„åˆ†ææ•ˆç‡ã€‚&lt;/p&gt;

&lt;p&gt;ä¸‹é¢æˆ‘ä»¬å°†åˆ—ä¸¾å‡ ä¸ªå…¸å‹ä¾‹å­ï¼Œæˆ‘ä»¬æ—¥å¸¸åˆ†æä¸­èƒ½é‡åˆ°çš„ä¹ŸåŸºæœ¬å°±è¿™äº›ã€‚&lt;/p&gt;

&lt;h1 id=&quot;å››å…¸å‹ä¾‹å­&quot;&gt;å››ã€å…¸å‹ä¾‹å­&lt;/h1&gt;

&lt;h2 id=&quot;41-å‡½æ•°è°ƒç”¨&quot;&gt;4.1 å‡½æ•°è°ƒç”¨&lt;/h2&gt;

&lt;p&gt;ä¸ç®¡æ˜¯é¢å‘å¯¹è±¡ï¼Œè¿˜æ˜¯é¢å‘è¿‡ç¨‹ï¼Œåœ¨æ±‡ç¼–çš„ä¸–ç•Œé‡Œï¼Œç¨‹åºé€»è¾‘éƒ½æ˜¯ç”±ä¸€ä¸ªä¸€ä¸ªç‹¬ç«‹çš„å‡½æ•°è°ƒç”¨ç»„æˆçš„ï¼›å¯¹å‡½æ•°è€Œè¨€ï¼Œæœ€é‡è¦çš„å°±æ˜¯å®ƒçš„&lt;strong&gt;è¾“å…¥è¾“å‡º&lt;/strong&gt;ï¼ŒåŸºæœ¬ä¸Šæˆ‘ä»¬åªè¦è¯»æ‡‚äº†æ¯ä¸ªå‡½æ•°çš„è¾“å…¥è¾“å‡ºæ˜¯ä»€ä¹ˆï¼Œé‚£æˆ‘ä»¬å°±èƒ½ç†è§£æ•´ä½“çš„é€»è¾‘ã€‚&lt;/p&gt;

&lt;p&gt;å‡½æ•°å…¥å‚ä¸è¿”å›å€¼ï¼ŒæŒ‰ç…§æ•°æ®ç±»å‹ä¸åŒå¯ä»¥æ€»ç»“ä¸ºä¸‹é¢çš„è¡¨æ ¼ï¼šæˆ‘ä»¬æœ€å¸¸æ¥è§¦çš„ï¼Œå…¶å®åªæœ‰å‰ä¸¤é¡¹&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/post/æ–°æ‰‹å°ç™½ä¹Ÿèƒ½çœ‹æ‡‚çš„é€†å‘æŠ€å·§/å‡½æ•°å…¥å‚ä¸è¿”å›å€¼.png&quot; alt=&quot;å‡½æ•°å…¥å‚ä¸è¿”å›å€¼&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ä¸¾ä¸ªğŸŒ°ï¼š&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;1ï¼‰æ•´æ•°/æŒ‡é’ˆç±»å‹&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-swift highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// ä»¥å¦‚ä¸‹è°ƒç”¨ä¸ºä¾‹&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;ctFont&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;UIFont&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;systemFont&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;ofSize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;18&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;languages&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;zh-HK&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;zh-Hans&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;kt&quot;&gt;CTFontCopyDefaultCascadeListForLanguages&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ctFont&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;languages&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;CFArray&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;å…¥å‚&lt;/th&gt;
      &lt;th&gt;è¿”å›å€¼&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;img src=&quot;/img/post/æ–°æ‰‹å°ç™½ä¹Ÿèƒ½çœ‹æ‡‚çš„é€†å‘æŠ€å·§/å‡½æ•°å…¥å‚.png&quot; alt=&quot;å‡½æ•°å…¥å‚&quot; /&gt;&lt;/td&gt;
      &lt;td&gt;&lt;img src=&quot;/img/post/æ–°æ‰‹å°ç™½ä¹Ÿèƒ½çœ‹æ‡‚çš„é€†å‘æŠ€å·§/å‡½æ•°è¿”å›å€¼.png&quot; alt=&quot;å‡½æ•°è¿”å›å€¼&quot; /&gt;&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;&lt;strong&gt;2ï¼‰æµ®ç‚¹æ•°ç±»å‹&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-swift highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// ä»¥getAreaä¸ºä¾‹&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;ViewController&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;UIViewController&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;override&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;viewDidLoad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;super&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;viewDidLoad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;area&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;getArea&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;frame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;view&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;frame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;nf&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;area&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;getArea&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;frame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;CGRect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;CGFloat&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;frame&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;width&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;frame&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;height&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;å…¥å‚&lt;/th&gt;
      &lt;th&gt;è¿”å›å€¼&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;img src=&quot;/img/post/æ–°æ‰‹å°ç™½ä¹Ÿèƒ½çœ‹æ‡‚çš„é€†å‘æŠ€å·§/CGFloatå‡½æ•°å…¥å‚.png&quot; alt=&quot;å‡½æ•°å…¥å‚&quot; /&gt;&lt;/td&gt;
      &lt;td&gt;&lt;img src=&quot;/img/post/æ–°æ‰‹å°ç™½ä¹Ÿèƒ½çœ‹æ‡‚çš„é€†å‘æŠ€å·§/CGFloatå‡½æ•°è¿”å›å€¼.png&quot; alt=&quot;å‡½æ•°è¿”å›å€¼&quot; /&gt;&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h2 id=&quot;42-æ€ä¹ˆç¡®å®šä¸€æ®µåœ°å€çš„å«ä¹‰&quot;&gt;4.2 æ€ä¹ˆç¡®å®šä¸€æ®µåœ°å€çš„å«ä¹‰&lt;/h2&gt;

&lt;p&gt;è¿˜æ˜¯ä»¥ä¸¾ä¸€ä¸ªå®é™…ä¾‹å­ï¼Œåœ¨&lt;a href=&quot;https://mp.weixin.qq.com/s/EpaNjLcG6DZBc128A2gdIQ&quot;&gt;CoreTextä¸­çš„å­—ä½“çº§è”/Font Fallbackæœºåˆ¶&lt;/a&gt;æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬è¦åˆ†æ TBaseFont::CreateFallbacks çš„å®ç°ï¼Œç­¾åå¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-assembly&quot;&gt;__int64 __usercall TBaseFont::CreateFallbacks@&amp;lt;X0&amp;gt;(__int64 result@&amp;lt;X0&amp;gt;, __int64 a2@&amp;lt;X1&amp;gt;, __int64 a3@&amp;lt;X2&amp;gt;, __int64 a4@&amp;lt;X3&amp;gt;, __int64 a5@&amp;lt;X4&amp;gt;, _QWORD *a6@&amp;lt;X8&amp;gt;) 
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å…¶ä¸­ç¬¬ä¸€ä¸ªå‚æ•° result@&lt;X0&gt; é€šè¿‡è°ƒç”¨çš„åœ°æ–¹æˆ‘ä»¬çŸ¥é“æ˜¯ CTFont ä¸­çš„ä¸€ä¸ªæˆå‘˜å˜é‡ï¼Œä½†å…·ä½“æ˜¯ä»€ä¹ˆä¸ç¡®å®šã€‚&lt;/X0&gt;&lt;/p&gt;

&lt;p&gt;æˆ‘ä»¬æœ€ç»ˆç»“åˆLLDBåšå¦‚ä¸‹å°è¯•åˆ†æå‡ºäº† result@&lt;X0&gt; çš„å…·ä½“å«ä¹‰ï¼š&lt;/X0&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/post/æ–°æ‰‹å°ç™½ä¹Ÿèƒ½çœ‹æ‡‚çš„é€†å‘æŠ€å·§/LLDBæŸ¥çœ‹åœ°å€ä¿¡æ¯.png&quot; alt=&quot;LLDBæŸ¥çœ‹åœ°å€ä¿¡æ¯&quot; /&gt;&lt;/p&gt;

&lt;p&gt;åŒç†ï¼Œæˆ‘ä»¬å¦‚æœæ‹¿åˆ°ä¸€æ®µåœ°å€è¦åˆ†æå…¶å«ä¹‰çš„è¯ï¼Œä¹Ÿå¯ä»¥æŒ‰è¿™ä¸ªæ­¥éª¤è¿›è¡Œå°è¯•ã€‚&lt;/p&gt;

&lt;h2 id=&quot;43-å¦‚ä½•ä¿®æ”¹-if-æ¡ä»¶&quot;&gt;4.3 å¦‚ä½•ä¿®æ”¹ if æ¡ä»¶&lt;/h2&gt;

&lt;p&gt;æˆ‘ä»¬ä»¥å¦‚ä¸‹å‡½æ•°è°ƒç”¨ä¸ºä¾‹ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/post/æ–°æ‰‹å°ç™½ä¹Ÿèƒ½çœ‹æ‡‚çš„é€†å‘æŠ€å·§/addNum.png&quot; alt=&quot;addNum&quot; /&gt;&lt;/p&gt;

&lt;p&gt;æˆ‘ä»¬ä¼ å…¥çš„numæ˜¯1ï¼Œæ­£å¸¸é€»è¾‘ä¼šæ‰§è¡Œ num + 2 è¿”å› 3ï¼Œé‚£æœ‰æ²¡æœ‰åŠæ³•ä¸ä¿®æ”¹å…¥å‚ï¼Œæ‰§è¡Œ num + 1 çš„è·¯å¾„ã€‚&lt;/p&gt;

&lt;p&gt;æˆ‘ä»¬æ¥çœ‹ä¸‹è¿™æ®µé€»è¾‘çš„æ±‡ç¼–ä»£ç ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/post/æ–°æ‰‹å°ç™½ä¹Ÿèƒ½çœ‹æ‡‚çš„é€†å‘æŠ€å·§/addNum-tbz.png&quot; alt=&quot;addNum-tbz&quot; /&gt;&lt;/p&gt;

&lt;p&gt;å›¾ç‰‡æ³¨é‡Šè¯´çš„æ¯”è¾ƒæ˜ç™½ï¼›if æ¡ä»¶åœ¨æ±‡ç¼–å±‚é¢ä¸€èˆ¬è¢«ç¿»è¯‘æˆ tbzï¼ˆTest Bit and branch if Zeroï¼‰ã€tbnzï¼ˆTest Bit and branch if Not Zeroï¼‰ç­‰ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¿®æ”¹å¯„å­˜å™¨çš„å€¼æ¥æ›´æ”¹æ‰§è¡Œåˆ†æ”¯ï¼›è¿™åœ¨åˆ†æç³»ç»ŸAPIæ—¶ï¼Œæ˜¯ä¸€ä¸ªå¾ˆæœ‰ç”¨çš„æ€è·¯ã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;ä¸¾ä¸€åä¸‰ï¼Œé€šè¿‡LLDBï¼Œæˆ‘ä»¬å¯ä»¥å®æ—¶ä¿®æ”¹ä»»ä½•å¯„å­˜å™¨ã€å†…å­˜åœ°å€çš„å€¼ï¼Œè¿™å¯ä»¥éå¸¸æ–¹ä¾¿çš„å¸®æˆ‘ä»¬æµ®ç°ä¸€äº›å¶ç°çš„Bugã€Crashç­‰ã€‚&lt;/strong&gt;&lt;/p&gt;

&lt;h2 id=&quot;44-å¦‚æœè·³è¿‡å‡½æ•°æ‰§è¡Œä¿®æ”¹å‡½æ•°è¿”å›å€¼&quot;&gt;4.4 å¦‚æœè·³è¿‡å‡½æ•°æ‰§è¡Œ/ä¿®æ”¹å‡½æ•°è¿”å›å€¼&lt;/h2&gt;

&lt;p&gt;æˆ‘ä»¬è¿˜æ˜¯ä»¥ä¸Šé¢çš„addNumä¸ºä¾‹ï¼Œå¦‚æœæˆ‘ä»¬ä¸ä¿®æ”¹å…¥å‚ï¼Œä½†æ˜¯æƒ³ä¿®æ”¹è¿”å›å€¼ï¼Œåº”è¯¥æ€ä¹ˆåšï¼š&lt;/p&gt;

&lt;p&gt;æœ€ç›´æ¥çš„æ–¹å¼æ˜¯ç­‰addNumæ‰§è¡Œå®Œåï¼Œä¿®æ”¹è¿”å›å€¼å¯„å­˜å™¨ï¼Œå¦‚ä¸‹ï¼Œè¿”å›å€¼å­˜å‚¨åœ¨w0ï¼Œæˆ‘ä»¬å¯ä»¥ä¿®æ”¹æˆä»»æ„æƒ³è¦çš„å€¼ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/post/æ–°æ‰‹å°ç™½ä¹Ÿèƒ½çœ‹æ‡‚çš„é€†å‘æŠ€å·§/thread-return-register.png&quot; alt=&quot;thread-return-register&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ä½†è¿™ç§æ–¹å¼æœ‰ä¸ªå¼Šç«¯æ˜¯ï¼Œéœ€è¦ç­‰å‡½æ•°æ‰§è¡Œå®Œï¼Œåœ¨å®é™…çš„åœºæ™¯ä¸­ï¼Œæˆ‘ä»¬å¾€å¾€&lt;strong&gt;å¸Œæœ›ä¸æ‰§è¡Œå‡½æ•°ä¸”èƒ½è®©å‡½æ•°è¿”å›æˆ‘ä»¬æƒ³è¦çš„å€¼&lt;/strong&gt;ï¼Œæ¯”å¦‚ï¼šå‡½æ•°ä¸­å¯èƒ½ä¼šä¿®æ”¹å…¶ä»–å‚æ•°ï¼Œå‡½æ•°å¯èƒ½æœ‰å¤æ‚çš„é‰´æƒé€»è¾‘æ— æ³•é€šè¿‡é‰´æƒç­‰ï¼Œè¿™äº›åœºæ™¯æˆ‘ä»¬å¾€å¾€ä¸å¸Œæœ›æˆ–è€…ä¸èƒ½è®©å‡½æ•°æ‰§è¡Œï¼Œè¿™ç§æƒ…å†µä¸‹å°±éœ€è¦å¦ä¸€ä¸ªæŒ‡ä»¤ï¼š&lt;strong&gt;thread return&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;ä»¥addNumä¸ºä¾‹ï¼ŒæŒ‰å¦‚ä¸‹æ­¥éª¤æ“ä½œï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/post/æ–°æ‰‹å°ç™½ä¹Ÿèƒ½çœ‹æ‡‚çš„é€†å‘æŠ€å·§/thread-return-si.png&quot; alt=&quot;thread-return-si&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/post/æ–°æ‰‹å°ç™½ä¹Ÿèƒ½çœ‹æ‡‚çš„é€†å‘æŠ€å·§/thread-return-8.png&quot; alt=&quot;thread-return-8&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/post/æ–°æ‰‹å°ç™½ä¹Ÿèƒ½çœ‹æ‡‚çš„é€†å‘æŠ€å·§/thread-return.png&quot; alt=&quot;thread-return&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ä½¿ç”¨ thread return æ—¶ï¼Œéœ€è¦æ³¨æ„ï¼Œæˆ‘ä»¬çš„&lt;strong&gt;æ–­ç‚¹éœ€è¦æ‰“åœ¨ objc_msgSend çš„å…¥å£å¤„&lt;/strong&gt;ï¼Œå¦‚æœåœ¨ addNum çš„å…¥å£æ‰“æ–­ç‚¹æ‰§è¡Œ thread returnï¼Œæœ€ç»ˆå¯èƒ½ä¼šå¾—åˆ°éé¢„æœŸå€¼ï¼›åŸå› æ˜¯ thread return æ”¹çš„æ˜¯å½“å‰ frame çš„è¿”å›å¯„å­˜å™¨ï¼Œç”±äºObjective-Cçš„runtimeç‰¹æ€§ï¼Œå‡½æ•°è°ƒç”¨å®é™…ä¸Šæ˜¯ç»è¿‡ objc_msgSend ç»™å¯¹è±¡å‘æ¶ˆæ¯ï¼ŒaddNum çš„ä¸Šä¸€ä¸ªframeå…¶å®æ˜¯ objc_msgSendï¼Œè€Œ objc_msgSend è¿”å›æ—¶å¯èƒ½ä¼šç»§ç»­ä¿®æ”¹ w0 å¯„å­˜å™¨çš„å€¼ï¼Œä¼šå¯¼è‡´æœ€ç»ˆä¸Šå±‚å–åˆ°çš„å€¼éé¢„æœŸã€‚&lt;/p&gt;

&lt;h2 id=&quot;45-å–„ç”¨-watchpoint-å‘½ä»¤&quot;&gt;4.5 å–„ç”¨ watchpoint å‘½ä»¤&lt;/h2&gt;

&lt;p&gt;åœ¨å®é™…åœºæ™¯ä¸­ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šé‡åˆ°æŸä¸ªå˜é‡è¢«å¾ˆå¤šåœ°æ–¹ä¿®æ”¹ï¼Œä½†æ˜¯æˆ‘ä»¬åˆæ— æ³•ä¸€ä¸€æ–­ç‚¹ï¼Œæ¯”å¦‚æˆ‘ä»¬è¦æŸ¥çœ‹å“ªäº›åœ°æ–¹ä¿®æ”¹äº† UIView çš„ frameï¼›æˆ–è€…æŸä¸ªå€¼çš„ä¿®æ”¹é“¾è·¯å¾ˆæ·±ï¼Œä¸€èˆ¬åœ¨ç³»ç»Ÿåº“ä¸­æ¯”è¾ƒå¸¸è§ï¼Œæ¯”å¦‚iOSä¸­é—­åŒ…åµŒå¥—é—­åŒ…è°ƒç”¨çš„åœºæ™¯ã€‚&lt;/p&gt;

&lt;p&gt;é’ˆå¯¹ä»¥ä¸Šåœºæ™¯ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ watchpoint å‘½ä»¤ï¼Œæ¥è§‚æµ‹å˜é‡çš„ä¿®æ”¹ï¼Œwatchpoint çš„å¸¸è§ç”¨æ³•å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/post/æ–°æ‰‹å°ç™½ä¹Ÿèƒ½çœ‹æ‡‚çš„é€†å‘æŠ€å·§/watchpoint.png&quot; alt=&quot;watchpoint&quot; /&gt;&lt;/p&gt;

&lt;h1 id=&quot;äº”æ€»ç»“&quot;&gt;äº”ã€æ€»ç»“&lt;/h1&gt;

&lt;p&gt;æœ¬æ–‡æ€»ç»“äº†æˆ‘ä»¬åœ¨é€†å‘çš„é€šç”¨åˆ†ææ€è·¯ï¼Œä»¥åŠLLDBè°ƒè¯•æ±‡ç¼–é€»è¾‘ä¸­å¯èƒ½é‡åˆ°çš„å¸¸è§æŠ€å·§å’Œåœºæ™¯ï¼›æœ¬æ–‡ä¼šé•¿æœŸæ›´æ–°ï¼Œè§‰å¾—æœ‰ç”¨çš„å°ä¼™ä¼´å¯ä»¥å…³æ³¨ä¸‹å…¬ä¼—å·ï¼ŒåŠæ—¶æ¥æ”¶æ›´æ–°ï¼›å½“ç„¶ï¼Œå„è·¯å¤§ç¥æœ‰æ›´å¤šæœ‰ç”¨æŠ€å·§ï¼Œä¹Ÿæ¬¢è¿æŒ‡æ•™ï¼&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/å…¬ä¼—å·.jpg&quot; alt=&quot;å…¬ä¼—å·&quot; /&gt;&lt;/p&gt;
</description>
        <pubDate>Sun, 12 Oct 2025 00:00:00 +0800</pubDate>
        <link>http://localhost:4000/2025/10/12/%E6%96%B0%E6%89%8B%E5%B0%8F%E7%99%BD%E4%B9%9F%E8%83%BD%E7%9C%8B%E6%87%82%E7%9A%84%E9%80%86%E5%90%91%E6%8A%80%E5%B7%A7/</link>
        <guid isPermaLink="true">http://localhost:4000/2025/10/12/%E6%96%B0%E6%89%8B%E5%B0%8F%E7%99%BD%E4%B9%9F%E8%83%BD%E7%9C%8B%E6%87%82%E7%9A%84%E9%80%86%E5%90%91%E6%8A%80%E5%B7%A7/</guid>
        
        <category>é€†å‘</category>
        
        
      </item>
    
      <item>
        <title>ã€æŒç»­æ›´æ–°ã€‘æ–°æ‰‹å¿…å¤‡ï¼ï¼å¦‚ä½•ç™½å«–é€†å‘å·¥å…·</title>
        <description>&lt;h1 id=&quot;å¼•è¨€&quot;&gt;å¼•è¨€&lt;/h1&gt;

&lt;p&gt;å·¥æ¬²å–„å…¶äº‹ï¼Œå¿…å…ˆåˆ©å…¶å™¨ã€‚&lt;/p&gt;

&lt;p&gt;å‰é¢æˆ‘ä»¬é€šè¿‡é€†å‘æ‰‹æ®µåˆ†æäº†&lt;a href=&quot;https://mp.weixin.qq.com/s/EpaNjLcG6DZBc128A2gdIQ&quot;&gt;CoreTextä¸­çš„å­—ä½“çº§è”/Font Fallbackæœºåˆ¶&lt;/a&gt;ï¼Œç”¨åˆ°äº†Hopperã€IDAç­‰é€†å‘å·¥å…·ï¼Œä½†æ¥è§¦è¿‡çš„å°ä¼™ä¼´åº”è¯¥çŸ¥é“ï¼Œè¿™äº›é€†å‘å·¥å…·éƒ½æ˜¯æ”¶è´¹çš„ï¼Œå³ä½¿æœ‰å…è´¹è¯•ç”¨ï¼Œæ¯”å¦‚Hopperï¼Œä½†ä¹Ÿåªèƒ½è¯•ç”¨åŠä¸ªå°æ—¶ï¼Œé€†å‘åˆ†ææ—¶ï¼Œæ¯æ¬¡åˆšåˆ†æå‡ºä¸€ç‚¹å¤´ç»ªå°±é‡å¯äº†ï¼Œå¾ˆæ˜¯æ‰“æ–­æ€è·¯ã€‚&lt;/p&gt;

&lt;p&gt;æœ¬æ–‡å°†æ•´ç†è¿™äº›èµ„æºï¼Œç¡®ä¿æˆ‘ä»¬åœ¨åˆ†æè¿‡ç¨‹ä¸­ï¼Œèƒ½é¡ºç•…ä½¿ç”¨ï¼ï¼&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;æ–‡ä¸­æ‰€æœ‰èµ„æºå¯åœ¨ğŸŒå…¬ä¼—å·ï¼šã€Œéä¸“ä¸šç¨‹åºå‘˜Pingã€ä¸­å›å¤ã€Œé€†å‘ã€é¢†å–ï¼ŒæŒç»­æ›´æ–°ï¼ï¼&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/å…¬ä¼—å·.jpg&quot; alt=&quot;å…¬ä¼—å·&quot; /&gt;&lt;/p&gt;

&lt;h1 id=&quot;hopper&quot;&gt;Hopper&lt;/h1&gt;

&lt;p&gt;ç›´æ¥æ‰“å¼€å®‰è£…åŒ…å³å¯ä½¿ç”¨ï¼Œæ¯æ¬¡æ‰“å¼€å¯èƒ½é‡åˆ°ï¼šHopper Disassembler 5.15.4 Crackedï¼Œä¸ç”¨ç®¡ï¼Œç‚¹å‡»OKå¯ä»¥æ­£å¸¸ä½¿ç”¨ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/post/é€†å‘/Hopper.png&quot; alt=&quot;Hopper&quot; /&gt;&lt;/p&gt;

&lt;h1 id=&quot;ida&quot;&gt;IDA&lt;/h1&gt;

&lt;p&gt;ç‚¹å‡»&lt;code class=&quot;highlighter-rouge&quot;&gt;IDAPro_lin.dmg&lt;/code&gt;ç›´æ¥å®‰è£…ï¼Œä¼šå®‰è£…å¥½å‡ºä¸¤ä¸ªIDAï¼Œä¸€ä¸ª32ä½çš„ï¼Œä¸€ä¸ª64ä½çš„ï¼Œå¹³æ—¶ä½¿ç”¨æ—¶ä¸€èˆ¬ç›´æ¥ç”¨64ä½çš„å³å¯ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/post/é€†å‘/IDA.png&quot; alt=&quot;IDA&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;è§£å†³idaå·²æŸåé—®é¢˜&quot;&gt;è§£å†³IDAå·²æŸåé—®é¢˜&lt;/h2&gt;

&lt;p&gt;å‘½ä»¤è¡Œæ‰§è¡Œï¼š&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo xattr -rd com.apple.quarantine /Applications/IDA\ Pro\ 7.0/ida.app/
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;è§£å†³ä¸­æ–‡è¾“å…¥æ³•ä¸‹ida-crashé—®é¢˜&quot;&gt;è§£å†³ä¸­æ–‡è¾“å…¥æ³•ä¸‹IDA Crashé—®é¢˜&lt;/h2&gt;

&lt;p&gt;å°†&lt;code class=&quot;highlighter-rouge&quot;&gt;libqcocoa.dylib&lt;/code&gt;æ–‡ä»¶æ›¿æ¢&lt;code class=&quot;highlighter-rouge&quot;&gt;/Applications/IDA Pro 7.0/ida64.app/Contents/PlugIns/platforms&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/post/é€†å‘/libqcocoa.png&quot; alt=&quot;libqcocoa&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;idaå¸¸ç”¨å¿«æ·é”®&quot;&gt;IDAå¸¸ç”¨å¿«æ·é”®&lt;/h2&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;å¿«æ·é”®&lt;/th&gt;
      &lt;th&gt;ç”¨é€”&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;Control + F&lt;/td&gt;
      &lt;td&gt;æœç´¢å‡½æ•°&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;F5&lt;/td&gt;
      &lt;td&gt;åæ±‡ç¼–å‡½æ•°&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;&lt;img src=&quot;/img/post/é€†å‘/IDA_use.png&quot; alt=&quot;IDA_use&quot; /&gt;&lt;/p&gt;
</description>
        <pubDate>Sat, 11 Oct 2025 00:00:00 +0800</pubDate>
        <link>http://localhost:4000/2025/10/11/%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/</link>
        <guid isPermaLink="true">http://localhost:4000/2025/10/11/%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/</guid>
        
        <category>é€†å‘</category>
        
        
      </item>
    
      <item>
        <title>CoreText Font Fallback</title>
        <description>&lt;h1 id=&quot;ä¸€å¼•è¨€&quot;&gt;ä¸€ã€å¼•è¨€&lt;/h1&gt;

&lt;blockquote&gt;
  &lt;p&gt;æœ¬æ–‡åŸºäºXcode 16.4ï¼ŒiOS 18.5æ¨¡æ‹Ÿå™¨åˆ†æï¼Œä¸åŒç³»ç»Ÿç‰ˆæœ¬å¯èƒ½æœ‰åŒºåˆ«ã€‚&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;å‰é¢æˆ‘ä»¬ä»‹ç»äº†&lt;a href=&quot;https://mp.weixin.qq.com/s/fcL6if52qYQUTChEjntHJg&quot;&gt;è‡ªå®šä¹‰æ–‡å­—æ’ç‰ˆå¼•æ“çš„åŸç†&lt;/a&gt;ï¼Œå…¶ä¸­æœ‰ä¸€ä¸ªå¤æ‚éƒ¨åˆ†æ˜¯å­—ä½“Fallbackï¼Œæœ¬æ–‡å°†é€šè¿‡é€†å‘æ‰‹æ®µåˆ†æCoreTextä¸­&lt;code class=&quot;highlighter-rouge&quot;&gt;CTFontCopyDefaultCascadeListForLanguages&lt;/code&gt;çš„å®ç°ï¼Œé€šè¿‡äº†è§£ç³»ç»Ÿçš„å­—ä½“å›é€€å®ç°ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬å®ç°æ›´å¥½çš„ç”Ÿäº§çº§åˆ«çš„æ–‡å­—æ’ç‰ˆå¼•æ“ã€‚&lt;/p&gt;

&lt;p&gt;åœ¨å¼€å§‹ä¹‹å‰ï¼Œå…ˆä»‹ç»ä¸‹&lt;code class=&quot;highlighter-rouge&quot;&gt;CTFontCopyDefaultCascadeListForLanguages&lt;/code&gt; APIï¼Œå…¶å®Œæ•´çš„å‡½æ•°ç­¾åå¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;å®˜æ–¹æ–‡æ¡£ï¼šhttps://developer.apple.com/documentation/coretext/ctfontcopydefaultcascadelistforlanguages(&lt;em&gt;:&lt;/em&gt;:)&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;language-swift highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;CTFontCopyDefaultCascadeListForLanguages&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;font&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;CTFont&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;languagePrefList&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;CFArray&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;?&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;CFArray&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;?&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ä¸€ä¸ªå­—ä½“ä¸å¯èƒ½æ”¯æŒæ‰€æœ‰çš„Unicodeï¼Œæ¯”å¦‚Helveticaä¸æ”¯æŒä¸­æ–‡ï¼ŒPingFangä¸æ”¯æŒéŸ©æ–‡ï¼Œåœ¨å®é™…æ¸²æŸ“æ—¶ï¼Œå¾€å¾€æ˜¯å¤šä¸ªå­—ä½“å…±åŒå‚ä¸å®Œæˆçš„ï¼Œå¦å¤–ä¸åŒå­—ä½“æ”¯æŒçš„Unicodeæœ‰äº¤é›†ï¼Œé‚£æœ€ç»ˆé€‰æ‹©å“ªä¸ªå­—ä½“ä¹Ÿæ˜¯æœ‰ä¼˜å…ˆçº§çš„ï¼›&lt;code class=&quot;highlighter-rouge&quot;&gt;CTFontCopyDefaultCascadeListForLanguages&lt;/code&gt;çš„ä½œç”¨å°±æ˜¯ï¼šç»™å®šä¸€ä¸ªå­—ä½“å’Œè¯­è¨€åˆ—è¡¨ï¼Œè¿”å›ç³»ç»Ÿé»˜è®¤çš„Fallbackåˆ—è¡¨ï¼ˆä¹Ÿå«çº§è”åˆ—è¡¨ï¼ŒCascadeListï¼‰ï¼Œç®€å•ç†è§£å°±æ˜¯ç³»ç»Ÿä¼šæŒ‰è¿™ä¸ªFallabckåˆ—è¡¨è¿›è¡Œä¼˜å…ˆçº§é€‰æ‹©Fallbackå­—ä½“ã€‚&lt;/p&gt;

&lt;p&gt;åœ¨macOS/iOSä¸­ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡&lt;code class=&quot;highlighter-rouge&quot;&gt;kCTFontCascadeListAttribute&lt;/code&gt;æ˜¾ç¤ºæŒ‡å®šFallbacké“¾ï¼ˆå¦‚ä¸‹ï¼‰ï¼Œè¿™æ ·å°±èƒ½è‡ªå®šä¹‰Fallbackï¼Œå½“ç„¶ï¼Œå¦‚æœä¸æŒ‡å®šçš„è¯ä¼šç³»ç»Ÿä¹Ÿä¼šå¯ç”¨é»˜è®¤Fallbackï¼Œæ¥å°½é‡ä¿è¯æ–‡æœ¬æ¸²æŸ“æ­£ç¡®ã€‚&lt;/p&gt;

&lt;div class=&quot;language-swift highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;makeAttributedStringWithFallback&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;text&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;baseFontName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;Helvetica&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;CGFloat&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;languages&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;zh-Hans&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;ja&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;ko&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;NSAttributedString&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;baseFont&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;CTFontCreateWithName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;baseFontName&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;CFString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;nil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;fallbacks&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;CTFontCopyDefaultCascadeListForLanguages&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;baseFont&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;languages&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;CFArray&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;as?&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;CTFontDescriptor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;??&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;attributes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;CFString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Any&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;kCTFontNameAttribute&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;baseFontName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;kCTFontSizeAttribute&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
  	&lt;span class=&quot;c1&quot;&gt;// å¯ä»¥åœ¨è¿™é‡Œä¿®æ”¹fallbacksï¼Œæ¥è‡ªå®šä¹‰å›é€€&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fallbacks&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;isEmpty&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;attributes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;kCTFontCascadeListAttribute&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fallbacks&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;newDescriptor&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;CTFontDescriptorCreateWithAttributes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;attributes&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;CFDictionary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;finalFont&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;CTFontCreateWithFontDescriptor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;newDescriptor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;nil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;attributesDict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;NSAttributedString&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Any&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;font&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;finalFont&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;NSAttributedString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;text&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;attributes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;attributesDict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ä¸‹é¢ï¼Œæˆ‘ä»¬æŒ‰å¦‚ä¸‹è°ƒç”¨Demoæ¥å®é™…ç ”ç©¶ä¸‹ï¼š&lt;/p&gt;

&lt;div class=&quot;language-swift highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;ctFont&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;UIFont&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;systemFont&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;ofSize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;languages&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;zh-Hans&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;cascadeList&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;CTFontCopyDefaultCascadeListForLanguages&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ctFont&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;languages&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;CFArray&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;äºŒè°ƒç”¨é“¾è·¯&quot;&gt;äºŒã€è°ƒç”¨é“¾è·¯&lt;/h1&gt;

&lt;p&gt;&lt;img src=&quot;/img/post/FontFallback/CTFontCopyDefaultCascadeListForLanguages.png&quot; alt=&quot;CTFontCopyDefaultCascadeListForLanguages&quot; /&gt;&lt;/p&gt;

&lt;p&gt;å¦‚ä¸Šæ˜¯&lt;code class=&quot;highlighter-rouge&quot;&gt;CTFontCopyDefaultCascadeListForLanguages&lt;/code&gt;çš„è°ƒç”¨é“¾è·¯ï¼Œå¯ä»¥çœ‹å‡ºå¤§è‡´åˆ†ä¸ºä¸¤æ¡å¤„ç†é“¾è·¯ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;Preset Fallbacks&lt;/strong&gt;ï¼šç³»ç»Ÿé¢„è®¾Fallbackï¼Œè¿™æ˜¯ä¸€ä¸ªâ€œå¿«é€Ÿé€šé“â€ï¼Œç³»ç»Ÿå†…éƒ¨ç»´æŠ¤äº†ä¸€ä¸ªé’ˆå¯¹ç‰¹å®šå­—ä½“ï¼ˆå¦‚ç³»ç»ŸUIå­—ä½“ï¼‰çš„ç¡¬ç¼–ç Fallbackåˆ—è¡¨ï¼Œå¦‚æœè¯·æ±‚çš„ä¸»å­—ä½“åœ¨è¿™ä¸ªé¢„è®¾åˆ—è¡¨ä¸­ï¼Œç³»ç»Ÿä¼šç›´æ¥ä½¿ç”¨è¿™ä¸ªåˆ—è¡¨ï¼Œé€Ÿåº¦éå¸¸å¿«ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;System Default Fallbacks&lt;/strong&gt;ï¼šç³»ç»Ÿé»˜è®¤Fallbackï¼Œè¿™æ˜¯ä¸€ä¸ªâ€œé€šç”¨é€šé“â€ï¼Œå¦‚æœé¢„è®¾åˆ—è¡¨æ²¡æœ‰å‘½ä¸­ï¼Œç³»ç»Ÿä¼šå¯åŠ¨é»˜è®¤Fallbackæµç¨‹ï¼Œè¯¥æµç¨‹ä¼šåŠ è½½ä¸€ä¸ªå…¨å±€çš„ã€å®šä¹‰äº†å®Œæ•´å›é€€è§„åˆ™çš„é…ç½®æ–‡ä»¶ï¼Œæ ¹æ®ç”¨æˆ·çš„è¯­è¨€åå¥½è®¾ç½®ï¼ŒåŠ¨æ€åœ°ä¸ºè¯·æ±‚çš„å­—ä½“ç”Ÿæˆä¸€ä¸ªFallbackåˆ—è¡¨ï¼Œå¹¶è¿›è¡Œç¼“å­˜ä»¥æé«˜åç»­è°ƒç”¨æ•ˆç‡ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;åæ–‡æˆ‘ä»¬ä¹Ÿå°†æŒ‰è¿™ä¸¤ä¸ªæµç¨‹åˆ†å¼€åˆ†æã€‚&lt;/p&gt;

&lt;p&gt;å®Œæ•´çš„åæ±‡ç¼–é€»è¾‘å’Œæ³¨é‡Šå¯ä»¥å‚è€ƒï¼šhttps://github.com/HusterYP/FontFallback&lt;/p&gt;

&lt;h1 id=&quot;ä¸‰tbasefontcreatefallbacks&quot;&gt;ä¸‰ã€TBaseFont::CreateFallbacks&lt;/h1&gt;

&lt;pre&gt;&lt;code class=&quot;language-assembly&quot;&gt;/**
* æ ¸å¿ƒåˆ†å‘å‡½æ•°ï¼Œå†³å®šæ˜¯ä½¿ç”¨é¢„è®¾Fallbackè¿˜æ˜¯ç³»ç»Ÿé»˜è®¤Fallbackã€‚
*
* @param result@&amp;lt;X0&amp;gt; (TBaseFont*) TBaseFont å®ä¾‹ã€‚
* @param a2@&amp;lt;X1&amp;gt;     (int) æ ‡å¿—ä½ï¼Œå¯èƒ½è¡¨ç¤ºæ˜¯å¦ä¸ºç³»ç»ŸUIå­—ä½“ã€‚
* @param a3@&amp;lt;X2&amp;gt;     (int) å­—ä½“å±æ€§ã€‚
* @param a4@&amp;lt;X3&amp;gt;     (_QWORD*) æœªçŸ¥å‚æ•°ï¼Œå¯èƒ½æ˜¯å­—ç¬¦é›†ã€‚
* @param a5@&amp;lt;X4&amp;gt;     (CFArrayRef) è¯­è¨€åˆ—è¡¨ã€‚
* @param a6@&amp;lt;X8&amp;gt;     (_QWORD*) ç”¨äºæ¥æ”¶ç»“æœçš„è¾“å‡ºæŒ‡é’ˆã€‚
*
* @return __int64 æ— å®é™…æ„ä¹‰ã€‚
 */
__int64 __usercall TBaseFont::CreateFallbacks@&amp;lt;X0&amp;gt;(__int64 result@&amp;lt;X0&amp;gt;, __int64 a2@&amp;lt;X1&amp;gt;, __int64 a3@&amp;lt;X2&amp;gt;, __int64 a4@&amp;lt;X3&amp;gt;, __int64 a5@&amp;lt;X4&amp;gt;, _QWORD *a6@&amp;lt;X8&amp;gt;)
{
	...
  // ä¿å­˜å‚æ•°
  v6 = a3;  // å­—ä½“ç‰¹æ€§æ ‡å¿—
  v7 = a5;  // è¯­è¨€æ•°ç»„æŒ‡é’ˆ
  v8 = a2;  // ç³»ç»ŸUIå­—ä½“æ ‡å¿—
  v9 = (TBaseFont *)result;  // åŸºç¡€å­—ä½“å¯¹è±¡
  ...
  // å¦‚æœç³»ç»ŸUIå­—ä½“æ ‡å¿—ä¸ä¸º 0ï¼Œå°è¯•åˆ›å»ºé¢„è®¾å­—ä½“å›é€€
  if ( (_DWORD)a2 )
  {
    v11 = (_QWORD *)a4;
    // ä»å­—ä½“å¯¹è±¡ä¸­è·å–å­—ä½“åï¼Œå¦‚.SFUI-Regular
    v12 = (*(__int64 (**)(void))(*(_QWORD *)result + 560LL))();
    if ( v12 )
    {
      v13 = v12;
      // åˆå§‹åŒ–å­—ä½“æè¿°ç¬¦æºå¯¹è±¡
      TDescriptorSource::TDescriptorSource((TDescriptorSource *)&amp;amp;v33);
      _X26 = &amp;amp;v34;
      // åˆ›å»ºé¢„è®¾å­—ä½“å›é€€åˆ—è¡¨
      _X0 = TDescriptorSource::CreatePresetFallbacks(v13, v11, v7, v6, &amp;amp;v34);
      ...
    }
  }
  // æ£€æŸ¥é¢„è®¾å­—ä½“å›é€€æ˜¯å¦æˆåŠŸåˆ›å»º
  v24 = objc_retain(_X0);
  if ( v24 )
  {
    v25 = v24;
    v26 = CFArrayGetCount(v24);
    result = objc_release(v25);
    // å¦‚æœé¢„è®¾å­—ä½“å›é€€ä¸ä¸ºç©ºï¼Œç›´æ¥è¿”å›
    if ( v26 )
      return result;
  }
  ...
  // å¦‚æœé¢„è®¾å­—ä½“å›é€€ä¸ºç©ºï¼Œåˆ›å»ºç³»ç»Ÿé»˜è®¤å­—ä½“å›é€€
  v27 = TBaseFont::GetCSSFamily(v9);
  _X23 = &amp;amp;v34;

  // åˆ›å»ºç³»ç»Ÿé»˜è®¤å­—ä½“å›é€€åˆ—è¡¨
  _X0 = TBaseFont::CreateSystemDefaultFallbacks((__int64)v9, v27, v7, v8, &amp;amp;v34);
  ...
  return result;
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¿™æ˜¯å¤„ç†é¢„è®¾Fallbackå’Œé»˜è®¤Fallbackçš„å…¥å£å‡½æ•°ã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;1ï¼‰&lt;code class=&quot;highlighter-rouge&quot;&gt;result@&amp;lt;X0&amp;gt;&lt;/code&gt;å‚æ•°æ˜¯ä»€ä¹ˆ&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;é¦–å…ˆæˆ‘ä»¬ä¸»è¦å…³æ³¨çš„æ˜¯ç¬¬ä¸€ä¸ªå…¥å‚&lt;code class=&quot;highlighter-rouge&quot;&gt;result@&amp;lt;X0&amp;gt;&lt;/code&gt;ï¼Œæˆ‘ä»¬å…ˆå°è¯•åæ±‡ç¼–x0ï¼Œå‘ç°å®ƒå…¶å®æŒ‡å‘çš„æ˜¯ç±» &lt;code class=&quot;highlighter-rouge&quot;&gt;TTenuousComponentFont&lt;/code&gt; ï¼ˆCoreText å†…éƒ¨çš„ä¸€ä¸ªç§æœ‰ç±»ï¼Œç»§æ‰¿è‡ª &lt;code class=&quot;highlighter-rouge&quot;&gt;TBaseFont&lt;/code&gt;ï¼‰çš„è™šå‡½æ•°è¡¨ï¼Œå¦‚ä¸‹ï¼Œä¸‹é¢çš„&lt;code class=&quot;highlighter-rouge&quot;&gt;udf&lt;/code&gt; å…¶å®æ˜¯å› ä¸ºLLDBå°è¯•å°†æ•°æ®å½“ä»£ç è§£è¯»ï¼Œä½†å…¶å®å®ƒæ˜¯ä¸€ä¸ªæŒ‡é’ˆè¡¨ï¼Œæ‰€ä»¥è¯†åˆ«æˆäº†æœªå®šä¹‰ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/post/FontFallback/CreateFallbacks-1.png&quot; alt=&quot;CreateFallbacks-1&quot; /&gt;&lt;/p&gt;

&lt;p&gt;CoreText æ˜¯ç”± C++ å’Œ Objective-C æ··åˆå®ç°çš„ï¼ŒC++ç±»å¯¹è±¡çš„æ–¹æ³•è°ƒç”¨æ˜¯é€šè¿‡è™šå‡½æ•°è¡¨ï¼ˆvtableï¼‰å®ç°çš„ï¼ŒC++ è™šè¡¨æ˜¯ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆæ•°ç»„ï¼Œå¯¹è±¡é‡Œä¿å­˜ç€ä¸€ä¸ª vptrï¼ˆè™šè¡¨æŒ‡é’ˆï¼‰ï¼ŒæŒ‡å‘å®ƒæ‰€å±ç±»çš„ vtableã€‚&lt;/p&gt;

&lt;p&gt;ä¸‹é¢æˆ‘ä»¬å°è¯•å°†&lt;code class=&quot;highlighter-rouge&quot;&gt;result@&amp;lt;X0&amp;gt;&lt;/code&gt;æŒ‰è™šè¡¨æŒ‡é’ˆè§£æï¼Œä¸»è¦æ˜¯&lt;code class=&quot;highlighter-rouge&quot;&gt;dis -c 5 -s xxx&lt;/code&gt;ï¼Œå¯ä»¥é€šè¿‡è¿™ç§æ–¹å¼ç´¢å¼•å„æ–¹æ³•ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/post/FontFallback/CreateFallbacks-2.png&quot; alt=&quot;CreateFallbacks&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ç»§ç»­å¾€ä¸Šè¿½æº¯ï¼Œ&lt;code class=&quot;highlighter-rouge&quot;&gt;result@&amp;lt;X0&amp;gt;&lt;/code&gt;å…¶å®æ¥è‡ªåŸå§‹å…¥å‚CTFontä¸­çš„ä¸€ä¸ªå±æ€§ã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;2ï¼‰ä»€ä¹ˆæƒ…å†µä¸‹ä¼šè§¦å‘Preset Fallbacks&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;æå–ä¸»è¦æ§åˆ¶é€»è¾‘å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-assembly&quot;&gt;// å¦‚æœç³»ç»ŸUIå­—ä½“æ ‡å¿—ä¸ä¸º 0ï¼Œå°è¯•åˆ›å»ºé¢„è®¾å­—ä½“å›é€€
if ( (_DWORD)a2 )
{
  v11 = (_QWORD *)a4;
  // ä»å­—ä½“å¯¹è±¡ä¸­è·å–å­—ä½“åï¼Œå¦‚.SFUI-Regular
  v12 = (*(__int64 (**)(void))(*(_QWORD *)result + 560LL))();
  if ( v12 )
  {
  	...
  }
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å¯ä»¥å‘ç°å½“&lt;code class=&quot;highlighter-rouge&quot;&gt;a2&lt;/code&gt;é0æ—¶ä¼šè§¦å‘Preset Fallbacksï¼Œç»§ç»­å¾€ä¸Šè¿½æº¯&lt;code class=&quot;highlighter-rouge&quot;&gt;a2&lt;/code&gt;æ¥è‡ªäº&lt;code class=&quot;highlighter-rouge&quot;&gt;TFont::IsSystemUIFontAndForShaping((TFont *)v5, &amp;amp;v14)&lt;/code&gt;ï¼Œ&lt;code class=&quot;highlighter-rouge&quot;&gt;IsSystemUIFontAndForShaping&lt;/code&gt;ä¸åœ¨æœ¬æ–‡é‡ç‚¹ï¼Œç®€å•ç†è§£å°±æ˜¯å¦‚æœæ˜¯ç³»ç»ŸUIå­—ä½“ä¸”ç”¨äºæ–‡æœ¬å¡‘å½¢çš„å­—ä½“åˆ™è¿”å›trueï¼Œæ¯”å¦‚å…¸å‹çš„&lt;code class=&quot;highlighter-rouge&quot;&gt;UIFont.systemFont&lt;/code&gt;ï¼ˆ&lt;code class=&quot;highlighter-rouge&quot;&gt;.SFUI-Regular&lt;/code&gt;ï¼šSan Francisco (SF)å­—ä½“å®¶æ—ä¸­çš„å­—ä½“ï¼‰åˆ¤å®šä¸ºtrueã€‚&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Qï¼šä¸ºä»€ä¹ˆåªæœ‰ç³»ç»ŸUIå­—ä½“æ‰æœ‰é¢„è®¾Fallback&lt;/p&gt;

  &lt;p&gt;ç®€å•ç†è§£å°±æ˜¯åªæœ‰ç³»ç»ŸUIå­—ä½“æ˜¯ç³»ç»Ÿå®Œå…¨å¯æ§å¯æ„ŸçŸ¥çš„ï¼Œæ‰€ä»¥å¯ä»¥æå‰æ„å»ºFallbackåˆ—è¡¨&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;strong&gt;3ï¼‰ä»€ä¹ˆæƒ…å†µä¸‹ä¼šè§¦å‘System Default Fallbacks&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;ä»ä¸Šé¢åæ±‡ç¼–é€»è¾‘æ¯”è¾ƒå®¹æ˜“çœ‹å‡ºï¼Œå½“Preset Fallbacksçš„ç»“æœä¸ºç©ºæ—¶ï¼Œä¼šç»§ç»­èµ°System Default Fallbackså…œåº•ã€‚&lt;/p&gt;

&lt;h1 id=&quot;å››preset-fallbacks&quot;&gt;å››ã€Preset Fallbacks&lt;/h1&gt;

&lt;h2 id=&quot;41-è·å–å…¨å±€é¢„è®¾fallbackåˆ—è¡¨ctpresetfallbacks&quot;&gt;4.1 è·å–å…¨å±€é¢„è®¾Fallbackåˆ—è¡¨CTPresetFallbacks&lt;/h2&gt;

&lt;p&gt;åœ¨åˆ†æç³»ç»Ÿæ˜¯å¦‚ä½•ä¸ºç‰¹å®šå­—ä½“æ„å»ºé¢„è®¾Fallbackï¼ˆå­—ä½“çš„çº§è”åˆ—è¡¨ï¼‰ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆçŸ¥é“é¢„è®¾åˆ—è¡¨æ˜¯ä»å“ªé‡Œè¯»å–çš„ã€‚&lt;/p&gt;

&lt;p&gt;ç³»ç»Ÿæ˜¯é€šè¿‡&lt;code class=&quot;highlighter-rouge&quot;&gt;GetCTPresetFallbacksDictionary&lt;/code&gt;è·å–é¢„è®¾åˆ—è¡¨çš„ï¼Œç»§ç»­å¾€ä¸‹è¿½æº¯é¢„è®¾åˆ—è¡¨æœ€ç»ˆæ¥è‡ª&lt;code class=&quot;highlighter-rouge&quot;&gt;GSFontCacheGetData&lt;/code&gt;ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-assembly&quot;&gt;/*
 * å‡½æ•°: GSFontCacheGetData
 * -------------------------
 * @brief  ä»å›¾å½¢æœåŠ¡ï¼ˆGraphicsServicesï¼‰çš„å­—ä½“ç¼“å­˜ä¸­æ ¹æ®é”®åè·å–æ•°æ®ã€‚
 * @param  a1 (void*)      Stringå…¥å‚ï¼Œå®é™…æ˜¯å¯¹åº”pliståç§°ï¼Œæ¯”å¦‚é¢„è®¾åˆ—è¡¨çš„pliståç§°CTPresetFallbacks.plist
 * @param  a2 (const char*) åœ¨æ­¤åæ±‡ç¼–ä¸­æœªä½¿ç”¨ï¼Œå¯èƒ½æ˜¯å¯„å­˜å™¨ä¼ å‚çš„æ®‹ç•™ã€‚
 * @return (void*)         è¿”å›ä¸€ä¸ªæŒ‡å‘ç¼“å­˜æ•°æ®çš„æŒ‡é’ˆï¼Œå¦‚æœæ‰¾ä¸åˆ°åˆ™å¯èƒ½è¿”å›NULLã€‚
 */
void *__fastcall GSFontCacheGetData(void *a1, const char *a2)
{
  // =================================================================
  // å¿«é€Ÿé€šé“ 1: æ£€æŸ¥æ˜¯å¦è¯·æ±‚ &quot;DefaultFontFallbacks.plist&quot;
  // =================================================================
  // è°ƒç”¨ a1 çš„ isEqualToString: æ–¹æ³•ï¼Œä¸å­—ç¬¦ä¸² &quot;DefaultFontFallbacks.plist&quot;ï¼ˆstru_6BEB8ï¼‰æ¯”è¾ƒ
  if ( (unsigned int)objc_msgSend_isEqualToString_(a1, a2, &amp;amp;stru_6BEB8) )
  {
    // å¦‚æœæ˜¯ï¼Œç›´æ¥è¿”å›å…¨å±€å˜é‡ kDefaultFontFallbacks çš„å€¼ã€‚
    // è¿™æ˜¯ä¸€ä¸ªéå¸¸é«˜æ•ˆçš„ç¡¬ç¼–ç è·¯å¾„ï¼Œç”¨äºè·å–é»˜è®¤çš„åå¤‡å­—ä½“è§„åˆ™ã€‚
    v4 = &amp;amp;kDefaultFontFallbacks;
    return (void *)*v4;
  }

  // =================================================================
  // å¿«é€Ÿé€šé“ 2: æ£€æŸ¥æ˜¯å¦è¯·æ±‚ &quot;CTPresetFallbacks.plist&quot;
  // =================================================================
  // è°ƒç”¨ a1 çš„ isEqualToString: æ–¹æ³•ï¼Œä¸å­—ç¬¦ä¸² &quot;CTPresetFallbacks.plist&quot;ï¼ˆstru_6BED8ï¼‰æ¯”è¾ƒ
  if ( (unsigned int)objc_msgSend_isEqualToString_(v2, v3, &amp;amp;stru_6BED8) )
  {
    // å¦‚æœæ˜¯ï¼Œç›´æ¥è¿”å›å…¨å±€å˜é‡ CTPresetFallbacks çš„å€¼ã€‚
    // è¿™æ­£æ˜¯æˆ‘ä»¬ä¹‹å‰åˆ†æçš„ã€åŒ…å«äº†æ‰€æœ‰é¢„è®¾åå¤‡è§„åˆ™çš„é‚£ä¸ª.plistæ–‡ä»¶çš„å†…å®¹ã€‚
    // ç³»ç»Ÿé€šè¿‡è¿™ä¸ªé”®æ¥åŠ è½½æ•´ä¸ªé¢„è®¾åå¤‡å­—å…¸ã€‚
    v4 = &amp;amp;CTPresetFallbacks;
    return (void *)*v4;
  }

  // =================================================================
  // å¿«é€Ÿé€šé“ 3: æ£€æŸ¥æ˜¯å¦è¯·æ±‚æŸä¸ªç‰¹æ®Šå­—å…¸
  // =================================================================
  // è°ƒç”¨ a1 çš„ isEqualToString: æ–¹æ³•ï¼Œä¸å­—ç¬¦ä¸² &quot;CTFontInfo.plist&quot;ï¼ˆstru_6BEF8ï¼‰æ¯”è¾ƒ
  if ( !((unsigned __int64)objc_msgSend_isEqualToString_(v2, v5, &amp;amp;stru_6BEF8) &amp;amp; 1) )
  {
    // å¦‚æœé”®ä¸æ˜¯ stru_6BEF8ï¼Œåˆ™è¿›å…¥ä¸‹é¢çš„å¸¸è§„æŸ¥è¯¢é€»è¾‘
    // =================================================================
    // å¸¸è§„æŸ¥è¯¢è·¯å¾„: åœ¨ä¸€ä¸ªå…¨å±€å­—å…¸ (unk_1EB8F0) ä¸­æŸ¥æ‰¾
    // =================================================================
    // æ£€æŸ¥é”®æ˜¯å¦ä¸º &quot;CTCharacterSets.plist&quot; (stru_6BF18)
    if ( (unsigned int)objc_msgSend_isEqualToString_(v2, v7, &amp;amp;stru_6BF18) )
    {
      // **é”®åè½¬æ¢/åˆ«å**: å¦‚æœæ˜¯ï¼Œåˆ™å°†è¦æŸ¥è¯¢çš„é”®æ›¿æ¢ä¸ºå¦ä¸€ä¸ªå­—ç¬¦ä¸² &quot;CTCharacterSets&quot; (stru_6BF38)
      v9 = &amp;amp;stru_6BF38;
    }
    // æ£€æŸ¥é”®æ˜¯å¦ä¸º &quot;GSFontCache.plist&quot; (stru_6BF58)
    else if ( (unsigned int)objc_msgSend_isEqualToString_(v2, v8, &amp;amp;stru_6BF58) )
    {
      // **é”®åè½¬æ¢/åˆ«å**: å¦‚æœæ˜¯ï¼Œåˆ™å°†è¦æŸ¥è¯¢çš„é”®æ›¿æ¢ä¸ºå¦ä¸€ä¸ªå­—ç¬¦ä¸² &quot;GSFontCache&quot; (stru_6BF78)
      v9 = &amp;amp;stru_6BF78;
    }
    else
    {
      // æ£€æŸ¥é”®æ˜¯å¦ä¸º &quot;CoreTextConfig.plist&quot; (stru_6BF98)
      if ( !(unsigned int)objc_msgSend_isEqualToString_(v2, v8, &amp;amp;stru_6BF98) )
        // å¦‚æœé”®ä¸åŒ¹é…ä¸Šé¢ä»»ä½•ä¸€ä¸ªéœ€è¦è½¬æ¢çš„é”®ï¼Œåˆ™ä½¿ç”¨åŸå§‹çš„é”® v2 åœ¨å…¨å±€å­—å…¸ä¸­æŸ¥æ‰¾
        return objc_msgSend_objectForKey_(&amp;amp;unk_1EB8F0, v8, v2);
      
      // **é”®åè½¬æ¢/åˆ«å**: å¦‚æœé”®æ˜¯ stru_6BF98ï¼Œåˆ™å°†å…¶æ›¿æ¢ä¸º &quot;CoreTextConfig&quot; (stru_6BFB8)
      v9 = &amp;amp;stru_6BFB8;
    }
    
    // å¯¹äºæ‰€æœ‰ç»è¿‡â€œé”®åè½¬æ¢â€çš„æƒ…å†µï¼Œä½¿ç”¨è½¬æ¢åçš„æ–°é”® v9 åœ¨å…¨å±€å­—å…¸ä¸­æŸ¥æ‰¾
    // objectForKeyedSubscript: æ˜¯ OC ä¸­å­—å…¸ä¸‹æ ‡è¯­æ³• (dictionary[key]) çš„åº•å±‚å®ç°
    return objc_msgSend_objectForKeyedSubscript_(&amp;amp;unk_1EB8F0, v8, v9);
  }

  // å¦‚æœå¿«é€Ÿé€šé“3çš„æ£€æŸ¥ä¸ºçœŸ (é”®ç­‰äº stru_6BEF8)ï¼Œåˆ™ç›´æ¥è¿”å›æ•´ä¸ªå…¨å±€å­—å…¸ unk_1EB8F0
  return &amp;amp;unk_1EB8F0;
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ä»åæ±‡ç¼–é€»è¾‘ä¸å¤ªå®¹æ˜“çœ‹ï¼Œå¯ä»¥ç»“åˆLLDB Debugä¸€èµ·åˆ†æï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/post/FontFallback/CTPresetFallbacks-plist.png&quot; alt=&quot;CTPresetFallbacks-plist&quot; /&gt;&lt;/p&gt;

&lt;p&gt;åœ¨æŸ¥è¯¢é¢„è®¾åˆ—è¡¨æ—¶ï¼Œå…¥å‚æ˜¯&lt;code class=&quot;highlighter-rouge&quot;&gt;CTPresetFallbacks.plist&lt;/code&gt;ï¼Œç³»ç»Ÿä¼šä»&lt;strong&gt;å…¨å±€å˜é‡CTPresetFallbacks&lt;/strong&gt;ä¸­è¯»å–é¢„è®¾åˆ—è¡¨ï¼ŒCTPresetFallbacksæ˜¯å…¨å±€å…±äº«çš„ï¼Œæ˜¯åœ¨CoreTextæœåŠ¡å¯åŠ¨æ—¶æ„å»ºçš„ä¸€ä¸ªå…¨å±€å¸¸é‡ï¼Œå†…å®¹å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;å®Œæ•´åˆ—è¡¨è§ï¼šhttps://github.com/HusterYP/FontFallback/blob/main/CTPresetFallbacks.plist&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;language-json highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;.SFUI-Regular&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;     &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;.AppleSystemFallback-Regular&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;.AppleColorEmojiUI&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;.SFGeorgian-Regular&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;HelveticaNeue&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;.AppleSymbolsFB&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;ar&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;.AppleArabicFont-Regular&quot;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;//&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;å¦‚æœç³»ç»Ÿè¯­è¨€æ˜¯é˜¿æ‹‰ä¼¯è¯­(ar)ï¼Œåˆ™ä½¿ç”¨æ­¤å­—ä½“&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;ur&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;.AppleUrduFont-Regular&quot;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;//&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;å¦‚æœæ˜¯ä¹Œå°”éƒ½è¯­(ur)ï¼Œåˆ™ä½¿ç”¨æ­¤å­—ä½“&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;ja&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;.AppleJapaneseFont-Regular&quot;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;//&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;å¦‚æœæ˜¯æ—¥è¯­(ja)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;ko&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;.AppleKoreanFont-Regular&quot;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;//&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;å¦‚æœæ˜¯éŸ©è¯­(ko)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;my&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;NotoSansMyanmar-Regular&quot;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;my-Qaag&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;NotoSansZawgyi-Regular&quot;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;zh-HK&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;.AppleHongKongChineseFont-Regular&quot;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;//&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;é¦™æ¸¯ç¹ä½“ä¸­æ–‡&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;zh-Hans&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;.AppleSimplifiedChineseFont-Regular&quot;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;//&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;ç®€ä½“ä¸­æ–‡&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;zh-Hant&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;.AppleTraditionalChineseFont-Regular&quot;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;//&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;å°æ¹¾ç¹ä½“ä¸­æ–‡&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;zh-MO&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;.AppleMacaoChineseFont-Regular&quot;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;.ThonburiUI-Regular&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;.SFHebrew-Regular&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;.SFArmenian-Regular&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;.AppleIndicFont-Regular&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;KohinoorDevanagari-Regular&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;Kailasa&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;KohinoorBangla-Regular&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;KohinoorGujarati-Regular&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;MuktaMahee-Regular&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;NotoSansKannada-Regular&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;KhmerSangamMN&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;LaoSangamMN&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;MalayalamSangamMN&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;NotoSansOriya&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;SinhalaSangamMN&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;TamilSangamMN&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;KohinoorTelugu-Regular&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;NotoSansArmenian-Regular&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;EuphemiaUCAS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Menlo-Regular&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;AppleSymbols&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;ArialMT&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;STIXTwoMath-Regular&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;.HiraKakuInterface-W4&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;HelveticaNeue&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Kefa-Regular&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;Galvji&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;.PhoneFallback&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;SystemWideFallbacks&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;     &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;128&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;887&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Charter-Roman&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;895&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;895&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;DINCondensed-Bold&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;975&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1315&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Charter-Roman&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1316&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1319&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;.SFUI-Regular&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
				&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;CTPresetFallbacks.plistä¸­ä¸»è¦å®šä¹‰äº†ä¸¤ç»„å†…å®¹ï¼š&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;1ï¼‰ä¸ºç‰¹å®šå­—ä½“å®šä¹‰Fallbackåˆ—è¡¨/çº§è”åˆ—è¡¨&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;æ¯”å¦‚æˆ‘ä»¬è¿™é‡Œè¦æŸ¥è¯¢&lt;code class=&quot;highlighter-rouge&quot;&gt;.SFUI-Regular&lt;/code&gt;çš„Fallbackåˆ—è¡¨ï¼Œå°±ç”¨&lt;code class=&quot;highlighter-rouge&quot;&gt;.SFUI-Regular&lt;/code&gt;ä½œä¸ºkeyå»CTPresetFallbacks.plistä¸­æ‰¾åˆ°ä¸€ç»„å­—å…¸è¿›è¡Œè§£æï¼Œè§£æé€»è¾‘åé¢ä¼šè®²ã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;2ï¼‰SystemWideFallbacks&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;SystemWideFallbackså®šä¹‰äº†ä¸€ä¸ªå…¨å±€çº§åˆ«çš„ Fallback æ˜ å°„ï¼Œå’Œå­—ä½“æ— å…³ï¼ŒæŒ‰ Unicode code point èŒƒå›´å®šä¹‰ï¼›æ¯ä¸ªå…ƒç´ æ˜¯ä¸€ä¸ªä¸‰å…ƒç»„ï¼ŒåŒ…æ‹¬ï¼šèµ·å§‹ Unicode ç ç‚¹ + ç»“æŸ Unicode ç ç‚¹ + æŒ‡å®š Fallback å­—ä½“ã€‚&lt;/p&gt;

&lt;p&gt;æ¯”å¦‚128ï½887èŒƒå›´ä¼˜å…ˆç”¨Charter-Romanã€‚&lt;/p&gt;

&lt;h2 id=&quot;42-é¢„è®¾åˆ—è¡¨è§£ææµç¨‹&quot;&gt;4.2 é¢„è®¾åˆ—è¡¨è§£ææµç¨‹&lt;/h2&gt;

&lt;p&gt;è·å–åˆ°å…¨å±€é¢„è®¾åˆ—è¡¨ä¹‹åï¼Œæˆ‘ä»¬å†æ¥çœ‹ç³»ç»Ÿæ˜¯å¦‚ä½•é’ˆå¯¹ç‰¹å®šå­—ä½“ï¼ˆç³»ç»Ÿçš„UIå­—ä½“ï¼‰æ„å»ºçº§è”åˆ—è¡¨çš„ï¼Œä¸»è¦é€»è¾‘åœ¨&lt;code class=&quot;highlighter-rouge&quot;&gt;CreatePresetFallbacks&lt;/code&gt;ä¸­ï¼Œå¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-assembly&quot;&gt;/*
* å®ç°â€œå¿«é€Ÿé€šé“â€ï¼Œä»ä¸€ä¸ªå…¨å±€çš„ã€ç¡¬ç¼–ç çš„å­—å…¸ä¸­æŸ¥æ‰¾å¹¶åˆ›å»ºé¢„è®¾åˆ—è¡¨ã€‚
*
* @param a1@&amp;lt;X1&amp;gt; (CFStringRef) å­—ä½“åç§°æˆ–æ ‡è¯†ç¬¦ã€‚
* @param a2@&amp;lt;X2&amp;gt; (_QWORD*)     è¾“å‡ºå‚æ•°ï¼Œå¯èƒ½ç”¨äºå­—ç¬¦é›†ã€‚
* @param a3@&amp;lt;X3&amp;gt; (CFArrayRef)  è¯­è¨€åˆ—è¡¨ã€‚
* @param a4@&amp;lt;X4&amp;gt; (int)         æ ‡å¿—ä½ã€‚
* @param a5@&amp;lt;X8&amp;gt; (_QWORD*)     ç”¨äºæ¥æ”¶ç»“æœçš„è¾“å‡ºæŒ‡é’ˆã€‚
*
* @return __int64 è¿”å›åˆ›å»ºçš„é¢„è®¾åˆ—è¡¨ (CFArrayRef)ã€‚
*/
__int64 __usercall TDescriptorSource::CreatePresetFallbacks@&amp;lt;X0&amp;gt;(__int64 a1@&amp;lt;X1&amp;gt;, _QWORD *a2@&amp;lt;X2&amp;gt;, __int64 a3@&amp;lt;X3&amp;gt;, __int64 a4@&amp;lt;X4&amp;gt;, _QWORD *a5@&amp;lt;X8&amp;gt;)
{
  ...
  _X19 = a5;
  // 1. è·å–å…¨å±€é¢„è®¾å­—å…¸
  result = GetCTPresetFallbacksDictionary();
  v11 = result;
  // 2. åˆ›å»ºæœ‰åºçš„è¯­è¨€åˆ—è¡¨
  v12 = CreateOrderedLanguages(v6);
  // 3. ä½¿ç”¨å­—ä½“å a1 åœ¨é¢„è®¾å­—å…¸ä¸­æŸ¥æ‰¾
  v13 = CFDictionaryGetValue(v11, v8);
  // 4. å¦‚æœæ‰¾åˆ°åŒ¹é…é¡¹ï¼Œå¹¶ä¸”å®ƒæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œåˆ™å¼€å§‹å¤„ç†
  if ( v13 &amp;amp;&amp;amp; (v15 = v13, v16 = CFGetTypeID(v13), v16 == CFArrayGetTypeID()) )
  {
    // åˆ›å»ºä¸€ä¸ªå¯å˜æ•°ç»„ç”¨äºå­˜æ”¾ç»“æœ
    v37 = CFArrayCreateMutable(*(_QWORD *)kCFAllocatorDefault_ptr, 0LL, kCFTypeArrayCallBacks_ptr);
    v17 = CFArrayGetCount(v15);
    if ( v17 )
    {
      // 5. éå†é¢„è®¾æ•°ç»„ä¸­çš„æ¯ä¸€é¡¹
      do
      {
        v20 = (__CFString *)CFArrayGetValueAtIndex(v15, v19);
        v21 = CFGetTypeID(v20);
				// 5a. å¦‚æœæ˜¯å­—å…¸ç±»å‹ï¼Œè¯´æ˜æ˜¯æŒ‰è¯­è¨€åŒºåˆ†çš„åå¤‡å­—ä½“
        if ( v21 == CFDictionaryGetTypeID() )
        {
          // éå†ä¸Šé¢æ„å»ºçš„è¯­è¨€åˆ—è¡¨ï¼Œåœ¨å­—å…¸ä¸­æŸ¥æ‰¾åŒ¹é…çš„åå¤‡å­—ä½“
          do
          {
            v25 = CFArrayGetValueAtIndex(v12, v24);
            if ( v20 )
            {
              v26 = CFDictionaryGetValue(v20, v25);
              if ( v26 )
                TDescriptorSource::AppendFontDescriptorFromName(&amp;amp;v37, v26, 1024LL);
            }
          }
          while ( v23 != v24 );
        }
        // 5b. å¦‚æœæ˜¯å­—ç¬¦ä¸²ç±»å‹ï¼Œç›´æ¥ä½œä¸ºåå¤‡å­—ä½“å
        else
        {
          // ... å¯¹Emojiç­‰ç‰¹æ®Šå­—ä½“è¿›è¡Œå¤„ç† ...
          TDescriptorSource::AppendFontDescriptorFromName(&amp;amp;v37, v20, 1024LL);
        }
        ++v19;
      }
      while ( v19 != v18 );
    }
  }
  // å°†æœ€ç»ˆç»“æœå†™å…¥è¾“å‡ºæŒ‡é’ˆå¹¶è¿”å›
  ...
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ä»£ç æ³¨é‡Šå·²ç»æ¯”è¾ƒæ¸…æ™°ï¼Œæ€»ç»“ä¸‹æ¥è§£ææµç¨‹æ˜¯ï¼š&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;1ï¼‰é€šè¿‡å­—ä½“åä»å…¨å±€é¢„è®¾åˆ—è¡¨ä¸­æŸ¥è¯¢Fallbackæ•°ç»„&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;æ¯”å¦‚æˆ‘ä»¬é€šè¿‡&lt;code class=&quot;highlighter-rouge&quot;&gt;.SFUI-Regular&lt;/code&gt;æŸ¥è¯¢åˆ°çš„åŸå§‹Fallbackæ•°ç»„å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;div class=&quot;language-json highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;s2&quot;&gt;&quot;.SFUI-Regular&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;     &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;.AppleSystemFallback-Regular&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;.AppleColorEmojiUI&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;.SFGeorgian-Regular&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;HelveticaNeue&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;.AppleSymbolsFB&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;ar&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;.AppleArabicFont-Regular&quot;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;//&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;å¦‚æœç³»ç»Ÿè¯­è¨€æ˜¯é˜¿æ‹‰ä¼¯è¯­(ar)ï¼Œåˆ™ä½¿ç”¨æ­¤å­—ä½“&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;ur&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;.AppleUrduFont-Regular&quot;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;//&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;å¦‚æœæ˜¯ä¹Œå°”éƒ½è¯­(ur)ï¼Œåˆ™ä½¿ç”¨æ­¤å­—ä½“&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;ja&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;.AppleJapaneseFont-Regular&quot;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;//&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;å¦‚æœæ˜¯æ—¥è¯­(ja)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;ko&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;.AppleKoreanFont-Regular&quot;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;//&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;å¦‚æœæ˜¯éŸ©è¯­(ko)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;my&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;NotoSansMyanmar-Regular&quot;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;my-Qaag&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;NotoSansZawgyi-Regular&quot;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;zh-HK&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;.AppleHongKongChineseFont-Regular&quot;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;//&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;é¦™æ¸¯ç¹ä½“ä¸­æ–‡&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;zh-Hans&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;.AppleSimplifiedChineseFont-Regular&quot;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;//&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;ç®€ä½“ä¸­æ–‡&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;zh-Hant&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;.AppleTraditionalChineseFont-Regular&quot;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;//&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;å°æ¹¾ç¹ä½“ä¸­æ–‡&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;zh-MO&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;.AppleMacaoChineseFont-Regular&quot;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
	  	&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;2ï¼‰éå†Fallbackæ•°ç»„ï¼Œå¦‚æœæ˜¯å­—å…¸ç±»å‹ï¼Œéœ€è¦æŒ‰è¯­è¨€åŒºåˆ†Fallbackå­—ä½“&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;è¿˜è®°å¾—æœ€åˆ&lt;code class=&quot;highlighter-rouge&quot;&gt;CTFontCopyDefaultCascadeListForLanguages&lt;/code&gt;çš„å‡½æ•°ç­¾åä¸­ï¼Œç¬¬äºŒä¸ªå‚æ•°æ”¯æŒä¼ è¯­è¨€åˆ—è¡¨ï¼š&lt;/p&gt;

&lt;div class=&quot;language-swift highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;CTFontCopyDefaultCascadeListForLanguages&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;font&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;CTFont&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;languagePrefList&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;CFArray&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;?&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;CFArray&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;?&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ç³»ç»Ÿä¼šé€šè¿‡&lt;code class=&quot;highlighter-rouge&quot;&gt;CreateOrderedLanguages&lt;/code&gt;åˆ›å»ºä¸€ä¸ªæœ‰åºçš„è¯­è¨€æ•°ç»„ï¼Œå…·ä½“åšæ³•æ˜¯å°†è°ƒç”¨è€…æƒ³è¦çš„è¯­è¨€ï¼ˆlanguagePrefListï¼‰ã€Appè‡ªèº«æƒ³è¦çš„è¯­è¨€ã€ä»¥åŠç”¨æˆ·åœ¨æ•´ä¸ªç³»ç»Ÿä¸­è®¾ç½®çš„è¯­è¨€åå¥½åˆå¹¶æˆä¸€ä¸ªæœ‰åºçš„è¯­è¨€æ•°ç»„ã€‚&lt;/p&gt;

&lt;p&gt;ç„¶åéå†è¯­è¨€æ•°ç»„ï¼Œä»å­—å…¸ä¸­ç­›é€‰å‡ºå¯¹åº”è¯­è¨€çš„Fallbackå­—ä½“æ·»åŠ åˆ°ç»“æœä¸­ã€‚&lt;/p&gt;

&lt;p&gt;ä»è¿™é‡Œå¯ä»¥çœ‹å‡ºï¼Œ&lt;strong&gt;åŒä¸€å­—ä½“çš„Fallbackåˆ—è¡¨ï¼Œè¿˜ä¼šå—è¯­è¨€å½±å“&lt;/strong&gt;ï¼Œæ¯”å¦‚ï¼š&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;zh-Hans&lt;/th&gt;
      &lt;th&gt;zh-HK&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;img src=&quot;/img/post/FontFallback/zh-Hans.png&quot; alt=&quot;zh-Hans&quot; /&gt;&lt;/td&gt;
      &lt;td&gt;&lt;img src=&quot;/img/post/FontFallback/zh-HK.png&quot; alt=&quot;zh-HK&quot; /&gt;&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;blockquote&gt;
  &lt;p&gt;Qï¼šä¸ºä»€ä¹ˆFallbackå­—ä½“è¿˜è·Ÿè¯­è¨€è®¾ç½®ç›¸å…³?&lt;/p&gt;

  &lt;p&gt;å‚è€ƒ&lt;a href=&quot;https://mp.weixin.qq.com/s/fcL6if52qYQUTChEjntHJg&quot;&gt;è‡ªå®šä¹‰æ–‡å­—æ’ç‰ˆå¼•æ“çš„åŸç†&lt;/a&gt;ä¸€æ–‡ä¸­é’ˆå¯¹ã€Œç›¸åŒScriptçš„å­—ç¬¦å¦‚æœä½¿ç”¨äº†ä¸åŒçš„Fontï¼Œä¼šæœ‰ä»€ä¹ˆé—®é¢˜ã€çš„å›ç­”&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;strong&gt;3ï¼‰éå†Fallbackæ•°ç»„ï¼Œå¦‚æœæ˜¯å­—ç¬¦ä¸²ç±»å‹ï¼Œã€Œç›´æ¥ã€ä½œä¸ºFallbackå­—ä½“&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;ã€Œç›´æ¥ã€åŠ å¼•å·ï¼Œå› ä¸ºè¿˜ä¼šå¤„ç†Emojiå­—ä½“ç­‰ç‰¹æ®Šæƒ…å†µã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;4ï¼‰Fallbackæ•°ç»„éå†å®Œæˆä¹‹åï¼Œæ„å»ºå®Œæˆè¯¥å­—ä½“æœ€ç»ˆçš„é¢„è®¾Fallabckåˆ—è¡¨/çº§è”åˆ—è¡¨&lt;/strong&gt;&lt;/p&gt;

&lt;h2 id=&quot;42-preset-fallbackså°ç»“&quot;&gt;4.2 Preset Fallbackså°ç»“&lt;/h2&gt;

&lt;p&gt;æ€»ç»“ä¸‹Preset Fallbacksæµç¨‹ï¼š&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;1ï¼‰ç³»ç»Ÿä»å…¨å±€å¸¸é‡CTPresetFallbacksä¸­è¯»å–é¢„è®¾åˆ—è¡¨&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;2ï¼‰æ ¹æ®ç”¨æˆ·æŒ‡å®šä¸»å­—ä½“åä»å…¨å±€é¢„è®¾åˆ—è¡¨ä¸­æŸ¥è¯¢Fallbackæ•°ç»„&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;3ï¼‰éå†Fallbackæ•°ç»„ï¼Œå¦‚æœä¸ºå­—å…¸ç±»å‹ï¼Œæ ¹æ®ç”¨æˆ·æŒ‡å®šè¯­è¨€ã€Appåå¥½è¯­è¨€ã€ç³»ç»Ÿè®¾ç½®åå¥½è¯­è¨€æ¥é€‰æ‹©Fallbackå­—ä½“&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;4ï¼‰éå†Fallbackæ•°ç»„ï¼Œå¦‚æœä¸ºå­—ç¬¦ä¸²ç±»å‹ï¼Œã€Œç›´æ¥ã€ä½œä¸ºFallbackå­—ä½“&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;5ï¼‰Fallbackæ•°ç»„éå†å®Œåï¼Œå¯¹åº”å­—ä½“çš„çº§è”åˆ—è¡¨æ„å»ºå®Œæˆ&lt;/strong&gt;&lt;/p&gt;

&lt;h1 id=&quot;äº”system-default-fallbacks&quot;&gt;äº”ã€System Default Fallbacks&lt;/h1&gt;

&lt;p&gt;å¦‚æœç³»ç»Ÿé¢„è®¾Fallbackæ²¡æœ‰æŸ¥åˆ°ç»“æœï¼Œåˆ™ä¼šå…œåº•åˆ°ç³»ç»Ÿé»˜è®¤Fallbacké€»è¾‘ï¼Œä¸ºå­—ä½“åŠ¨æ€æ„å»ºçº§è”åˆ—è¡¨ã€‚&lt;/p&gt;

&lt;h2 id=&quot;51-cssfamilyåˆ†ç±»&quot;&gt;5.1 CSSFamilyåˆ†ç±»&lt;/h2&gt;

&lt;pre&gt;&lt;code class=&quot;language-assembly&quot;&gt;__int64 __usercall TBaseFont::CreateFallbacks@&amp;lt;X0&amp;gt;(__int64 result@&amp;lt;X0&amp;gt;, __int64 a2@&amp;lt;X1&amp;gt;, __int64 a3@&amp;lt;X2&amp;gt;, __int64 a4@&amp;lt;X3&amp;gt;, __int64 a5@&amp;lt;X4&amp;gt;, _QWORD *a6@&amp;lt;X8&amp;gt;)
{
  ...
  // å¦‚æœé¢„è®¾å­—ä½“å›é€€ä¸ºç©ºï¼Œåˆ›å»ºç³»ç»Ÿé»˜è®¤å­—ä½“å›é€€
  v27 = TBaseFont::GetCSSFamily(v9);
  _X23 = &amp;amp;v34;

  // åˆ›å»ºç³»ç»Ÿé»˜è®¤å­—ä½“å›é€€åˆ—è¡¨
  _X0 = TBaseFont::CreateSystemDefaultFallbacks((__int64)v9, v27, v7, v8, &amp;amp;v34);
  ...
  return result;
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ç³»ç»Ÿé»˜è®¤Fallbackï¼Œä¼šå…ˆé€šè¿‡&lt;code class=&quot;highlighter-rouge&quot;&gt;TBaseFont::GetCSSFamily&lt;/code&gt;å°†ç”¨æˆ·æŒ‡å®šä¸»å­—ä½“åˆ†ç±»ï¼Œè¿™æ˜¯åç»­æŸ¥è¡¨çš„å…³é”®ï¼›GetCSSFamilyä¼šè¯»å–å­—ä½“ç‰¹å¾è¿›è¡Œåˆ†ç±»ï¼Œä¸»è¦åˆ†ä¸ºï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;sans-serif&lt;/code&gt; (æ— è¡¬çº¿ä½“)&lt;/strong&gt;ï¼šå­—ä½“ç¬”ç”»çš„æœ«ç«¯æ²¡æœ‰é¢å¤–çš„è£…é¥°æ€§â€œè„šâ€ï¼Œå¦‚Helveticaã€Arialã€San Francisco (SF Pro)ã€PingFang SC (è‹¹æ–¹)&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;serif&lt;/code&gt; (è¡¬çº¿ä½“)&lt;/strong&gt;ï¼šå­—ä½“ç¬”ç”»çš„æœ«ç«¯æœ‰è£…é¥°æ€§çš„â€œè„šâ€ï¼ˆè¡¬çº¿ï¼‰ï¼Œå¦‚Times New Romanã€Georgiaã€New Yorkã€å®‹ä½“&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;monospace&lt;/code&gt; (ç­‰å®½ä½“)&lt;/strong&gt;ï¼šæ‰€æœ‰å­—ç¬¦å æ®ç›¸åŒçš„å®½åº¦ï¼Œå¦‚Menloã€Courierã€Monacoã€SF Mono&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;cursive&lt;/code&gt; (æ‰‹å†™ä½“)&lt;/strong&gt;ï¼šå¦‚Snell Roundhand&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;fantasy&lt;/code&gt; (è£…é¥°ä½“)&lt;/strong&gt;ï¼šå¦‚Papyrus&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;é™¤æ­¤å¤–ï¼Œè‹¹æœåœ¨UIä¸Šä¸‹æ–‡ä¸­ï¼Œè¿˜æœ‰å‡ ä¸ªæ‰©å±•çš„CSSFamilyåˆ†ç±»ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;ui-serif&lt;/code&gt;&lt;/strong&gt;ï¼šç”¨äº UI çš„è¡¬çº¿å­—ä½“ï¼Œä¸»è¦æŒ‡ &lt;code class=&quot;highlighter-rouge&quot;&gt;New York&lt;/code&gt; å®¶æ—&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;ui-sans-serif&lt;/code&gt;&lt;/strong&gt;ï¼šç”¨äº UI çš„æ— è¡¬çº¿å­—ä½“ï¼Œå³ &lt;code class=&quot;highlighter-rouge&quot;&gt;San Francisco&lt;/code&gt; å®¶æ—&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;ui-monospace&lt;/code&gt;&lt;/strong&gt;ï¼šç”¨äº UI çš„ç­‰å®½å­—ä½“ï¼Œå³ &lt;code class=&quot;highlighter-rouge&quot;&gt;SF Mono&lt;/code&gt;ã€‚&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;ui-rounded&lt;/code&gt;&lt;/strong&gt;ï¼šç”¨äº UI çš„åœ†ä½“å­—ä½“ã€‚å¦‚ &lt;code class=&quot;highlighter-rouge&quot;&gt;SF Pro Rounded&lt;/code&gt; å’Œ &lt;code class=&quot;highlighter-rouge&quot;&gt;SF Compact Rounded&lt;/code&gt;&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;52-è·å–ç³»ç»Ÿé»˜è®¤fallbackåˆ—è¡¨kdefaultfontfallbacks&quot;&gt;5.2 è·å–ç³»ç»Ÿé»˜è®¤Fallbackåˆ—è¡¨kDefaultFontFallbacks&lt;/h2&gt;

&lt;p&gt;å’Œå…¨å±€é¢„è®¾åˆ—è¡¨ä¸€æ ·ï¼Œç³»ç»Ÿé»˜è®¤Fallbackåˆ—è¡¨ä¹Ÿæ˜¯é€šè¿‡&lt;code class=&quot;highlighter-rouge&quot;&gt;GSFontCacheGetData&lt;/code&gt;è¯»å–é…ç½®æ–‡ä»¶ã€‚&lt;/p&gt;

&lt;p&gt;è°ƒç”¨é“¾è·¯æ˜¯ï¼š&lt;code class=&quot;highlighter-rouge&quot;&gt;CreateSystemDefaultFallbacks -&amp;gt; CopyDefaultSubstitutionListForLanguages -&amp;gt; CopyFontFallbacksForLanguages -&amp;gt; CopyFontFallbacks -&amp;gt; CopyDefaultFontFallbacks -&amp;gt; GSFontCacheGetData&lt;/code&gt;ï¼›é€šè¿‡GSFontCacheGetDataè¯»å–ç³»ç»Ÿé»˜è®¤Fallbackåˆ—è¡¨æ—¶ï¼Œå…¥å‚æ˜¯&lt;code class=&quot;highlighter-rouge&quot;&gt;DefaultFontFallbacks.plist&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/post/FontFallback/DefaultFontFallbacks.plist.png&quot; alt=&quot;DefaultFontFallbacks.plist&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ä¹Ÿæ˜¯ä»ä¸€ä¸ªå…¨å±€å¸¸é‡&lt;code class=&quot;highlighter-rouge&quot;&gt;kDefaultFontFallbacks&lt;/code&gt;ä¸­è·å–çš„ï¼Œå†…å®¹å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;div class=&quot;language-json highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;common&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;     &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;cursive&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;     &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;default&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;     &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;fantasy&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;     &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;monospace&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;     &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;sans-serif&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;     &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;Helvetica&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;AppleColorEmoji&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;.AppleSymbolsFB&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;ar&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;GeezaPro;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;ja&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;HiraginoSans-W3&quot;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;ko&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;AppleSDGothicNeo-Regular&quot;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;my&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;NotoSansMyanmar-Regular&quot;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;my-Qaag&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;NotoSansZawgyi-Regular&quot;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;ur&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;NotoNastaliqUrdu;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;zh-HK&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;PingFangHK-Regular&quot;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;zh-Hans&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;PingFangSC-Regular&quot;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;zh-Hant&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;PingFangTC-Regular&quot;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;zh-MO&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;PingFangMO-Regular&quot;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;Thonburi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;ArialHebrew&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;serif&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;     &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;ui-monospace&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;     &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;ui-rounded&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;     &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;ui-serif&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;     &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;DefaultFontFallbacks.plist&lt;/code&gt;çš„æ ¼å¼åŸºæœ¬å’Œ&lt;code class=&quot;highlighter-rouge&quot;&gt;CTPresetFallbacks.plist&lt;/code&gt;ç±»ä¼¼ï¼Œä¹Ÿæ˜¯KVç»“æ„ï¼ŒValueéƒ¨åˆ†ä¹Ÿåˆ†ä¸ºå­—ç¬¦ä¸²å’Œå­—å…¸ç±»å‹ï¼Œå­—å…¸ç±»å‹ä¹Ÿä¼šæ ¹æ®ç”¨æˆ·æŒ‡å®šè¯­è¨€æ¥æ‹©ä¼˜é€‰å–ã€‚&lt;/p&gt;

&lt;h2 id=&quot;53-è§£æå¹¶ç¼“å­˜ç³»ç»Ÿé»˜è®¤fallbackåˆ—è¡¨&quot;&gt;5.3 è§£æå¹¶ç¼“å­˜ç³»ç»Ÿé»˜è®¤Fallbackåˆ—è¡¨&lt;/h2&gt;

&lt;p&gt;è§£æå’Œç¼“å­˜é€»è¾‘ä¸»è¦ç”±&lt;code class=&quot;highlighter-rouge&quot;&gt;CopyFontFallbacks&lt;/code&gt;å¤„ç†ï¼Œä¸»é€»è¾‘å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-assembly&quot;&gt;/**
 * CoreText å­—ä½“å›é€€ - å¤åˆ¶å­—ä½“å›é€€åˆ—è¡¨å‡½æ•°
 * åŠŸèƒ½: æ ¹æ®å­—ä½“æè¿°ç¬¦å’Œè¯­è¨€ä¿¡æ¯å¤åˆ¶ç›¸åº”çš„å­—ä½“å›é€€åˆ—è¡¨
 * 
 * å‚æ•°:
 *   a1 (_QWORD *): è¾“å‡ºå‚æ•°æŒ‡é’ˆï¼Œç”¨äºæ¥æ”¶ç”Ÿæˆçš„å­—ä½“å›é€€æ•°ç»„
 *   a2 (__int64): å­—ä½“æè¿°ç¬¦å¯¹è±¡æŒ‡é’ˆ
 *   a3 (__CFString *): ä¸»è¦è¯­è¨€ä»£ç å­—ç¬¦ä¸²
 *   a4 (__CFString *): æ¬¡è¦è¯­è¨€ä»£ç å­—ç¬¦ä¸²ï¼ˆå¯é€‰ï¼‰
 *   a5 (__int64): è¯­è¨€æ•°ç»„æŒ‡é’ˆï¼ˆå¯é€‰ï¼‰
 * 
 * è¿”å›å€¼:
 *   __int64: æ“ä½œç»“æœ
 */
__int64 __fastcall TFontFallbacks::CopyFontFallbacks(_QWORD *a1, __int64 a2, __CFString *a3, __CFString *a4, __int64 a5)
{
	...
  // ä¿å­˜å‚æ•°åˆ°å±€éƒ¨å˜é‡å’Œå¯„å­˜å™¨
  _X22 = a5;  // è¯­è¨€æ•°ç»„æŒ‡é’ˆ
  v6 = a4;    // æ¬¡è¦è¯­è¨€ä»£ç 
  v7 = a3;    // ä¸»è¦è¯­è¨€ä»£ç 
  v8 = a2;    // å­—ä½“æè¿°ç¬¦å¯¹è±¡
  v9 = a1;    // è¾“å‡ºå‚æ•°æŒ‡é’ˆ
  // å…ˆåœ¨Fontå®ä¾‹æˆå‘˜å˜é‡å­—å…¸ä¸­æŸ¥æ‰¾Fallbackç¼“å­˜
  v16 = CFDictionaryGetValue(_X0, a3);
  ...
  // å¦‚æœæ²¡æœ‰æ‰¾åˆ°ç¼“å­˜ï¼Œåˆ™åŠ¨æ€æ„å»º
  if ( !_X9 )
  {
  	...
    // è·å–ç³»ç»Ÿé»˜è®¤Fallbackåˆ—è¡¨
    CopyDefaultFontFallbacks();
    v22 = objc_retain(_X0);
    if ( v22 )
    {
      // ç”¨cssfamliyä»ç³»ç»Ÿé»˜è®¤Fallbackåˆ—è¡¨ä¸­æŸ¥æ‰¾æ˜ å°„
      v24 = CFDictionaryGetValue(v22, v6);      
      // æ£€æŸ¥æ˜¯å¦æ‰¾åˆ°äº†æœ‰æ•ˆçš„å­—ä½“åˆ—è¡¨
      if ( v24 &amp;amp;&amp;amp; CFArrayGetCount(v24) &amp;gt;= 1 )
      {
      	...
      	// è§£æåˆ—è¡¨
        // æ ¹æ®ç”¨æˆ·æŒ‡å®šè¯­è¨€ã€Appåå¥½è¯­è¨€ã€ç³»ç»Ÿè®¾ç½®åå¥½è¯­è¨€åˆ›å»ºæœ‰åºè¯­è¨€æ•°ç»„
        v29 = CreateOrderedLanguages(_X22);
        // å¤„ç†å­—ä½“å›é€€åˆ—è¡¨
        TDescriptorSource::ProcessFallbackList(v24, (__int64)&amp;amp;v59, v31, v29);

        // è§£æé€šç”¨ï¼ˆcommonï¼‰å­—ä½“å›é€€åˆ—è¡¨
        v34 = CFDictionaryGetValue(_X25, &amp;amp;stru_1F69C8);
        TDescriptorSource::ProcessFallbackList(v36, (__int64)&amp;amp;v59, v31, v29);

				// ç¼“å­˜ç»“æœåˆ°Fontå®ä¾‹
        v44 = objc_retain(_X0);
        if ( v44 )
        {
        	...
        	CFDictionarySetValue(_X0, v7, _X2);
        }
      }
    }
  // å¤„ç†ç‰¹å®šè¯­è¨€çš„å›é€€é€»è¾‘
  ...
  return objc_release(v57);
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æ³¨æ„CopyFontFallbacksä¸­ä¸€å…±è°ƒäº†ä¸¤æ¬¡ProcessFallbackListï¼Œé€»è¾‘æ˜¯å…ˆå–å¯¹åº”CSSFamilyçš„ï¼ˆæ¯”å¦‚sans-serifï¼‰Fallbackåˆ—è¡¨ï¼Œå†å–commonçš„Fallbackåˆ—è¡¨ï¼Œæœ€ç»ˆå°†äºŒè€…åˆå¹¶èµ·æ¥ä½œä¸ºå¯¹åº”å­—ä½“çš„Fallbackç»“æœã€‚&lt;/p&gt;

&lt;p&gt;ProcessFallbackListè§£æå­—ä½“åˆ—è¡¨çš„é€»è¾‘å’Œé¢„è®¾Fallbackç±»ä¼¼ï¼Œä¹Ÿæ˜¯æ ¹æ®Valueæ˜¯å­—ç¬¦ä¸²ç±»å‹è¿˜æ˜¯å­—å…¸ç±»å‹æ¥åŒºåˆ†è§£æï¼Œæ­¤å¤„ä¸å†èµ˜è¿°ã€‚&lt;/p&gt;

&lt;p&gt;æœ€åï¼ŒCopyFontFallbacksè¿˜ä¼šå°†Fallbackç»“æœç¼“å­˜åˆ°Fontå®ä¾‹çš„å­—å…¸å˜é‡ä¸­ï¼Œkeyæ˜¯&lt;code class=&quot;highlighter-rouge&quot;&gt;cssfamily + languages&lt;/code&gt;ï¼ˆé€—å·åˆ†éš”å¼€ï¼‰ï¼Œæ¯”å¦‚ï¼š&lt;code class=&quot;highlighter-rouge&quot;&gt;sans-serif,zh-HK&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/post/FontFallback/CopyFontFallbacks.png&quot; alt=&quot;CopyFontFallbacks&quot; /&gt;&lt;/p&gt;

&lt;p&gt;CopyFontFallbacksé€»è¾‘æ¯”è¾ƒæ¸…æ™°ï¼Œæ€»ç»“ä¸‹æ¥æ˜¯ï¼š&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;1ï¼‰å…ˆä»Fontå®ä¾‹ä¸­è·å–Fallbackç¼“å­˜ï¼Œå¦‚æœå·²ç»æ„å»ºè¿‡åˆ™ç›´æ¥ä½¿ç”¨&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;2ï¼‰ç¼“å­˜è·å–å¤±è´¥ï¼Œèµ°åŠ¨æ€æ„å»ºï¼Œå°†å¯¹åº”CSSFamilyçš„Fallbackåˆ—è¡¨å’Œcommonçš„Fallbackåˆ—è¡¨åˆå¹¶æˆæœ€ç»ˆFallbackç»“æœ&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;3ï¼‰ç¼“å­˜Fallbackç»“æœåˆ°Fontå®ä¾‹ï¼Œkeyæ˜¯&lt;code class=&quot;highlighter-rouge&quot;&gt;cssfamily + languages&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;

&lt;h2 id=&quot;54-è¯­è¨€å¤„ç†ä¸çº¿ç¨‹å®‰å…¨&quot;&gt;5.4 è¯­è¨€å¤„ç†ä¸çº¿ç¨‹å®‰å…¨&lt;/h2&gt;

&lt;p&gt;CopyFontFallbacksForLanguagesåœ¨è°ƒç”¨CopyFontFallbacksä¹‹å‰ï¼Œä¼šå¯¹ç”¨æˆ·æŒ‡å®šçš„è¯­è¨€ï¼ˆå³&lt;code class=&quot;highlighter-rouge&quot;&gt;CTFontCopyDefaultCascadeListForLanguages&lt;/code&gt;çš„&lt;code class=&quot;highlighter-rouge&quot;&gt;languagePrefList&lt;/code&gt;å‚æ•°ï¼‰è¿›è¡Œå¤„ç†ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-assembly&quot;&gt;__int64 __usercall TFontFallbacks::CopyFontFallbacksForLanguages@&amp;lt;X0&amp;gt;(__int64 a1@&amp;lt;X0&amp;gt;, __int64 a2@&amp;lt;X1&amp;gt;, __int64 a3@&amp;lt;X2&amp;gt;, __int64 a4@&amp;lt;X8&amp;gt;)
{
  // å¦‚æœæ²¡æœ‰æä¾›è¯­è¨€æ•°ç»„ï¼Œç›´æ¥è°ƒç”¨å•è¯­è¨€ç‰ˆæœ¬
  if ( !a3 )
    return TFontFallbacks::CopyFontFallbacks((_QWORD *)a4, a1, (__CFString *)a2, 0LL, 0LL);
	...
  // è·å–ç³»ç»Ÿæœ‰åºè¯­è¨€æ•°ç»„
  v7 = GetOrderedLanguages;
  // éå†è¾“å…¥çš„è¯­è¨€ä»£ç æ•°ç»„
  do
  {
    // æ£€æŸ¥è§„èŒƒåŒ–åçš„è¯­è¨€ä»£ç æ˜¯å¦åœ¨ç³»ç»Ÿæ”¯æŒçš„è¯­è¨€åˆ—è¡¨ä¸­
    __asm { LDAPR           X3, [X22], [X22] }
    if ( (unsigned int)CFArrayContainsValue(v7, 0LL, v8, _X3) )
    {
      // å¦‚æœæ”¯æŒï¼Œæ·»åŠ åˆ°æœ‰æ•ˆè¯­è¨€æ•°ç»„ä¸­
      CFArrayAppendValue(v6, v21);

    }
    ++v12;
  }
  while ( v11 != v12 );
  ...
  // å¦‚æœæ‰¾åˆ°äº†æœ‰æ•ˆçš„è¯­è¨€ä»£ç 
  if ( CFArrayGetCount(v6) )
  {
      TFontFallbacks::CopyFontFallbacks(v24, v25, _X2, v4, v6);
  }
  else
  {
    // å¦‚æœæ²¡æœ‰æ‰¾åˆ°æœ‰æ•ˆè¯­è¨€ï¼Œä½¿ç”¨å•è¯­è¨€ç‰ˆæœ¬
    TFontFallbacks::CopyFontFallbacks(v24, v25, v4, 0LL, 0LL);
  }
  ...
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å¤§è‡´é€»è¾‘æ˜¯ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;å¦‚æœ&lt;code class=&quot;highlighter-rouge&quot;&gt;languagePrefList&lt;/code&gt;ä¼ nilï¼ˆæ³¨æ„ç©ºæ•°ç»„ä¸ç®—nilï¼‰ï¼Œåˆ™ç›´æ¥ç”¨cssfamilyæŸ¥è¯¢CopyFontFallbacks&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;å¦‚æœ&lt;code class=&quot;highlighter-rouge&quot;&gt;languagePrefList&lt;/code&gt;ä¸ä¸ºnilï¼Œä¼šå°†ç”¨æˆ·æŒ‡å®šçš„languagesé€šè¿‡GetOrderedLanguagesè¿‡æ»¤ä¸€éï¼Œå»é™¤ç³»ç»Ÿä¸æ”¯æŒçš„languageï¼Œç„¶åä½¿ç”¨cssfamily + languagesæŸ¥è¯¢CopyFontFallbacks&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;å¦å¤–ï¼Œ&lt;code class=&quot;highlighter-rouge&quot;&gt;CopyFontFallbacks&lt;/code&gt;ä¼šæœ‰å¯¹å­—å…¸çš„è¯»å†™æ“ä½œï¼Œä¸ºäº†çº¿ç¨‹å®‰å…¨ï¼ŒCopyDefaultSubstitutionListForLanguagesä¼šå¯¹æ•´ä¸ªæµç¨‹åŠ ä¸€æŠŠå¤§é”ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-assembly&quot;&gt;__int64 __usercall TDescriptorSource::CopyDefaultSubstitutionListForLanguages@&amp;lt;X0&amp;gt;(__int64 a1@&amp;lt;X0&amp;gt;, __int64 a2@&amp;lt;X1&amp;gt;, __int64 a3@&amp;lt;X8&amp;gt;)
{
  TDescriptorSource *v6; // é”å¯¹è±¡æŒ‡é’ˆ
  // è¿™ä¸ªé”ç¡®ä¿å­—ä½“å›é€€ç¼“å­˜çš„çº¿ç¨‹å®‰å…¨è®¿é—®
  v6 = (TDescriptorSource *)os_unfair_lock_lock_with_options(&amp;amp;TDescriptorSource::sFontFallbacksLock, 327680LL);
  ...
  TFontFallbacks::CopyFontFallbacksForLanguages(TDescriptorSource::sFontFallbacksCache, v4, v3, v5);
  // é‡Šæ”¾å­—ä½“å›é€€ç¼“å­˜é”å¹¶è¿”å›
  return os_unfair_lock_unlock(&amp;amp;TDescriptorSource::sFontFallbacksLock);
}
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&quot;55-ç»“æœå¤„ç†ä¸è¿”å›&quot;&gt;5.5 ç»“æœå¤„ç†ä¸è¿”å›&lt;/h2&gt;

&lt;p&gt;æœ€å&lt;code class=&quot;highlighter-rouge&quot;&gt;CreateSystemDefaultFallbacks&lt;/code&gt;ä¼šå¯¹&lt;code class=&quot;highlighter-rouge&quot;&gt;CopyDefaultSubstitutionListForLanguages&lt;/code&gt;ä¸­è·å–åˆ°çš„å­—ä½“æè¿°ç¬¦è¿›è¡Œå¤„ç†ï¼Œå³æ’é™¤ç”¨æˆ·æŒ‡å®šå­—ä½“ï¼Œé˜²æ­¢è‡ªå·±Fallbackè‡ªå·±ã€‚&lt;/p&gt;

&lt;h1 id=&quot;å…­æ€»ç»“&quot;&gt;å…­ã€æ€»ç»“&lt;/h1&gt;

&lt;p&gt;è‡³æ­¤ï¼Œæˆ‘ä»¬é€šè¿‡é€†å‘çš„æ‰‹æ®µæ¢³ç†å®Œäº†&lt;code class=&quot;highlighter-rouge&quot;&gt;CTFontCopyDefaultCascadeListForLanguages&lt;/code&gt;çš„å®Œæ•´æµç¨‹ï¼Œæœ€åæ•´ç†ä¸‹ç»“è®ºå¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;p&gt;æ•´ä½“åˆ†ä¸ºä¸¤ä¸ªå¤§æµç¨‹ï¼š&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;1ã€Preset Fallbacksï¼šé¢„è®¾Fallback&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;1.1 ç³»ç»Ÿä»å…¨å±€å¸¸é‡CTPresetFallbacksä¸­è¯»å–é¢„è®¾åˆ—è¡¨&lt;/p&gt;

&lt;p&gt;1.2 æ ¹æ®ç”¨æˆ·æŒ‡å®šä¸»å­—ä½“åä»å…¨å±€é¢„è®¾åˆ—è¡¨ä¸­æŸ¥è¯¢Fallbackæ•°ç»„&lt;/p&gt;

&lt;p&gt;1.3 éå†Fallbackæ•°ç»„ï¼Œå¦‚æœä¸ºå­—å…¸ç±»å‹ï¼Œæ ¹æ®ç”¨æˆ·æŒ‡å®šè¯­è¨€ã€Appåå¥½è¯­è¨€ã€ç³»ç»Ÿè®¾ç½®åå¥½è¯­è¨€æ¥é€‰æ‹©Fallbackå­—ä½“&lt;/p&gt;

&lt;p&gt;1.4 éå†Fallbackæ•°ç»„ï¼Œå¦‚æœä¸ºå­—ç¬¦ä¸²ç±»å‹ï¼Œã€Œç›´æ¥ã€ä½œä¸ºFallbackå­—ä½“&lt;/p&gt;

&lt;p&gt;1.5 Fallbackæ•°ç»„éå†å®Œåï¼Œå¯¹åº”å­—ä½“çš„çº§è”åˆ—è¡¨æ„å»ºå®Œæˆ&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;2ã€System Default Fallbacksï¼šç³»ç»Ÿé»˜è®¤Fallback&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;1.1 è·å–ä¸»å­—ä½“çš„CSSFamilyåˆ†ç±»&lt;/p&gt;

&lt;p&gt;1.2 ä»å…¨å±€å¸¸é‡kDefaultFontFallbacksä¸­è¯»å–é»˜è®¤Fallbackåˆ—è¡¨&lt;/p&gt;

&lt;p&gt;1.3 ç”¨&lt;code class=&quot;highlighter-rouge&quot;&gt;cssfamily + languages&lt;/code&gt;ä»å­—ä½“å®ä¾‹ä¸­è·å–Fallbackç¼“å­˜ï¼Œå¦‚æœå·²ç»æ„å»ºåˆ™ç›´æ¥ä½¿ç”¨&lt;/p&gt;

&lt;p&gt;1.4 ç¼“å­˜ç¼ºå¤±åˆ™åŠ¨æ€æ„å»ºï¼Œæ ¹æ®CSSFamilyè·å–å¯¹åº”å­—ä½“çš„Fallbackåˆ—è¡¨å¹¶è§£æï¼Œè·å–commonç±»å‹çš„Fallbackåˆ—è¡¨å¹¶è§£æï¼Œåˆå¹¶äºŒè€…ç»“æœä½œä¸ºæœ€ç»ˆFallbackç»“æœ&lt;/p&gt;

&lt;p&gt;1.5 ç”¨&lt;code class=&quot;highlighter-rouge&quot;&gt;cssfamily + languages&lt;/code&gt;å°†Fallbackç»“æœç¼“å­˜åˆ°Fontå®ä¾‹&lt;/p&gt;

&lt;p&gt;1.6 å¤„ç†å¹¶è¿”å›Fallbackç»“æœ&lt;/p&gt;
</description>
        <pubDate>Fri, 03 Oct 2025 00:00:00 +0800</pubDate>
        <link>http://localhost:4000/2025/10/03/CoreText-Font-Fallback/</link>
        <guid isPermaLink="true">http://localhost:4000/2025/10/03/CoreText-Font-Fallback/</guid>
        
        <category>è·¨ç«¯æ¸²æŸ“</category>
        
        <category>Font</category>
        
        
      </item>
    
      <item>
        <title>ä»0åˆ°1è‡ªå®šä¹‰æ–‡å­—æ’ç‰ˆå¼•æ“ï¼šåŸç†ç¯‡</title>
        <description>&lt;h1 id=&quot;å¼•è¨€&quot;&gt;å¼•è¨€&lt;/h1&gt;

&lt;blockquote&gt;
  &lt;p&gt;å‰é¢æˆ‘ä»¬è®²è§£äº†&lt;a href=&quot;https://mp.weixin.qq.com/s/EYPO3sSjtIstD3RmlRCs9w&quot;&gt;å­—ç¬¦ä¸ç¼–ç &lt;/a&gt;ï¼ŒçŸ¥é“äº†Characterä¸Unicodeçš„å…³ç³»å’ŒåŒºåˆ«ï¼Œä¹Ÿä»‹ç»äº†&lt;a href=&quot;https://mp.weixin.qq.com/s/96YJGYKLoxENC4qT9tYNoQ&quot;&gt;å­—ç¬¦ï¼ˆCharacterï¼‰ã€å­—å½¢ï¼ˆGlyphï¼‰ã€å­—ä½“çš„åŒºåˆ«&lt;/a&gt;ï¼Œå¹¶é€šè¿‡å®é™…è§£æä¸€ä¸ªFontæ–‡ä»¶ï¼ŒçœŸæ­£äº†è§£åˆ°äº†&lt;a href=&quot;https://mp.weixin.qq.com/s/D0A8HAQaQNart7KAdWXyJg&quot;&gt;Fontæ–‡ä»¶ä¸­æœ‰ä»€ä¹ˆ&lt;/a&gt;ï¼›å¦‚æœä½ å¯¹è¿™äº›æ¦‚å¿µè¿˜ç†Ÿæ‚‰ï¼Œæ¨èå…ˆé˜…è¯»å‰é¢å‡ ç¯‡æ–‡ç« æ‰“å¥½åŸºç¡€ã€‚&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;ä½œä¸ºç¨‹åºå‘˜ï¼Œæ—¥å¸¸å’Œæ–‡æœ¬æ‰“äº¤é“è‚¯å®šæœ€å¤šï¼Œä¸çŸ¥é“ä½ æ˜¯å¦æ·±å…¥æƒ³è¿‡è¿™æ ·ä¸€ä¸ªé—®é¢˜ï¼š&lt;/p&gt;

&lt;p&gt;ä¸€æ®µä¸­è‹±æ—¥ç­‰å¤šå›½æ··æ’çš„æ–‡å­—ï¼Œç³»ç»Ÿï¼ˆæ’ç‰ˆå¼•æ“ï¼‰æ˜¯å¦‚ä½•çŸ¥é“æ€ä¹ˆæ’å¸ƒæ¯ä¸ªæ–‡å­—çš„ï¼Œç‰¹åˆ«æ˜¯ä¸åŒå›½å®¶çš„è¯­è¨€æ’ç‰ˆè§„åˆ™ä¸åŒï¼Œæ¯”å¦‚ä¸­æ–‡ã€è‹±æ–‡æ˜¯ä»å·¦å‘å³æ’åˆ—ï¼Œé˜¿æ‹‰ä¼¯æ–‡æ˜¯ä»å³å‘å·¦æ’åˆ—çš„ï¼›é˜¿æ‹‰ä¼¯æ–‡ä¼šæœ‰è¿å­—ï¼ˆligatureï¼‰ï¼Œä¸­æ–‡æ²¡æœ‰è¿å­—ï¼›æ›´ç»†èŠ‚çš„ï¼Œä¸ºäº†å¢å¼ºæ–‡æœ¬çš„å¯è¯»æ€§å’Œç¾è§‚æ€§ï¼Œç³»ç»Ÿä¸€èˆ¬è¿˜ä¼šå°†æ–‡å­—ç´§å‡‘å¤„ç†ï¼ˆkerningï¼‰ã€è¿å­—å¤„ç†ï¼ˆligatureï¼‰ç­‰ï¼Œæ’ç‰ˆå¼•æ“åœ¨å…¶ä¸­åˆ°åº•åšäº†å“ªäº›äº‹æƒ…ï¼Œæ¯ä¸€æ­¥çš„åŸºæœ¬åŸç†åˆæ˜¯æ€ä¹ˆæ ·çš„ï¼Œæœ¬æ–‡å°†å¸¦ä½ é€æ­¥æ­å¼€æ’ç‰ˆå¼•æ“çš„ç¥ç§˜é¢çº±ã€‚&lt;/p&gt;

&lt;p&gt;é€šè¿‡æœ¬æ–‡ï¼Œæˆ–è®¸ä½ ä¹Ÿèƒ½è‡ªå®šä¹‰ä¸€ä¸ªæ–‡å­—æ’ç‰ˆå¼•æ“äº†ã€‚&lt;/p&gt;

&lt;h1 id=&quot;ä¸€æ–‡æœ¬é¢„å¤„ç†unicodeå½’ä¸€åŒ–&quot;&gt;ä¸€ã€æ–‡æœ¬é¢„å¤„ç†/Unicodeå½’ä¸€åŒ–&lt;/h1&gt;

&lt;p&gt;åœ¨&lt;a href=&quot;https://mp.weixin.qq.com/s/EYPO3sSjtIstD3RmlRCs9w&quot;&gt;å­—ç¬¦ä¸ç¼–ç &lt;/a&gt;ä¸€æ–‡ä¸­ï¼Œæˆ‘ä»¬çŸ¥é“åŒä¸€ä¸ªå­—ç¬¦å¯èƒ½å¯¹åº”å¤šä¸ªcode pointï¼Œæ¯”å¦‚&lt;code class=&quot;highlighter-rouge&quot;&gt;ğŸ‘¨â€ğŸ‘©â€ğŸ‘§&lt;/code&gt;å¯¹åº”&lt;code class=&quot;highlighter-rouge&quot;&gt;U+1F468 + U+200D + U+1F469 + U+200D + U+1F467&lt;/code&gt; ï¼›ç”šè‡³Unicodeä¸ºäº†å…¼å®¹å†å²ç¼–ç ï¼Œä¹Ÿå…è®¸ä¸€ä¸ªå­—ç¬¦æœ‰å¤šç§è¡¨ç¤ºæ–¹æ³•ï¼Œæ¯”å¦‚&lt;code class=&quot;highlighter-rouge&quot;&gt;Ã©&lt;/code&gt;å¯ä»¥è¡¨ç¤ºä¸ºï¼šå•ä¸€code pointï¼ˆU+00E9ï¼‰ï¼Œç»„åˆcode pointï¼ˆ&lt;code class=&quot;highlighter-rouge&quot;&gt;U+0065 + U+0301&lt;/code&gt;ï¼‰ã€‚&lt;/p&gt;

&lt;p&gt;é¢„å¤„ç†å°±æ˜¯ä¿è¯å­—ç¬¦ä¸²åœ¨è¿›è¡Œæ’ç‰ˆ/å­—å½¢é€‰æ‹©ï¼ˆshapingï¼‰ä¹‹å‰æ˜¯ç¨³å®šã€å”¯ä¸€ã€å¯é¢„æµ‹çš„ï¼Œé¿å…å› ä¸º Unicode çš„å¤šç§è¡¨ç¤ºæ–¹æ³•å¯¼è‡´æ’ç‰ˆä¸ä¸€è‡´ï¼Œæ¯”å¦‚é¿å…&lt;code class=&quot;highlighter-rouge&quot;&gt;Ã©&lt;/code&gt;è¢«åˆ†å¼€æˆ&lt;code class=&quot;highlighter-rouge&quot;&gt;e&lt;/code&gt;å’Œ &lt;code class=&quot;highlighter-rouge&quot;&gt;Ì&lt;/code&gt;æ’ç‰ˆæ¸²æŸ“ã€‚&lt;/p&gt;

&lt;p&gt;é¢„å¤„ç†ä¸€èˆ¬æ­¥éª¤æ˜¯ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;ç¼–ç è½¬æ¢&lt;/strong&gt;ï¼šå°†å­—ç¬¦ç»Ÿä¸€æˆUTF-32ç¼–ç &lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;è§„èŒƒåŒ–ï¼ˆNormalizationï¼‰&lt;/strong&gt;ï¼šNFC/NFD/NFKC/NFKDç­‰ï¼ŒWeb æ ‡å‡†å’Œç»å¤§å¤šæ•°ç°ä»£ç³»ç»Ÿéƒ½é»˜è®¤ä½¿ç”¨NFC&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;Qï¼šNFC/NFD/NFKC/NFKDæ˜¯ä»€ä¹ˆ&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;è¿™äº›æ˜¯Unicodeæ ‡å‡†é‡Œå®šä¹‰çš„å‡ ç§è§„èŒƒåŒ–å½¢å¼ï¼ŒåŒºåˆ«æ˜¯ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/post/æ–‡å­—æ’ç‰ˆå¼•æ“/å½’ä¸€åŒ–æ ‡å‡†.png&quot; alt=&quot;å½’ä¸€åŒ–æ ‡å‡†&quot; /&gt;&lt;/p&gt;

&lt;h1 id=&quot;äºŒåˆ†æ®µ&quot;&gt;äºŒã€åˆ†æ®µ&lt;/h1&gt;

&lt;blockquote&gt;
  &lt;p&gt;ä¸ºä»€ä¹ˆè¦åˆ†æ®µï¼šä¸åŒå›½å®¶ã€è¯­è¨€çš„æ’ç‰ˆè§„åˆ™ä¸åŒï¼Œæ¯”å¦‚é˜¿æ‹‰ä¼¯æ–‡æœ‰è¿å­—ã€ä¸­æ–‡æ²¡æœ‰ï¼Œé˜¿æ‹‰ä¼¯æ–‡ä»å³åˆ°å·¦æ’ï¼Œä¸­æ–‡ä»å·¦å¾€å³æ’ï¼Œåˆ†æ®µä¹‹åæ–¹ä¾¿åç»­çš„å­—ä½“é€‰æ‹©å’Œshapingï¼Œæ¯”å¦‚HarfBuzz è¿™æ ·çš„ shaping å¼•æ“ä¸€æ¬¡åªèƒ½å¤„ç†ä¸€ä¸ª Script run&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;åˆ†æ®µå°±æ˜¯æŠŠå­—ç¬¦ä¸²æŒ‰ Unicode Script (Latin, Han, Hiragana, Katakana ç­‰) åˆ’åˆ†æˆ runï¼ˆåˆ†ç»„ï¼‰ã€‚&lt;/p&gt;

&lt;p&gt;åŸç†æ¯”è¾ƒç®€å•ï¼ŒUnicode ä¸ºæ¯ä¸ª code point å®šä¹‰äº†ä¸€ä¸ª Script å±æ€§ï¼Œéå†å­—ç¬¦ä¸²ï¼ŒæŒ‰ Script å±æ€§è¿ç»­åˆ†æ®µå³å¯ã€‚&lt;/p&gt;

&lt;p&gt;æ¯”å¦‚å¯¹äº&lt;code class=&quot;highlighter-rouge&quot;&gt;Helloä¸–ç•Œã‚ã„&lt;/code&gt;ï¼Œä»å·¦å¾€å³æ‰«æå­—ç¬¦ä¸²ï¼Œæ¯é‡åˆ° Script æ”¹å˜ï¼Œå°±åˆ‡åˆ†å‡ºä¸€ä¸ª runï¼Œæœ€åä¼šè¢«åˆ’åˆ†æˆï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Hello&lt;/code&gt;â€ â†’ Latin&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;ä¸–ç•Œ&lt;/code&gt; â†’ Han&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;ã‚ã„&lt;/code&gt; â†’ Hiragana&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;ç‰¹æ®Šæƒ…å†µï¼š&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;æœ‰äº›å­—ç¬¦çš„ Script = Commonï¼ˆæ ‡ç‚¹ã€æ•°å­—ã€ç©ºæ ¼ï¼‰æˆ– Inheritedï¼ˆéŸ³è°ƒç¬¦å·ã€å£°è°ƒæ ‡è®°ï¼‰ï¼Œè¿™äº›å­—ç¬¦åˆ†æ®µæ—¶éœ€è¦ç‰¹æ®Šå¤„ç†ï¼Œè§„åˆ™ä¸€èˆ¬æ˜¯ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;å¦‚æœæ˜¯ Common â†’ ç»§æ‰¿ç›¸é‚» run çš„ Scriptï¼ˆå¦‚æœå·¦å³runéƒ½æœ‰Scriptï¼Œä¸€èˆ¬è·Ÿéšå·¦è¾¹ï¼›å¦‚æœå·¦è¾¹æ²¡æœ‰runï¼Œæ¯”å¦‚å¼€å¤´å°±æ˜¯ç©ºæ ¼ï¼Œé‚£å°±è·Ÿéšå³è¾¹ï¼›å¦‚æœå·¦å³éƒ½æ²¡æœ‰runï¼Œæ¯”å¦‚&lt;code class=&quot;highlighter-rouge&quot;&gt;!!!&lt;/code&gt;ï¼Œé‚£æ•´ä½“å°±æ˜¯ä¸€ä¸ªCommon runï¼‰ã€‚&lt;/li&gt;
  &lt;li&gt;å¦‚æœæ˜¯ Inherited â†’ é™„ç€åˆ°å‰ä¸€ä¸ª base å­—ç¬¦çš„ Scriptã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;æ¯”å¦‚ï¼š&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;ä¸–ç•Œ!&lt;/code&gt; â†’ â€œä¸–ç•Œâ€ (Han) + â€œ!â€ (ä¹Ÿå½’ Han run)&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Ã©&lt;/code&gt; (e + é‡éŸ³ç¬¦) â†’ æ•´ä½“ç®— Latin&lt;/p&gt;

&lt;h1 id=&quot;ä¸‰åŒå‘æ–‡æœ¬å¤„ç†bidi&quot;&gt;ä¸‰ã€åŒå‘æ–‡æœ¬å¤„ç†ï¼ˆBiDiï¼‰&lt;/h1&gt;

&lt;p&gt;BiDiå°±æ˜¯å°†å­—ç¬¦ä»&lt;strong&gt;é€»è¾‘é¡ºåº&lt;/strong&gt;å¤„ç†æˆ&lt;strong&gt;è§†è§‰é¡ºåº&lt;/strong&gt;ï¼Œè®¡ç®—æœºé‡Œå­—ç¬¦ä¸²æ€»æ˜¯æŒ‰é€»è¾‘é¡ºåºå­˜å‚¨ï¼ˆç”¨æˆ·è¾“å…¥é¡ºåºï¼‰ï¼Œä½†åœ¨æ¸²æŸ“æ—¶ï¼Œä¸åŒè¯­è¨€æœ‰ä¸åŒçš„ä¹¦å†™æ–¹å‘ï¼Œæ¯”å¦‚ä¸­æ–‡ã€è‹±æ–‡ä»å·¦å¾€å³æ’åˆ—ï¼Œé˜¿æ‹‰ä¼¯æ–‡ã€å¸Œä¼¯æ¥æ–‡ä»å³å¾€å·¦æ’åˆ—ï¼Œå¦‚æœä¸€æ®µæ–‡æœ¬ä¸­æ—¢æœ‰ä¸­æ–‡ã€è‹±æ–‡ï¼Œåˆæœ‰é˜¿æ‹‰ä¼¯æ–‡ã€å¸Œä¼¯æ¥æ–‡ï¼Œé‚£è¿˜å¾—å¤„ç†æ··æ’æ—¶çš„é¡ºåºï¼ŒBiDiå°±æ˜¯å¤„ç†æ··æ’æƒ…å†µä¸‹æ–‡æœ¬çš„å®é™…æ˜¾ç¤ºé¡ºåºçš„ã€‚&lt;/p&gt;

&lt;p&gt;åœ¨åç»­çš„ä¾‹å­ä¸­ï¼Œä¸ºäº†æ–¹ä¾¿æ¼”ç¤ºï¼Œæˆ‘ä»¬å‡è®¾ä»¥å°å†™å­—æ¯ä½œä¸ºLTRï¼Œä»¥å¤§å†™å­—æ¯ä½œä¸ºRTLï¼Œæ¯”å¦‚ï¼š&lt;/p&gt;

&lt;div class=&quot;language-scss highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nt&quot;&gt;abc&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;ABC&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;abc&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;ï¼šè¡¨ç¤º&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;LTR&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;ï¼ˆä»å·¦å¾€å³æ’ï¼‰ä¹¦å†™æ–¹å‘&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;ABC&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;ï¼šè¡¨ç¤º&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;RTL&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;ï¼ˆä»å³å¾€å·¦æ’ï¼‰ä¹¦å†™æ–¹å‘&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Unicodeæœ‰ä¸€å¥—å®Œæ•´çš„BiDiç®—æ³•ï¼ˆç»†èŠ‚å¯&lt;a href=&quot;https://www.unicode.org/reports/tr9/&quot;&gt;å‚è€ƒé“¾æ¥&lt;/a&gt;ï¼‰ï¼Œåœ¨ä»‹ç»åŸç†ä¹‹å‰éœ€è¦å…ˆäº†è§£å‡ ä¸ªåŸºæœ¬æ¦‚å¿µï¼š&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;1ï¼‰å­—ç¬¦ç±»å‹ï¼ˆCharacter Typesï¼‰&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Unicodeç»™æ¯ä¸ªcode pointå®šä¹‰äº†ä¸€ä¸ªBidi_Classçš„å±æ€§ï¼ˆUnicodeçš„æ–¹å‘å±æ€§ï¼‰ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;L&lt;/code&gt; = Left-to-Rightï¼ˆä¸­æ–‡ã€è‹±æ–‡â€¦ï¼‰&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;R&lt;/code&gt; = Right-to-Leftï¼ˆå¸Œä¼¯æ¥æ–‡ï¼‰&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;AL&lt;/code&gt; = Arabic Letterï¼ˆé˜¿æ‹‰ä¼¯æ–‡ï¼‰&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;EN&lt;/code&gt; = European Numberï¼ˆæ¬§æ´²æ•°å­—ï¼‰&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;AN&lt;/code&gt; = Arabic Numberï¼ˆé˜¿æ‹‰ä¼¯æ•°å­—ï¼‰&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;ON&lt;/code&gt; = Other Neutralï¼ˆæ ‡ç‚¹ç¬¦å·ï¼‰&lt;/li&gt;
  &lt;li&gt;â€¦&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;è¿™äº›æ–¹å‘å±æ€§ä¼šæœ‰ä¸€ä¸ªéšå«çš„åˆ†ç±»ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;å¼ºç±»å‹&lt;/strong&gt;ï¼šè¿™ç±»å­—ç¬¦å…·æœ‰æ˜ç¡®çš„æ–¹å‘æ€§ï¼Œå¦‚è‹±æ–‡å­—æ¯æ˜¯ä»å·¦å¾€å³ï¼ˆLTRï¼‰ï¼Œé˜¿æ‹‰ä¼¯æ–‡æ˜¯ä»å³å¾€å·¦ï¼ˆRLTï¼‰&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;å¼±ç±»å‹&lt;/strong&gt;ï¼šè¿™ç±»å­—ç¬¦æ–¹å‘æ€§ä¸æ˜ç¡®ï¼Œæ¯”å¦‚æ•°å­—å’Œä¸€äº›ç¬¦å·ï¼ˆå¦‚å‡ºç°åœ¨æ•°å­—ä¹‹é—´çš„ç¬¦å·&lt;code class=&quot;highlighter-rouge&quot;&gt;.&lt;/code&gt;ã€ &lt;code class=&quot;highlighter-rouge&quot;&gt;,&lt;/code&gt;ç­‰ï¼‰ï¼Œæ¯”å¦‚é˜¿æ‹‰ä¼¯æ•°å­—&lt;code class=&quot;highlighter-rouge&quot;&gt;123&lt;/code&gt;ï¼Œ&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;ä¸­æ€§ç±»å‹&lt;/strong&gt;ï¼šè¿™ç±»å­—ç¬¦å®Œå…¨æ²¡æœ‰æ–¹å‘æ€§ï¼Œå¦‚ç©ºæ ¼ã€æ ‡ç‚¹ç¬¦å·ï¼ˆ&lt;code class=&quot;highlighter-rouge&quot;&gt;.&lt;/code&gt;ã€ &lt;code class=&quot;highlighter-rouge&quot;&gt;,&lt;/code&gt;ã€ &lt;code class=&quot;highlighter-rouge&quot;&gt;?&lt;/code&gt;ç­‰ï¼‰ï¼Œå®ƒä»¬çš„æ–¹å‘å®Œå…¨ç”±å‘¨å›´çš„å¼ºç±»å‹å­—ç¬¦å†³å®š&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;img src=&quot;/img/post/æ–‡å­—æ’ç‰ˆå¼•æ“/BiDi_Class.png&quot; alt=&quot;BiDi_Class&quot; /&gt;&lt;/p&gt;

&lt;p&gt;æ¯”å¦‚ï¼š&lt;/p&gt;

&lt;div class=&quot;language-scss highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// å¦‚ä¸‹ä¸ºè®¡ç®—æœºä¸­å­˜å‚¨çš„é€»è¾‘é¡ºåº&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;abc&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;ABC&lt;/span&gt;

&lt;span class=&quot;nt&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;L&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;L&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;L&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;space&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;WS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;B&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;C&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;2ï¼‰æ®µè½åŸºæœ¬æ–¹å‘ï¼ˆBase Directionï¼‰&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;åœ¨æ²¡æœ‰æ˜ç¡®æŒ‡å®šæ®µè½æ–¹å‘æ—¶ï¼Œä¼šé‡‡ç”¨é»˜è®¤è§„åˆ™æ¥ç¡®å®šæ®µè½åŸºæœ¬æ–¹å‘ï¼Œå³é€‰æ‹©æ®µè½ä¸­&lt;strong&gt;ç¬¬ä¸€ä¸ªå¼ºç±»å‹å­—ç¬¦&lt;/strong&gt;çš„æ–¹å‘ä½œä¸ºæ®µè½åŸºæœ¬æ–¹å‘ï¼Œæ®µè½å¼€å¤´çš„å¼±/ä¸­æ€§å­—ç¬¦ä¼šè¢«å¿½ç•¥ï¼Œç›´åˆ°é‡åˆ°ç¬¬ä¸€ä¸ªå¼ºç±»å‹å­—ç¬¦ï¼›å¦‚æœæ•´æ®µéƒ½æ²¡æœ‰å¼ºç±»å‹å­—ç¬¦ï¼Œåˆ™é»˜è®¤LTRã€‚&lt;/p&gt;

&lt;p&gt;æ¯”å¦‚ï¼š&lt;/p&gt;

&lt;div class=&quot;language-scss highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// å¦‚ä¸‹ä¸ºè®¡ç®—æœºä¸­å­˜å‚¨çš„é€»è¾‘é¡ºåº&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;// case-1&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;abc&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;ABC&lt;/span&gt;

&lt;span class=&quot;nt&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;L&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;L&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;L&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;space&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;WS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;C&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;err&quot;&gt;æ®µè½æ–¹å‘ä¸º&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;LTR&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;//&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;case-2&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&quot;123abc&quot;&lt;/span&gt;

&lt;span class=&quot;nt&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;EN&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;EN&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;EN&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;L&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;L&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;L&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;err&quot;&gt;æ®µè½æ–¹å‘ä¸º&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;LTR&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;//&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;case-3&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&quot;123&quot;&lt;/span&gt;

&lt;span class=&quot;nt&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;EN&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;EN&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;EN&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;err&quot;&gt;æ®µè½æ–¹å‘ä¸ºé»˜è®¤&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;LTR&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;æ®µè½åŸºæœ¬æ–¹å‘ä¸»è¦æœ‰ä¸‰ä¸ªä½œç”¨ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;ç¡®å®šåˆå§‹çš„åµŒå¥—ç­‰çº§ï¼ˆè§ä¸‹ï¼‰ï¼Œå¦‚æœåŸºæœ¬æ–¹å‘ä¸ºLTRï¼Œåˆ™åµŒå¥—ç­‰çº§ä»0å¼€å§‹ï¼›å¦‚æœåŸºæœ¬æ–¹å‘ä¸ºRTLï¼Œåˆ™åµŒå¥—ç­‰çº§ä»1å¼€å§‹&lt;/li&gt;
  &lt;li&gt;å†³å®šä¸­æ€§å­—ç¬¦çš„æ–¹å‘ï¼Œå¦‚æœä¸­æ€§å­—ç¬¦å·¦å³éƒ½æ²¡æœ‰å¼ºç±»å‹å­—ç¬¦ï¼Œé‚£å°±ä¼šè·Ÿéšæ®µè½æ–¹å‘ï¼Œæ¯”å¦‚&lt;code class=&quot;highlighter-rouge&quot;&gt;Hello !&lt;/code&gt;ä¸­&lt;code class=&quot;highlighter-rouge&quot;&gt;!&lt;/code&gt;ä¼šè·Ÿéšæ®µè½æ–¹å‘LTR&lt;/li&gt;
  &lt;li&gt;å†³å®šæ®µè½ä¸­æ–‡æ¡£æµæ–¹å‘ï¼Œå¦‚æœåŸºæœ¬æ–¹å‘ä¸ºLTRï¼Œæ–‡æœ¬å°†ä»å®¹å™¨å·¦ä¾§å¼€å§‹å‘å³æ’ï¼›å¦‚æœåŸºæœ¬æ–¹å‘ä¸ºRTLï¼Œæ–‡æœ¬å°†ä»å®¹å™¨å³ä¾§å¼€å§‹å‘å·¦æ’&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;3ï¼‰åµŒå¥—ç­‰çº§ï¼ˆEmbedding Levelsï¼‰&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;BiDiç®—æ³•ä¸­ç”¨å¶æ•°ç­‰çº§ï¼ˆ0, 2, 4â€¦ï¼‰ä»£è¡¨LTRæ–¹å‘ï¼Œå¥‡æ•°ç­‰çº§ï¼ˆ1, 3, 5â€¦ï¼‰ä»£è¡¨RTLæ–¹å‘ï¼›å¦‚å‰æ‰€è¿°ï¼Œæ®µè½åŸºæœ¬æ–¹å‘å†³å®šäº†åˆå§‹çš„åµŒå¥—ç­‰çº§ï¼ˆ0çº§ä¸ºLTRï¼Œ1çº§ä¸ºRTLï¼‰ï¼Œå½“æ–‡æœ¬ä¸­å‡ºç°æ–¹å‘å˜åŒ–æ—¶ï¼Œç®—æ³•ä¼šç›¸åº”åœ°æå‡åµŒå¥—ç­‰çº§ã€‚&lt;/p&gt;

&lt;p&gt;ä»æ®µè½åˆå§‹ç­‰çº§å¼€å§‹ï¼Œå½“é‡åˆ°æ–¹å‘å˜åŒ–æ—¶ï¼Œå°±æå‡ä¸€ä¸ªç­‰çº§ï¼›å¯¹äºå¼ºç±»å‹å­—ç¬¦ç­‰çº§æ¯”è¾ƒå®¹æ˜“ç¡®å®šï¼Œå¯¹äºå¼±ç±»å‹ä¸ä¸­æ€§ç±»å‹å­—ç¬¦åˆ™éœ€è¦ç»“åˆä¸Šä¸‹æ–‡æ¥å…±åŒç¡®å®šã€‚&lt;/p&gt;

&lt;p&gt;å¯¹äºå¼±ç±»å‹å­—ç¬¦ï¼šæ¯”å¦‚AN/ENæ•°å­—åŠå…¶ä¹‹é—´çš„æ ‡ç‚¹ç¬¦å·ï¼Œè¿™äº›å­—ç¬¦å³ä½¿åœ¨ RTL æ–‡æœ¬ä¸­ä¹Ÿé€šå¸¸æŒ‰ LTR ä¹¦å†™ã€‚&lt;/p&gt;

&lt;p&gt;å¯¹äºä¸­æ€§å­—ç¬¦ï¼šå‡è®¾ä¸­æ€§å­—ç¬¦&lt;code class=&quot;highlighter-rouge&quot;&gt;c&lt;/code&gt;å·¦å³å­—ç¬¦ï¼ˆé€»è¾‘é¡ºåºï¼‰åˆ†åˆ«ä¸º&lt;code class=&quot;highlighter-rouge&quot;&gt;b&lt;/code&gt;ã€&lt;code class=&quot;highlighter-rouge&quot;&gt;d&lt;/code&gt;ï¼Œ&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;å¦‚æœbã€déƒ½ä¸ºå¼ºç±»å‹å­—ç¬¦ï¼Œä¸”&lt;code class=&quot;highlighter-rouge&quot;&gt;direction(b) = direction(d) = D&lt;/code&gt;ï¼Œåˆ™&lt;code class=&quot;highlighter-rouge&quot;&gt;direction(c) = D&lt;/code&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;å¦‚æœbæ˜¯å¼ºç±»å‹å­—ç¬¦ï¼Œä¸”&lt;code class=&quot;highlighter-rouge&quot;&gt;direction(b) = RTL&lt;/code&gt;ï¼Œä¸”dæ˜¯ANæˆ–ENï¼Œåˆ™&lt;code class=&quot;highlighter-rouge&quot;&gt;direction(c) = RTL&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;å¦‚æœbæ˜¯ANæˆ–ENï¼Œä¸”dæ˜¯å¼ºç±»å‹å­—ç¬¦ï¼Œä¸”&lt;code class=&quot;highlighter-rouge&quot;&gt;direction(d) = RTL&lt;/code&gt;ï¼Œåˆ™&lt;code class=&quot;highlighter-rouge&quot;&gt;direction(c) = RTL&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;å¦‚æœbæ˜¯ANæˆ–ENï¼Œä¸”dæ˜¯ANæˆ–ENï¼Œåˆ™&lt;code class=&quot;highlighter-rouge&quot;&gt;direction(c) = RTL&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;å¦åˆ™&lt;code class=&quot;highlighter-rouge&quot;&gt;direction(c) = direction(EL(c))&lt;/code&gt;ï¼ˆå³å…¶åµŒå¥—çº§åˆ«çš„æ–¹å‘ï¼Œå¦‚æœæ²¡æœ‰æ§åˆ¶ç¬¦æ˜ç¡®é™åˆ¶åˆ™ä¸ºæ®µè½åŸºæœ¬æ–¹å‘ï¼‰&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;æ¯”å¦‚ï¼š&lt;/p&gt;

&lt;div class=&quot;language-scss highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// æ®µè½åŸºæœ¬æ–¹å‘æ˜¯LTRï¼Œåˆå§‹ç­‰çº§0&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;é€»è¾‘é¡ºåºï¼š&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;car&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;means&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;CAR&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;åµŒå¥—ç­‰çº§ï¼š&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;00000000001110&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;è§£é‡Šï¼š&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;CAR&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;ä¸º&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;RTL&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;ï¼Œæ–¹å‘å˜åŒ–æ‰€ä»¥ä»&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;æå‡åˆ°&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;ï¼›ä¸­æ€§å­—ç¬¦&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;åœ¨æ®µè½é¦–å°¾æ—¶éµå¾ª&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;//&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;æ®µè½åŸºæœ¬æ–¹å‘æ˜¯&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;RTL&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;ï¼Œåˆå§‹ç­‰çº§&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;1&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;é€»è¾‘é¡ºåºï¼š&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;CAR&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;means&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;car&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;åµŒå¥—ç­‰çº§ï¼š&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;11112222222221&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;è§£é‡Šï¼šç¬¬ä¸€ä¸ªç©ºæ ¼å·¦å³åˆ†åˆ«æ—¶&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;RTL&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;å’Œ&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;LTR&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;ï¼Œä¼šéµå¾ªæ®µè½æ–¹å‘ï¼›ç¬¬äºŒä¸ªç©ºæ ¼å·¦å³éƒ½æ˜¯&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;LTR&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;ï¼Œè¢«æå‡ä¸º&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;LTR&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Qï¼šä¸ºä»€ä¹ˆéœ€è¦2ã€3ã€4ç­‰æ›´é«˜ç­‰çº§çš„åµŒå¥—å‘¢ï¼Ÿ&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Unicodeä¸­æœ‰ä¸€äº›åµŒå¥—æ§åˆ¶ç¬¦ï¼Œå¯ä»¥æ˜¾ç¤ºæå‡åµŒå¥—ç­‰çº§ï¼Œæ¯”å¦‚LREï¼ˆU+202Aï¼‰ï¼ŒRLEï¼ˆU+202Bï¼‰ç­‰&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;img src=&quot;/img/post/æ–‡å­—æ’ç‰ˆå¼•æ“/åµŒå¥—æ§åˆ¶ç¬¦.png&quot; alt=&quot;åµŒå¥—æ§åˆ¶ç¬¦&quot; /&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;BiDiç®—æ³•ä¼šä»æœ€é«˜åµŒå¥—ç­‰çº§é€çº§åè½¬å­—ç¬¦ï¼Œå¦‚æœæ²¡æœ‰å¤šçº§åµŒå¥—ï¼Œé‡åˆ°å¤æ‚ç»“æ„æ—¶ï¼ˆæ¯”å¦‚ RTL å†…åµŒ LTRï¼Œå†å†…åµŒæ•°å­—ï¼‰ï¼Œå°±æ— æ³•åªåè½¬æŸä¸€å±‚è€Œä¿æŒå…¶ä»–å±‚æ¬¡ç¨³å®š&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ç†è§£ä¸Šé¢æ¦‚å¿µåï¼Œæˆ‘ä»¬æ¥ç®€è¿°BiDiç®—æ³•çš„åŸºæœ¬è¿‡ç¨‹ï¼š&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;1ï¼‰åˆ†æ®µå¹¶ç¡®å®šæ®µè½åŸºæœ¬æ–¹å‘&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;BiDiç®—æ³•æ˜¯é’ˆå¯¹æ®µè½ç”Ÿæ•ˆçš„ï¼Œæ‹¿åˆ°ä¸€ç¯‡æ–‡æ¡£åï¼Œéœ€è¦å…ˆå°†æ–‡æ¡£æ‹†åˆ†æˆæ®µè½ï¼Œå¹¶ä¸ºæ®µè½ç¡®å®šåŸºæœ¬æ–¹å‘ã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;2ï¼‰ä¸ºæ¯ä¸ªå­—ç¬¦åˆ†é…åµŒå¥—ç­‰çº§&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;3ï¼‰åœ¨å¥‡æ•°å±‚åšé•œåƒå­—ç¬¦æ›¿æ¢&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;åœ¨å¥‡æ•°çº§åˆ«ï¼ˆå³ RTL å±‚çº§ï¼‰ä¸­ï¼Œå¯¹ç§°å­—ç¬¦ï¼ˆå¦‚æ‹¬å·ã€å°–æ‹¬å·ã€å¼•å·ç­‰ï¼‰è¦â€œé•œåƒâ€æ›¿æ¢ã€‚&lt;/p&gt;

&lt;p&gt;ä¾‹å¦‚åœ¨ RTL å±‚ä¸­ï¼Œä¸€ä¸ª â€œ(â€ åº”è¯¥æ˜¾ç¤ºä¸º â€œ)â€ï¼Œä¸€ä¸ª â€œ)â€ åº”è¯¥æ˜¾ç¤ºä¸º â€œ(â€ã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;4ï¼‰é˜¿æ‹‰ä¼¯è¿å­—å¤„ç†&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;ç”¨ä¸€ä¸ªæ–°å­—ç¬¦æ›¿æ¢ç›¸é‚»çš„é˜¿æ‹‰ä¼¯å­—ç¬¦ï¼Œå¹¶ç¡®å®šæ¯ä¸ªé˜¿æ‹‰ä¼¯å­—ç¬¦çš„ä½ç½®å’Œå½¢çŠ¶ã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;5ï¼‰æŒ‰åµŒå…¥çº§åˆ«åè½¬å­ä¸²ä»¥ç”Ÿæˆè§†è§‰é¡ºåº&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;å¯¹æ¯è¡Œï¼ˆlineï¼‰åˆ†åˆ«å¤„ç†ï¼ˆå› ä¸ºæ®µè½å¯èƒ½è·¨å¤šè¡Œï¼‰ï¼Œå‡è®¾æœ€é«˜åµŒå¥—ç­‰çº§ä¸º&lt;code class=&quot;highlighter-rouge&quot;&gt;EL_h&lt;/code&gt;ï¼Œ&lt;strong&gt;æœ€ä½å¥‡æ•°çº§åˆ«&lt;/strong&gt;ä¸º&lt;code class=&quot;highlighter-rouge&quot;&gt;EL_l&lt;/code&gt;ï¼Œä»EL_hé€’å‡åˆ°EL_lï¼Œåœ¨æ¯ä¸€çº§åˆ«å°±åœ°åè½¬å­ä¸²&lt;/p&gt;

&lt;p&gt;é€’å½’å¤„ç†å®Œåï¼Œç”±é«˜å±‚çº§åˆ°ä½å±‚çº§åè½¬åµŒå¥—å­ä¸²ï¼Œå°±èƒ½å¾—åˆ°æœ€ç»ˆæ¯è¡Œçš„è§†è§‰é¡ºåºã€‚&lt;/p&gt;

&lt;p&gt;è¯¦ç»†é€»è¾‘å¯ä»¥å‚è€ƒï¼šhttps://cs.uwaterloo.ca/~dberry/ATEP/Slides/UnicodeBiDiAlgorithm.pdf&lt;/p&gt;

&lt;p&gt;ä¸‹é¢ä»¥å‡ ä¸ªä¾‹å­è¯´æ˜ï¼š&lt;/p&gt;

&lt;div class=&quot;language-scss highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// case-1&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;é€»è¾‘é¡ºåºï¼š&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;car&lt;/span&gt;&lt;span class=&quot;err&quot;&gt; &lt;/span&gt;&lt;span class=&quot;na&quot;&gt;means&lt;/span&gt;&lt;span class=&quot;err&quot;&gt; &lt;/span&gt;&lt;span class=&quot;na&quot;&gt;CAR&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;.
æ®µè½ç­‰çº§ï¼š&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;ï¼ˆç¬¬ä¸€ä¸ªå¼ºå­—ç¬¦ä¸º&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;LTR&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;ï¼Œæ‰€ä»¥æ®µè½ç­‰çº§ä¸º&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;ï¼‰
åµŒå¥—ç­‰çº§ï¼š&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;00000000001110&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;
åè½¬&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;level&lt;/span&gt;&lt;span class=&quot;err&quot;&gt; &lt;/span&gt;&lt;span class=&quot;na&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;car&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;means&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;RAC&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;//&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;case-2&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;é€»è¾‘é¡ºåºï¼š&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;RLE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;car&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;MEANS&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;CAR&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;PDF&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;æ®µè½ç­‰çº§ï¼š&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;ï¼ˆ&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;RLT&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;å¼€å¯ä¸€ä¸ªæ–°çš„åµŒå¥—ç­‰çº§ï¼ŒåµŒå¥—ç­‰çº§æå‡åˆ°&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;ï¼Œæ®µè½ç­‰çº§ä¸º&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;ï¼›&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;PDF&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;ä¸ºè¡¨ç¤ºåµŒå¥—ç»ˆæ­¢ï¼‰&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;åµŒå¥—ç­‰çº§ï¼š&lt;/span&gt;     &lt;span class=&quot;m&quot;&gt;22211111111111&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;åè½¬&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;level&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;ï¼š&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rac&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;MEANS&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;CAR&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;åè½¬&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;level&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;~&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;ï¼š&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;RAC&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SNAEM&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;car&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;//&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;case-3&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;é€»è¾‘é¡ºåºï¼š&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;he&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;said&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;[RLE]car MEANS CAR[PDF].&quot;&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;æ®µè½ç­‰çº§ï¼š&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;åµŒå¥—ç­‰çº§ï¼š&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;000000000&lt;/span&gt;     &lt;span class=&quot;m&quot;&gt;2221111111111&lt;/span&gt;     &lt;span class=&quot;m&quot;&gt;00&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;åè½¬&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;level&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;ï¼š&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;he&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;said&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;rac MEANS CAR.&quot;&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;åè½¬&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;level&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;~&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;ï¼š&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;he&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;said&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;RAC SNAEM car.&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;å››å­—ä½“åŒ¹é…ä¸fallback&quot;&gt;å››ã€å­—ä½“åŒ¹é…ä¸Fallback&lt;/h1&gt;

&lt;p&gt;å­—ä½“åŒ¹é…ä¸Fallbackæ˜¯ä¸€ä¸ªå¤æ‚çš„è¿‡ç¨‹ï¼Œæˆ‘ä»¬åç»­çš„å¡‘å½¢ä¸æµ‹é‡éƒ½ä¾èµ–å­—ä½“æ–‡ä»¶ã€‚&lt;/p&gt;

&lt;p&gt;ç”±äºä»»ä½•ä¸€ä¸ªå­—ä½“éƒ½ä¸å¯èƒ½è¦†ç›– Unicode çš„æ‰€æœ‰å­—ç¬¦ï¼Œæ¯”å¦‚ï¼šTimes New Roman æ¸²æŸ“æ‹‰ä¸å­—æ¯æ²¡é—®é¢˜ï¼Œä½†é‡åˆ°ä¸­æ–‡ â€œä½ â€ å°±ä¼šå˜æˆâ€œè±†è…å—â€ï¼ˆå°æ–¹å—ï¼šæ˜¯æ“ä½œç³»ç»Ÿåœ¨æ²¡æ‰¾åˆ°åˆé€‚å­—ä½“æ¥æ˜¾ç¤ºå­—ç¬¦æ—¶ï¼Œä¼šå…œåº•åˆ°å ä½ç¬¦ï¼Œæ¯”å¦‚â˜æˆ–ï¿½ç­‰ï¼‰ï¼›æ‰€ä»¥æ’ç‰ˆç³»ç»Ÿå®é™…è¦åšçš„å°±æ˜¯ï¼šç¡®ä¿æ¯ä¸ªå­—ç¬¦éƒ½æœ‰åˆé€‚çš„å­—ä½“æ¥æ¸²æŸ“ï¼ŒåŒæ—¶å°½é‡ä¿æŒé£æ ¼ä¸€è‡´ã€‚&lt;/p&gt;

&lt;p&gt;æ¯ä¸ªå­—ç¬¦éƒ½æœ‰å¯¹åº”çš„code pointï¼Œåœ¨&lt;a href=&quot;https://mp.weixin.qq.com/s/D0A8HAQaQNart7KAdWXyJg&quot;&gt;Fontæ–‡ä»¶ä¸­æœ‰ä»€ä¹ˆ&lt;/a&gt;ä¸€æ–‡ä¸­ï¼Œæˆ‘ä»¬çŸ¥é“äº†å­—ä½“æ–‡ä»¶ä¸­æœ‰å„ç§å„æ ·çš„è¡¨ï¼Œå…¶ä¸­cmapè¡¨å­˜å‚¨äº†code pointä¸glyphIDçš„æ˜ å°„ï¼Œé€šè¿‡cmapè¡¨æˆ‘ä»¬å¯ä»¥ç²¾ç¡®çš„æŸ¥åˆ°è¯¥Fontæ˜¯å¦æ”¯æŒæŸä¸ªcode pointï¼Œä½†æ˜¯ä»…é€šè¿‡cmapæŸ¥è¯¢æ˜¯ä¸å¤Ÿçš„ï¼Œä¸»è¦æœ‰ä¸¤ä¸ªåŸå› ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;æ“ä½œç³»ç»Ÿä¸€èˆ¬å®‰è£…äº†æˆç™¾ä¸Šåƒç§å­—ä½“ï¼Œå¦‚æœå¯¹æ¯ä¸ªcode pointéƒ½å»éå†æ‰€æœ‰Fontçš„cmapè¡¨ï¼Œé‚£å¼€é”€ä¼šéå¸¸å¤§&lt;/li&gt;
  &lt;li&gt;ä¸åŒFontæ”¯æŒçš„UnicodeèŒƒå›´æ˜¯æœ‰äº¤é›†çš„ï¼Œä¸€ä¸ªcode pointå¯èƒ½åŒ¹é…å‡ºå¤šä¸ªFontï¼Œä¸ºäº†æ¸²æŸ“é£æ ¼çš„ç»Ÿä¸€ï¼Œæˆ‘ä»¬æœŸæœ›ç›¸åŒScriptçš„å­—ç¬¦å°½é‡ç”¨åŒä¸€ç§Font&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;p&gt;&lt;strong&gt;Qï¼šç›¸åŒScriptçš„å­—ç¬¦å¦‚æœä½¿ç”¨äº†ä¸åŒçš„Fontï¼Œä¼šæœ‰ä»€ä¹ˆé—®é¢˜&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Unicode ä¸ºäº†èŠ‚çœç ç‚¹ç©ºé—´ï¼Œå°†è®¸å¤šä¸­ã€æ—¥ã€éŸ©æ¥æºç›¸åŒä½†å­—å½¢æœ‰ç»†å¾®å·®å¼‚çš„æ±‰å­—åˆå¹¶åˆ°äº†åŒä¸€ä¸ªç ç‚¹ä¸Šï¼Œä¹Ÿå°±æ˜¯æ‰€è°“çš„&lt;a href=&quot;https://zh.wikipedia.org/wiki/%E4%B8%AD%E6%97%A5%E9%9F%93%E7%B5%B1%E4%B8%80%E8%A1%A8%E6%84%8F%E6%96%87%E5%AD%97&quot;&gt;ä¸­æ—¥éŸ©ç»Ÿä¸€è¡¨æ„æ–‡å­—&lt;/a&gt;ï¼ˆCJK Unified Ideographsï¼‰ï¼›å¦‚ä¸‹ï¼ŒåŒä¸€ä¸ªcode pointåœ¨ä¸åŒè¯­è¨€ä¸‹æ ·å¼ä¸åŒï¼Œå¦‚æœä¸å¤„ç†Scriptï¼Œé‚£å¯èƒ½ä¼šåœ¨ä¸€ä¸ªæ—¥æ–‡æ®µè½é‡Œæ˜¾ç¤ºå‡ºä¸­æ–‡çš„â€œæˆ¿â€å­—å½¢ï¼Œè¿™åœ¨ä¸“ä¸šæ’ç‰ˆä¸Šæ˜¯ä¸å¯æ¥å—çš„ã€‚å¦å¤–ï¼Œä¸åŒçš„Fontæ ¼è®¾è®¡é£æ ¼ï¼ˆå­—å®½ã€åŸºçº¿ã€å½¢æ€ï¼‰ä¹Ÿä¸åŒï¼Œå¦‚æœä¸€ä¸ªæ®µè½é‡Œç©¿æ’ä¸åŒçš„Fontï¼Œé‚£æœ€ç»ˆæ’ç‰ˆçœ‹èµ·æ¥ä¹Ÿä¼šå¾ˆå¥‡æ€ªã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/post/æ–‡å­—æ’ç‰ˆå¼•æ“/CJK Unifined.png&quot; alt=&quot;CJK Unifined&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ç°ä»£æ“ä½œç³»ç»Ÿåšå­—ä½“åŒ¹é…ä¸Fallbackçš„æ–¹å¼ä¸€èˆ¬æ˜¯ï¼š&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;1ï¼‰é€šè¿‡å‰é¢çš„åˆ†æ®µï¼Œå°†ä¸€æ®µå­—ç¬¦ä¸²æŒ‰Scriptåˆ†æˆä¸åŒçš„run&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;2ï¼‰æ£€æŸ¥ç”¨æˆ·æŒ‡å®šçš„ä¸»å­—ä½“æ˜¯å¦æ”¯æŒ&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;æ£€æŸ¥ç”¨æˆ·æŒ‡å®šå­—ä½“ï¼ˆä¸»å­—ä½“ï¼‰çš„cmapæ˜¯å¦æ”¯æŒå¯¹åº”å­—ç¬¦ï¼ˆcode pointï¼‰ï¼Œå¦‚æœæ”¯æŒåˆ™å‘½ä¸­ä¸»å­—ä½“ï¼Œå¦‚æœä¸æ”¯æŒåˆ™è¿›å…¥Fallbackæµç¨‹ã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;3ï¼‰Fallbackæ—¶æŒ‰OS_2è¡¨ä¸­çš„ulUnicodeRangeæ©ç åˆæ­¥ç­›é€‰æ”¯æŒçš„UnicodeèŒƒå›´&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;æ³¨æ„OS_2è¡¨åªæ˜¯ä¸€ä¸ªå¤§æ¦‚èŒƒå›´ï¼Œå¹¶ä¸ä»£è¡¨å®Œå…¨æ”¯æŒè¯¥èŒƒå›´çš„Unicodeï¼Œå¦‚æœè¦ç²¾ç¡®æŸ¥è¯¢æ˜¯å¦æ”¯æŒè¿˜æ˜¯è¦æŸ¥cmapè¡¨ã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;4ï¼‰é€šè¿‡&lt;code class=&quot;highlighter-rouge&quot;&gt;GSUB&lt;/code&gt;/&lt;code class=&quot;highlighter-rouge&quot;&gt;GPOS&lt;/code&gt; è¡¨ç²¾ç¡®æŸ¥æ‰¾æ”¯æŒå“ªäº›Script&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;GSUB&lt;/code&gt;/&lt;code class=&quot;highlighter-rouge&quot;&gt;GPOS&lt;/code&gt;ä¸­å®šä¹‰äº†&lt;code class=&quot;highlighter-rouge&quot;&gt;ScriptList&lt;/code&gt;ï¼Œæ˜ç¡®å£°æ˜å­—ä½“ä¸ºå“ªäº›Scriptæä¾›äº†shapingè§„åˆ™ï¼›æ’ç‰ˆå¼•æ“é€šè¿‡&lt;code class=&quot;highlighter-rouge&quot;&gt;GSUB&lt;/code&gt;/&lt;code class=&quot;highlighter-rouge&quot;&gt;GPOS&lt;/code&gt;è¡¨æ¥å¤„ç†å¤æ‚çš„æ’ç‰ˆè§„åˆ™ï¼Œæ¯”å¦‚å­—å½¢æ›¿æ¢ã€è¿å­—ã€ä¸Šä¸‹æ ‡å¯¹é½ç­‰ï¼Œæ’ç‰ˆå¼•æ“ä¼šä¼˜å…ˆé€‰æ‹©æ˜ç¡®æ”¯æŒå¯¹åº”Scriptçš„Fontã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;5ï¼‰é€šè¿‡cmapè¡¨éªŒè¯æ”¯æŒçš„code point&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;å¦‚æœåŒ¹é…å‡ºå¤šä¸ªFallbackå­—ä½“ï¼Œé‚£ç³»ç»Ÿå¯èƒ½ä¼šæ ¹æ®ç”¨æˆ·è®¾ç½®çš„ä¸»å­—ä½“é£æ ¼ï¼Œç³»ç»Ÿè¯­è¨€ã€å­—ä½“ä¼˜å…ˆçº§ç­‰æ¥é€‰æ‹©æœ€ä¼˜çš„å­—ä½“ã€‚&lt;/p&gt;

&lt;p&gt;å½“ç„¶ï¼Œæ“ä½œç³»ç»Ÿä¸­ä¸€èˆ¬ä¼šå¯¹Scriptçš„Fallbackå­—ä½“è¡¨æœ‰ç¼“å­˜ï¼Œä¸Šé¢çš„3ã€4æ­¥éª¤ä¸€èˆ¬ä¸ç”¨æ¯æ¬¡éƒ½åšï¼ŒFallbackè¡¨ç±»ä¼¼äºï¼š&lt;/p&gt;

&lt;div class=&quot;language-json highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;scripts&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;hans&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Microsoft YaHei&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;SimSun&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Source Han Sans SC&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;hant&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Microsoft JhengHei&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Source Han Sans TC&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;latn&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Arial&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Times New Roman&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Verdana&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Microsoft YaHei&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;kana&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Meiryo&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Yu Gothic&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Source Han Sans JP&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;families&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Arial&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;regular&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;arial.ttf&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;bold&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;arialbd.ttf&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;æˆ‘ä»¬åç»­ä¹Ÿä¼šé€†å‘æ¢ç©¶ä¸‹CoreTextä¸­çš„å­—ä½“çº§è”ï¼ˆFallbackï¼‰æœºåˆ¶ï¼Œæ›´ç»†èŠ‚çš„è¿™é‡Œä¸å†å±•å¼€ã€‚&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;&lt;strong&gt;Qï¼šåƒ&lt;code class=&quot;highlighter-rouge&quot;&gt;ğŸ‘¨â€ğŸ‘©â€ğŸ‘§&lt;/code&gt;è¿™ç§ç”±å¤šä¸ªcode pointç»„æˆçš„å­—ç¬¦ï¼Œæ˜¯æ€ä¹ˆåŒ¹é…Fontçš„&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;åƒ&lt;code class=&quot;highlighter-rouge&quot;&gt;ğŸ‘¨â€ğŸ‘©â€ğŸ‘§&lt;/code&gt;è¿™ç§ç”±å¤šä¸ªcode pointç»„æˆçš„å­—ç¬¦ï¼ˆå¦‚ä¸‹ï¼‰ï¼Œä¸€èˆ¬ç§°ä¹‹ä¸ºGrapheme Clusterï¼ˆå­—ç´ ç°‡ï¼‰ï¼š&lt;/p&gt;

&lt;div class=&quot;language-scss highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;err&quot;&gt;ğŸ‘¨&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;U&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;1F468&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;MAN&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;  
&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;U&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;200D&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;ZWJ&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;Zero&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;Width&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;Joiner&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;  
&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;ğŸ‘©&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;U&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;1F469&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;WOMAN&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;  
&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;U&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;200D&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;ZWJ&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;Zero&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;Width&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;Joiner&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;  
&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;ğŸ‘§&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;U&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;1F467&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;GIRL&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Unicode Emoji æ ‡å‡†é‡Œè§„å®šäº†å“ªäº›åºåˆ—å¯ä»¥ç»„åˆæˆå•ä¸ª emojiï¼ˆå¦‚ ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ã€ğŸ‘©â€â¤ï¸â€ğŸ‘© ç­‰ï¼‰ï¼Œæ’ç‰ˆå¼•æ“ä¼šæ ¹æ®Emoji dataï¼ˆæ¥è‡ªUnicodeæ•°æ®è¡¨ï¼‰æ¥åˆ¤æ–­è¿™æ˜¯ä¸æ˜¯ä¸€ä¸ªåˆæ³•çš„ZWJ Sequenceï¼Œè¯†åˆ«æˆåŠŸä¼šå°†å…¶è§†ä¸ºä¸€ä¸ªä¸å¯åˆ†å‰²çš„å•å…ƒï¼Œåœ¨åŒ¹é…å­—ä½“æ—¶ä¼šåšå¦‚ä¸‹å¤„ç†ï¼š&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;1ï¼‰ç”¨ç»„åˆåºåˆ—çš„ç¬¬ä¸€ä¸ªéZWJ code point å»æŸ¥æ‰¾å­—ä½“&lt;/strong&gt;&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;ZWJï¼šZero Width Joinerï¼Œé›¶å®½åº¦è¿æ¥ç¬¦ï¼Œå®ƒçš„ä½œç”¨å°±åƒâ€œèƒ¶æ°´â€ï¼Œå‘Šè¯‰æ’ç‰ˆå¼•æ“ä¸¤ä¾§å­—ç¬¦ä¸å¯åˆ†å‰²ã€‚&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;å¯¹äº&lt;code class=&quot;highlighter-rouge&quot;&gt;ğŸ‘¨â€ğŸ‘©â€ğŸ‘§&lt;/code&gt;æ¥è¯´ï¼Œå°±æ˜¯ç”¨ &lt;code class=&quot;highlighter-rouge&quot;&gt;U+1F468&lt;/code&gt; (ğŸ‘¨)ï¼Œå»æŸ¥æ‰¾å­—ä½“ï¼ŒæŸ¥æ‰¾å’ŒFallbackè¿‡ç¨‹åŒä¸Šã€‚ä¸€èˆ¬è€Œè¨€ä¼šåŒ¹é…åˆ°ç³»ç»Ÿå†…ç½®çš„å½©è‰²è¡¨æƒ…ç¬¦å·å­—ä½“ï¼šmacOS/iOSä¸Šä¸€èˆ¬æ˜¯&lt;code class=&quot;highlighter-rouge&quot;&gt;Apple Color Emoji&lt;/code&gt;ï¼ŒWindowsä¸Šæ˜¯&lt;code class=&quot;highlighter-rouge&quot;&gt;Segoe UI Emoji&lt;/code&gt;ï¼ŒAndroidä¸Šä¸€èˆ¬æ˜¯&lt;code class=&quot;highlighter-rouge&quot;&gt;Noto Color Emoji&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;2ï¼‰ç”¨åŒ¹é…çš„å­—ä½“è¿›è¡Œå­—å½¢æ›¿æ¢&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;è¿™ä¸€æ­¥å…¶å®å‘ç”Ÿåœ¨ä¸‹é¢çš„å¡‘æ€§é˜¶æ®µï¼Œåœ¨æŸ¥åˆ°çš„å­—ä½“è¡¨ä¸­é€šè¿‡ GSUBè¡¨æŠŠå¤šä¸ª code point æ˜ å°„æˆä¸€ä¸ªå½©è‰²çš„glyphï¼Œä¹Ÿå°±æ˜¯å­—å½¢æ›¿æ¢ã€‚&lt;/p&gt;

&lt;p&gt;å¦‚æœè¿™ä¸€æ­¥æ²¡æ‰¾åˆ°åˆæ³•çš„å¯æ›¿æ¢å­—å½¢ï¼Œé‚£å°±Fallbackåˆ°å•ç‹¬æ˜¾ç¤º&lt;code class=&quot;highlighter-rouge&quot;&gt;ğŸ‘¨ ğŸ‘© ğŸ‘§&lt;/code&gt;&lt;/p&gt;

&lt;h1 id=&quot;äº”å­—å½¢é€‰æ‹©ä¸shaping&quot;&gt;äº”ã€å­—å½¢é€‰æ‹©ä¸Shaping&lt;/h1&gt;

&lt;p&gt;è¿™ä¸€æ­¥çš„ç›®æ ‡æ˜¯å°†æŠ½è±¡çš„å­—ç¬¦è½¬æ¢æˆå…·ä½“çš„glyphIDså’Œå¸ƒå±€ä¿¡æ¯ï¼Œä»¥ä¾›ä¸‹ä¸€æ­¥æ’ç‰ˆä½¿ç”¨ï¼›è¾“å…¥æ˜¯ä¸€æ®µå•ä¸€ Scriptã€å•ä¸€å­—ä½“çš„æ–‡æœ¬ runå’Œä¸Šé¢åŒ¹é…å‡ºçš„å­—ä½“ï¼Œè¾“å‡ºæ˜¯ä¸€ä¸ªå­—å½¢åºåˆ—ï¼ŒåŒ…æ‹¬glyphIDsã€x_advanceã€y_advanceã€x_offsetã€y_offsetç­‰ã€‚&lt;/p&gt;

&lt;p&gt;å¤§è‡´åˆ†ä¸ºä¸¤æ­¥ï¼š&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;1ï¼‰code pointæ˜ å°„åˆ°glyphID&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;æ¯ä¸ªcode pointä¼šé€šè¿‡å­—ä½“çš„cmapè¡¨æ˜ å°„æˆä¸€ä¸ªglyphIDã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;2ï¼‰æ–‡æœ¬å¡‘å½¢ï¼šåº”ç”¨GSUBã€GPOSè§„åˆ™&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Shapingå¼•æ“ä¼šè¯»å–å­—ä½“æ–‡ä»¶ä¸­çš„GSUBè¡¨ï¼Œè¿›è¡Œå­—å½¢æ›¿æ¢ï¼Œæ¯”å¦‚è¿å­—ï¼Œemojiæ›¿æ¢ç­‰ï¼›è¯»å–GPOSè¡¨ï¼Œè°ƒæ•´å­—å½¢çš„ä½ç½®ï¼Œæ¯”å¦‚ä¸Šä¸‹æ ‡ä½ç½®ã€å­—é—´è·ï¼ˆkerningï¼‰ã€é˜¿æ‹‰ä¼¯æ–‡çš„è¿å†™ç­‰ã€‚&lt;/p&gt;

&lt;h1 id=&quot;å…­æµ‹é‡ä¸æ’ç‰ˆ&quot;&gt;å…­ã€æµ‹é‡ä¸æ’ç‰ˆ&lt;/h1&gt;

&lt;p&gt;è¿™ä¸€æ­¥çš„ç›®æ ‡æ˜¯å°†å­—å½¢åºåˆ—æŒ‰è‡ªå®šä¹‰å¸ƒå±€è§„åˆ™æ’ç‰ˆåˆ°äºŒç»´åæ ‡ç³»ä¸‹ï¼Œç®€å•è®²å°±æ˜¯ç¡®å®šæ¯ä¸ªglyphçš„ä½ç½®ã€å¤§å°ä¿¡æ¯ï¼Œä»¥ä¾›ä¸‹ä¸€æ­¥ç»˜åˆ¶ä½¿ç”¨ã€‚&lt;/p&gt;

&lt;p&gt;å¤§è‡´åˆ†ä¸ºä¸¤æ­¥ï¼š&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;1ï¼‰è·å–å­—å½¢çš„metrics&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;ä»å­—ä½“æ–‡ä»¶çš„hhea/OS_2è¡¨ä¸­è¯»å–å‡ºæ¯ä¸ªglyphçš„ascentã€descentç­‰ä¿¡æ¯ï¼Œç”¨äºç¡®å®šbaselineã€lineHeightç­‰ä¿¡æ¯ã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;2ï¼‰è‡ªå®šä¹‰å¸ƒå±€ç¡®å®šæ¯ä¸ªglyphä½ç½®&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;ä»ä¸Šé¢å¾—åˆ°çš„baselineã€lineHeightç­‰ä¿¡æ¯ï¼Œä»¥åŠç¬¬å…­æ­¥å¾—åˆ°çš„advanceå®½åº¦ï¼ˆglyphå‰è¿›é‡ï¼‰ç­‰ï¼Œå¯ä»¥è®¡ç®—å‡ºæ¯ä¸ªglyphçš„å®½é«˜ã€å¯¹é½åŸºçº¿ï¼Œè¿™æ ·æˆ‘ä»¬å°±èƒ½åƒå‰ç«¯ä¸€æ ·è‡ªå®šä¹‰æ–‡æ¡£æµå¸ƒå±€ï¼ˆInlineã€Inline-Blockã€Blockï¼‰æ¥ç²¾ç¡®çš„æ’ç‰ˆæ¯ä¸ªglyphçš„ä½ç½®ã€‚&lt;/p&gt;

&lt;h1 id=&quot;ä¸ƒæ¸²æŸ“ä¸Šå±&quot;&gt;ä¸ƒã€æ¸²æŸ“ä¸Šå±&lt;/h1&gt;

&lt;p&gt;ç»è¿‡ä¸Šé¢çš„å¡‘å½¢ã€æ’ç‰ˆè¿‡ç¨‹ï¼Œæˆ‘ä»¬å·²ç»èƒ½å¾—åˆ°æŒ‰æ˜¾ç¤ºé¡ºåºæ’åˆ—ä¸”å¸¦æœ‰ç²¾ç¡®ä½ç½®çš„glyphåºåˆ—ï¼Œç»˜åˆ¶é˜¶æ®µå°±æ˜¯å°†è¿™äº›æŠ½è±¡çš„glyphåºåˆ—ä¸Šå±æ˜¾ç¤ºå‡ºæ¥ã€‚&lt;/p&gt;

&lt;p&gt;è¿™ä¸€æ­¥ä¸€èˆ¬æœ‰è½¯å…‰æ …ã€ç¡¬å…‰æ …ç­‰å¤šç§é€‰å‹ï¼Œåœ¨macOS/iOSä¸Šï¼Œå¯ä»¥é€šè¿‡CoreTextæ¥ç»˜åˆ¶å­—å½¢åºåˆ—ï¼Œæ¯”å¦‚ï¼š&lt;a href=&quot;https://developer.apple.com/documentation/coretext/ctfontdrawglyphs(_:_:_:_:_:)&quot;&gt;CTFontDrawGlyphs&lt;/a&gt;ï¼›æœ¬æ–‡ä¸»è¦è®²è§£æ’ç‰ˆå¼•æ“æµç¨‹ï¼Œæ¸²æŸ“éƒ¨åˆ†ä¸å†å±•å¼€ï¼Œåç»­æœ‰æ—¶é—´å†å•ç‹¬å¼€ç¯‡ç ”ç©¶ã€‚&lt;/p&gt;

&lt;h1 id=&quot;æ€»ç»“&quot;&gt;æ€»ç»“&lt;/h1&gt;

&lt;p&gt;è‡³æ­¤ï¼Œæˆ‘ä»¬è‡ªå®šä¹‰æ–‡å­—æ’ç‰ˆå¼•æ“çš„åŸç†ç¯‡å‘Šä¸€æ®µè½ï¼›ç›¸ä¿¡é€šè¿‡ä»¥ä¸Šè®²è§£ï¼Œæˆ‘ä»¬å¯¹æ–‡å­—æ’ç‰ˆçš„æµç¨‹æœ‰äº†ä¸€ä¸ªå¤§è‡´äº†è§£ï¼Œä¸‹ä¸€æ­¥æˆ‘ä»¬å°†ç»“åˆICUã€HarfBuzzç­‰æ¥å®æˆ˜å®ç°ä¸€ä¸ªå°å‹çš„è‡ªå®šä¹‰æ–‡å­—æ’ç‰ˆå¼•æ“ã€‚&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;æ›´å¤šç²¾å½©å†…å®¹ï¼Œæ¬¢è¿å…³æ³¨ğŸŒå…¬ä¼—å·ï¼šéä¸“ä¸šç¨‹åºå‘˜Ping&lt;/p&gt;
&lt;/blockquote&gt;
</description>
        <pubDate>Wed, 01 Oct 2025 00:00:00 +0800</pubDate>
        <link>http://localhost:4000/2025/10/01/%E6%96%87%E5%AD%97%E6%8E%92%E7%89%88%E5%BC%95%E6%93%8E/</link>
        <guid isPermaLink="true">http://localhost:4000/2025/10/01/%E6%96%87%E5%AD%97%E6%8E%92%E7%89%88%E5%BC%95%E6%93%8E/</guid>
        
        <category>è·¨ç«¯æ¸²æŸ“</category>
        
        <category>Font</category>
        
        
      </item>
    
      <item>
        <title>ä¸€æ–‡è¯»æ‡‚Fontæ–‡ä»¶</title>
        <description>&lt;h1 id=&quot;ä¸€å¼•è¨€&quot;&gt;ä¸€ã€å¼•è¨€&lt;/h1&gt;

&lt;blockquote&gt;
  &lt;p&gt;åœ¨å¼€å§‹é˜…è¯»æœ¬æ–‡ä¹‹å‰ï¼Œæ¨èå…ˆé˜…è¯»&lt;a href=&quot;https://mp.weixin.qq.com/s/96YJGYKLoxENC4qT9tYNoQ&quot;&gt;å­—ç¬¦ï¼ˆCharacterï¼‰ã€å­—å½¢ï¼ˆGlyphï¼‰ã€å­—ä½“çš„åŒºåˆ«&lt;/a&gt;ç†è§£åŸºæœ¬æ¦‚å¿µã€‚&lt;/p&gt;

  &lt;p&gt;å¦‚æœä½ å¯¹å­—ç¬¦ä¸Unicodeçš„ç›¸å…³æ¦‚å¿µè¿˜ä¸ç†è§£ï¼Œæ¨èé˜…è¯»&lt;a href=&quot;https://mp.weixin.qq.com/s/EYPO3sSjtIstD3RmlRCs9w&quot;&gt;å­—ç¬¦ä¸ç¼–ç &lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;å‰æ–‡ï¼Œæˆ‘ä»¬ä»‹ç»äº†&lt;a href=&quot;https://mp.weixin.qq.com/s/96YJGYKLoxENC4qT9tYNoQ&quot;&gt;å­—ç¬¦ï¼ˆCharacterï¼‰ã€å­—å½¢ï¼ˆGlyphï¼‰ã€å­—ä½“çš„åŒºåˆ«&lt;/a&gt;ï¼Œè¿™é‡Œæˆ‘ä»¬å†æ¥å®é™…åˆ†æä¸€ä¸ªå­—ä½“æ–‡ä»¶ä¸­åˆ°åº•æœ‰ä»€ä¹ˆï¼Œè¿™æœ‰åˆ©äºæˆ‘ä»¬åç»­ç†è§£æ–‡å­—æ’ç‰ˆå¼•æ“çš„å·¥ä½œåŸç†å’Œæµç¨‹ã€‚&lt;/p&gt;

&lt;p&gt;macOSä¸Šç³»ç»Ÿå­—ä½“è·¯å¾„ä¸€èˆ¬ä¸º&lt;code class=&quot;highlighter-rouge&quot;&gt;/System/Library/Fonts/&lt;/code&gt;ï¼Œå¯ä»¥çœ‹åˆ°æœ‰æ–‡ä»¶åç¼€æœ‰&lt;code class=&quot;highlighter-rouge&quot;&gt;ttc&lt;/code&gt;å’Œ&lt;code class=&quot;highlighter-rouge&quot;&gt;ttf&lt;/code&gt;ï¼ŒäºŒè€…æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿ&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;1ï¼‰&lt;code class=&quot;highlighter-rouge&quot;&gt;.ttf&lt;/code&gt; (TrueType Font)&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;ttf&lt;/code&gt;è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªå•å­—ä½“æ–‡ä»¶ï¼Œæ¯ä¸ª &lt;code class=&quot;highlighter-rouge&quot;&gt;.ttf&lt;/code&gt; æ–‡ä»¶é€šå¸¸åªå¯¹åº”ä¸€ä¸ªå­—ä½“æ ·å¼ï¼ˆä¾‹å¦‚ &lt;em&gt;Microsoft YaHei Regular&lt;/em&gt;ï¼‰&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;2ï¼‰&lt;code class=&quot;highlighter-rouge&quot;&gt;.ttc&lt;/code&gt; (TrueType Collection)&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;ttc&lt;/code&gt;è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªå­—ä½“é›†åˆæ–‡ä»¶ï¼Œå†…éƒ¨å¯ä»¥åŒ…å«å¤šä¸ª TrueType å­—ä½“ï¼ˆå¤šä¸ª &lt;code class=&quot;highlighter-rouge&quot;&gt;.ttf&lt;/code&gt; æ‰“åŒ…åœ¨ä¸€èµ·ï¼‰ï¼Œè¿™äº›å­—ä½“é€šå¸¸å…±äº«æŸäº›è¡¨ï¼ˆæ¯”å¦‚ glyph è½®å»“ã€cmapï¼‰ï¼Œå‡å°‘å†—ä½™ï¼Œæé«˜å­˜å‚¨æ•ˆç‡ï¼Œå¸¸ç”¨äºä¸€ä¸ª Typeface çš„å¤šä¸ªå˜ä½“ï¼ˆRegular, Bold, Italic, Lightâ€¦ï¼‰&lt;/p&gt;

&lt;p&gt;ä¸Šé¢æåˆ°äº†TrueTypeï¼Œä¸ä¹‹å¯¹åº”çš„è¿˜æœ‰OpenTypeï¼ŒäºŒè€…å…¶å®éƒ½æ˜¯å­—ä½“ç±»å‹æ ‡å‡†ï¼Œç®€å•ç†è§£å°±æ˜¯OpenTypeæ˜¯TrueTypeçš„æ‰©å±•ï¼ŒOpenTypeæ”¯æŒæ›´å¤šçš„ç‰¹æ€§ï¼Œæ¯”å¦‚ï¼šè¿å­—ã€RTLã€ä¸Šä¸‹æ ‡ç­‰ã€‚&lt;/p&gt;

&lt;p&gt;OpenTypeä¸€èˆ¬ä»¥&lt;code class=&quot;highlighter-rouge&quot;&gt;otf&lt;/code&gt;ä¸ºåç¼€ï¼Œä½†ä¹Ÿä¸èƒ½ç®€å•çš„æ ¹æ®æ–‡ä»¶ååç¼€åŒºåˆ†äºŒè€…ï¼Œæ–‡ä»¶æ‰©å±•ååªæ˜¯ä¹ æƒ¯ï¼Œå¹¶ä¸èƒ½å®Œå…¨è¯´æ˜å†…éƒ¨æ ¼å¼ï¼ŒçœŸæ­£çš„åŒºåˆ«è¿˜æ˜¯è¦çœ‹å­—ä½“è¡¨ç»“æ„ï¼Œæ¯”å¦‚OpenTypeæœ‰GSUBã€GPOSã€GDEFç­‰æ‰©å±•è¡¨ã€‚&lt;/p&gt;

&lt;p&gt;ä¸‹é¢ï¼Œæˆ‘ä»¬æ¥çœŸæ­£è§£æä¸€ä¸ªå­—ä½“æ–‡ä»¶ï¼Œçœ‹é‡Œé¢æœ‰ä»€ä¹ˆï¼Œå¯ä»¥é€šè¿‡å¦‚ä¸‹å‘½ä»¤è¡Œå°†å­—ä½“è§£ææˆXMLã€‚&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# å¯¹äºttfæ–‡ä»¶&lt;/span&gt;
ttx NewYork.ttf
&lt;span class=&quot;c&quot;&gt;# ttcæ–‡ä»¶æ˜¯ä¸ªå­—ä½“é›†åˆï¼Œéœ€è¦æ˜ç¡®æŒ‡æ˜è¦æå–å“ªä¸ªindexçš„å­—ä½“&lt;/span&gt;
ttx &lt;span class=&quot;nt&quot;&gt;-y&lt;/span&gt; 0 Times.ttc
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;äºŒfontæ–‡ä»¶è§£æ&quot;&gt;äºŒã€Fontæ–‡ä»¶è§£æ&lt;/h1&gt;

&lt;p&gt;æˆ‘ä»¬ä»¥NewYork.ttfæ–‡ä»¶ä¸ºä¾‹ï¼Œå¦‚ä¸‹æ˜¯NewYork.ttfä¸­çš„è¡¨&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/post/ä¸€æ–‡è¯»æ‡‚Fontæ–‡ä»¶/NewYork-ttf.png&quot; alt=&quot;NewYork-ttf&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;21-glyphorder&quot;&gt;2.1 GlyphOrder&lt;/h2&gt;

&lt;div class=&quot;language-xml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;GlyphOrder&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;GlyphID&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;0&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;.notdef&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;GlyphID&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;.null&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;GlyphID&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;2&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;nonmarkingreturn&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;GlyphID&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;3&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;space&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;GlyphID&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;4&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;A&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
  ...
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/GlyphOrder&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;GlyphOrderå®šä¹‰glyphIDä¸glyphNameçš„æ˜ å°„ã€‚&lt;/p&gt;

&lt;h2 id=&quot;22-head&quot;&gt;2.2 head&lt;/h2&gt;

&lt;p&gt;Font Headerï¼Œå­˜å‚¨ä¸€äº›å…¨å±€ä¿¡æ¯ï¼›å…³æ³¨å‡ ä¸ªå€¼ï¼š&lt;/p&gt;

&lt;div class=&quot;language-xml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;head&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;unitsPerEm&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;2048&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
  ...
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/head&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;1ï¼‰unitsPerEm&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;å­—ä½“è¡¨é‡Œçš„æ•°å€¼ä¸€èˆ¬éƒ½å¾ˆå¤§ï¼ˆè§åæ–‡ï¼‰ï¼Œå…¶å•ä½å¹¶ä¸æ˜¯åƒç´ å€¼ï¼Œè€Œæ˜¯ &lt;code class=&quot;highlighter-rouge&quot;&gt;em unit&lt;/code&gt;ï¼Œ&lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;lt;unitsPerEm value=&quot;2048&quot;/&amp;gt;&lt;/code&gt;è¡¨ç¤º&lt;code class=&quot;highlighter-rouge&quot;&gt;2048 units = 1 em = è®¾è®¡çš„å­—é«˜&lt;/code&gt;ï¼Œæ¯”å¦‚å½“å­—ä½“åœ¨å±å¹•ä¸Šä»¥ 16px æ¸²æŸ“æ—¶ï¼Œ1 em = 16pxï¼Œå…¶ä»–æ•°å€¼å¯æŒ‰æ¯”ä¾‹æ¢ç®—&lt;/p&gt;

&lt;h2 id=&quot;23-hhea&quot;&gt;2.3 hhea&lt;/h2&gt;

&lt;p&gt;Horizontal Typesetting Headerï¼Œæ¨ªå‘æ’ç‰ˆä¿¡æ¯ï¼Œå…³æ³¨å‡ ä¸ªå€¼&lt;/p&gt;

&lt;div class=&quot;language-xml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;hhea&amp;gt;&lt;/span&gt;
	&lt;span class=&quot;c&quot;&gt;&amp;lt;!-- MacOSä¸€èˆ¬ä½¿ç”¨hheaé‡Œçš„ascentã€descentï¼›OS_2è¡¨é‡Œè¿˜æœ‰å‡ ä¸ªascentã€descentï¼Œä¸€èˆ¬åœ¨Windowsæˆ–ä¸“ä¸šè®¾è®¡ä¸Šä½¿ç”¨ --&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;ascent&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1950&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;descent&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;-494&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;lineGap&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;0&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;advanceWidthMax&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;2818&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;minLeftSideBearing&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;-693&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;minRightSideBearing&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;-693&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
  ...
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/hhea&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;1ï¼‰ascent &amp;amp; descent&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;å‡è®¾å­—ä½“å¤§å°16ï¼ŒunitsPerEmå¦‚ä¸Šä¸º2048ï¼Œåˆ™æŒ‰æ¯”ä¾‹æ¢ç®—ï¼š&lt;code class=&quot;highlighter-rouge&quot;&gt;ascent = 1950/2048 * 16 â‰ˆ 15.2&lt;/code&gt;ï¼Œ&lt;code class=&quot;highlighter-rouge&quot;&gt;descent â‰ˆ 494/2048 * 16 â‰ˆ 3.8&lt;/code&gt;ã€‚&lt;/p&gt;

&lt;p&gt;éœ€è¦æ³¨æ„ï¼ŒOS_2è¡¨ä¸­ä¹Ÿæœ‰ascentã€descentçš„å®šä¹‰ï¼Œè¿™æ˜¯å› ä¸ºä¸åŒå¹³å°ä¼šè¯»å–ä¸åŒè¡¨ä¸­çš„ascentã€descentï¼Œæ¯”å¦‚macOSã€iOSä¸€èˆ¬ä½¿ç”¨hheaä¸­çš„å€¼ï¼ŒWindowsä¸€èˆ¬ä½¿ç”¨OS_2è¡¨ä¸­çš„usWinAscentã€usWinDescentï¼Œä¸“ä¸šæ’ç‰ˆè½¯ä»¶ï¼ˆå¦‚InDesignï¼‰ä¸€èˆ¬ç”¨OS_2è¡¨ä¸­çš„sTypoAscenderã€sTypoDescenderã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Qï¼šå¯¹äºåŒä¸€ä¸ªFontï¼Œascentã€descentçš„å€¼æ˜¯å›ºå®šçš„å—ï¼Ÿ&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;è¿™ä¸ªé—®é¢˜çš„ç­”æ¡ˆéœ€è¦åŠ å®šè¯­ï¼Œå¯¹äºåŒä¸€ä¸ªFontï¼Œåœ¨åŒä¸€ä¸ªå¹³å°ä¸Šï¼Œascentã€descentæ˜¯å›ºå®šçš„ã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Qï¼šä¸ºä»€ä¹ˆdescentå€¼æ˜¯è´Ÿæ•°ï¼Ÿ&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;å¯ä»¥ç†è§£æˆè§„èŒƒï¼ŒTrueType/OpenTypeçš„è§„èŒƒé‡Œï¼Œdescentæ˜¯è´Ÿæ•°ï¼Œè¡¨ç¤ºåŸºçº¿ï¼ˆbaselineï¼‰ä»¥ä¸‹å»¶ä¼¸çš„é«˜åº¦ã€‚&lt;/p&gt;

&lt;h2 id=&quot;24-maxp&quot;&gt;2.4 maxp&lt;/h2&gt;

&lt;div class=&quot;language-xml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;maxp&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;numGlyphs&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1811&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
  ...
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/maxp&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;å®šä¹‰å­—ä½“é‡Œ glyph çš„æ•°é‡ï¼Œä»¥åŠä¸€äº›æœ€å¤§å€¼å‚æ•°ã€‚&lt;/p&gt;

&lt;h2 id=&quot;25-os_2&quot;&gt;2.5 OS_2&lt;/h2&gt;

&lt;div class=&quot;language-xml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;OS_2&amp;gt;&lt;/span&gt;
	&lt;span class=&quot;c&quot;&gt;&amp;lt;!-- ä¸‹æ ‡çš„å¤§å°å’Œåç§» --&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;ySubscriptXSize&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;650&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;ySubscriptYSize&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;600&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;ySubscriptXOffset&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;0&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;ySubscriptYOffset&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;75&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
  
  &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- ä¸Šæ ‡çš„å¤§å°å’Œåç§» --&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;ySuperscriptXSize&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;650&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;ySuperscriptYSize&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;600&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;ySuperscriptXOffset&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;0&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;ySuperscriptYOffset&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;350&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;

  &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- åˆ é™¤çº¿çš„ç²—ç»†å’Œå‚ç›´ä½ç½® --&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;yStrikeoutSize&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;12&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;yStrikeoutPosition&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;620&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;

  &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- 
  ulUnicodeRangeè¡¨ç¤ºå­—ä½“æ”¯æŒçš„UnicodeèŒƒå›´ï¼Œç”¨ulUnicodeRange1 â€¦ ulUnicodeRange4 è¿™ 4 ä¸ª 32 ä½å­—æ®µæ¥è¡¨ç¤ºï¼Œæ€»å…± 128 ä¸ª bitï¼Œå¯¹åº” 128 ä¸ª Unicode Blockï¼Œå¦‚æœæŸ bit = 1ï¼Œè¡¨ç¤ºå­—ä½“æ”¯æŒè¯¥åŒºå—ä¸­çš„è‡³å°‘ä¸€äº›å­—ç¬¦ï¼Œ
  æ˜ å°„è¡¨è§ï¼šhttps://learn.microsoft.com/en-us/typography/opentype/spec/os2#ur
  --&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;ulUnicodeRange1&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;10100001 00000000 00000010 11111111&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;ulUnicodeRange2&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;00000010 00000000 00100000 01011110&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;ulUnicodeRange3&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;00000000 00000000 00000000 00000000&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;ulUnicodeRange4&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;00000000 00000000 00000000 00000000&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;

  &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- ä¸“ä¸šæ’ç‰ˆï¼ˆæ¯”å¦‚ InDesignï¼‰ä¸€èˆ¬ä½¿ç”¨sTypoAscenderã€sTypoDescender --&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;sTypoAscender&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1950&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;sTypoDescender&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;-494&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;sTypoLineGap&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;0&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;

  &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- Windowsä¸€èˆ¬ä½¿ç”¨sTypoAscenderã€sTypoDescender --&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;usWinAscent&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1950&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;usWinDescent&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;494&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
  ...
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/OS_2&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;å‚è§&lt;a href=&quot;https://developer.apple.com/fonts/TrueType-Reference-Manual/RM06/Chap6OS2.html&quot;&gt;Appleæ–‡æ¡£&lt;/a&gt;ï¼Œå…³æ³¨å‡ ä¸ªå€¼ï¼š&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;1ï¼‰ySubscriptXSize &amp;amp; ySubscriptYSize &amp;amp; ySubscriptXOffset &amp;amp; ySubscriptYOffset&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;ä¸‹æ ‡çš„å¤§å°å’Œåç§»&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;2ï¼‰ySuperscriptXSize &amp;amp; ySuperscriptYSize &amp;amp; ySuperscriptXOffset &amp;amp; ySuperscriptYOffset&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;ä¸Šæ ‡çš„å¤§å°å’Œåç§»&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;3ï¼‰yStrikeoutSize &amp;amp; yStrikeoutPosition&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;åˆ é™¤çº¿çš„ç²—ç»†å’Œå‚ç›´ä½ç½®&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;4ï¼‰ulUnicodeRange1 &amp;amp; ulUnicodeRange2 &amp;amp; ulUnicodeRange3 &amp;amp; ulUnicodeRange4&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;ulUnicodeRangeè¡¨ç¤ºè¯¥å­—ä½“æ”¯æŒçš„UnicodeèŒƒå›´ï¼Œç”¨ulUnicodeRange1 â€¦ ulUnicodeRange4 è¿™ 4 ä¸ª 32 ä½å­—æ®µæ¥è¡¨ç¤ºï¼Œæ€»å…± 128 ä¸ª bitï¼Œå¯¹åº” 128 ä¸ª Unicode Blockï¼Œå¦‚æœæŸ bit = 1ï¼Œè¡¨ç¤ºå­—ä½“æ”¯æŒè¯¥åŒºå—ä¸­çš„è‡³å°‘ä¸€äº›å­—ç¬¦ï¼Œæ˜ å°„è¡¨è§ï¼šhttps://learn.microsoft.com/en-us/typography/opentype/spec/os2#ur ã€‚&lt;/p&gt;

&lt;p&gt;Windowsç³»ç»Ÿé€šå¸¸ç”¨ ulUnicodeRange æ¥çœ‹ä¸€ä¸ªå­—ä½“æ˜¯å¦æ”¯æŒæŸUnicodeï¼›macOS/iOSç³»ç»Ÿä¸€èˆ¬ç”¨ cmap è¡¨ï¼ˆç²¾ç¡®çš„å­—ç¬¦æ˜ å°„ï¼‰ï¼ŒulUnicodeRangeåªä½œä¸ºè¾…åŠ©ä¿¡æ¯ï¼›æµè§ˆå™¨æ’ç‰ˆä¸€èˆ¬ç›´æ¥æŸ¥ cmapï¼Œä½† ulUnicodeRange æœ‰æ—¶ä¹Ÿç”¨äºå­—ä½“ fallback ç­–ç•¥ã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;5ï¼‰sTypoAscender &amp;amp; sTypoDescender &amp;amp; usWinAscent &amp;amp; usWinDescent&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;å¦‚å‰æ–‡æ‰€è¿°ï¼Œä¸åŒç³»ç»Ÿä¼šå–ä¸åŒçš„å€¼ä½œä¸ºascentã€descent&lt;/p&gt;

&lt;h2 id=&quot;26-hmtx&quot;&gt;2.6 hmtx&lt;/h2&gt;

&lt;div class=&quot;language-xml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;hmtx&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;mtx&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;.notdef&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;width=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;2048&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;lsb=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;199&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;mtx&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;.null&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;width=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;0&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;lsb=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;0&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;mtx&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;A&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;width=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1244&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;lsb=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;-16&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
  ...
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/hmtx&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Horizontal Metricsï¼Œè®°å½•æ¯ä¸ª glyph çš„ advance width å’Œleft side bearingã€‚&lt;/p&gt;

&lt;p&gt;ç®€å•ç†è§£æ’ç‰ˆå¼•æ“ç»˜åˆ¶å­—å½¢çš„æµç¨‹æ˜¯ï¼šå°†å­—å½¢æ”¾åœ¨å½“å‰ç‚¹ + lsb åç§»ä½ç½®è¿›è¡Œç»˜åˆ¶ï¼Œç”»å®Œåï¼Œå°†å…‰æ ‡å‘å³ç§»åŠ¨ &lt;code class=&quot;highlighter-rouge&quot;&gt;advanceWidth&lt;/code&gt;ï¼Œå‡†å¤‡ç»˜åˆ¶ä¸‹ä¸€ä¸ªå­—å½¢ã€‚&lt;/p&gt;

&lt;h2 id=&quot;27-cmap&quot;&gt;2.7 cmap&lt;/h2&gt;

&lt;div class=&quot;language-xml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;cmap&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;tableVersion&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;version=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;0&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;cmap_format_4&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;platformID=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;0&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;platEncID=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;3&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;language=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;0&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
  	&lt;span class=&quot;c&quot;&gt;&amp;lt;!-- Açš„Unicode code pointæ˜¯0x41 --&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;map&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;code=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;0x41&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;A&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;&lt;span class=&quot;c&quot;&gt;&amp;lt;!-- LATIN CAPITAL LETTER A --&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;map&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;code=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;0x42&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;B&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;&lt;span class=&quot;c&quot;&gt;&amp;lt;!-- LATIN CAPITAL LETTER B --&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;map&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;code=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;0x43&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;C&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;&lt;span class=&quot;c&quot;&gt;&amp;lt;!-- LATIN CAPITAL LETTER C --&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;map&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;code=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;0x44&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;D&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;&lt;span class=&quot;c&quot;&gt;&amp;lt;!-- LATIN CAPITAL LETTER D --&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;map&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;code=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;0x45&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;E&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;&lt;span class=&quot;c&quot;&gt;&amp;lt;!-- LATIN CAPITAL LETTER E --&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;map&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;code=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;0x46&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;F&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;&lt;span class=&quot;c&quot;&gt;&amp;lt;!-- LATIN CAPITAL LETTER F --&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;map&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;code=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;0x47&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;G&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;&lt;span class=&quot;c&quot;&gt;&amp;lt;!-- LATIN CAPITAL LETTER G --&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;map&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;code=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;0x48&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;H&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;&lt;span class=&quot;c&quot;&gt;&amp;lt;!-- LATIN CAPITAL LETTER H --&amp;gt;&lt;/span&gt;
    ...
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;/cmap_format_4&amp;gt;&lt;/span&gt;
  ...
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/cmap&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Character to Glyph Mappingï¼Œå®šä¹‰ Unicode code point â†’ glyph ID çš„æ˜ å°„ï¼Œcmapè¡¨ä¸­èƒ½ç²¾ç¡®çš„æŸ¥åˆ°è¯¥Fontæ”¯æŒå“ªäº›Unicodeã€‚&lt;/p&gt;

&lt;h2 id=&quot;28-glyf&quot;&gt;2.8 glyf&lt;/h2&gt;

&lt;div class=&quot;language-xml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;glyf&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;TTGlyph&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;A&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;xMin=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;-16&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;yMin=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;0&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;xMax=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1260&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;yMax=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1444&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;contour&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;pt&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;x=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1086&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;y=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;213&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;on=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;pt&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;x=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1113&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;y=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;137&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;on=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;0&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;pt&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;x=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1161&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;y=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;50&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;on=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;0&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;pt&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;x=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1219&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;y=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;9&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;on=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;0&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;pt&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;x=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1260&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;y=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;on=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;pt&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;x=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1260&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;y=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;0&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;on=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;pt&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;x=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;793&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;y=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;0&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;on=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;pt&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;x=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;793&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;y=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;on=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;pt&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;x=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;845&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;y=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;7&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;on=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;0&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;pt&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;x=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;897&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;y=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;54&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;on=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;0&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;pt&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;x=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;899&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;y=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;143&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;on=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;0&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;pt&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;x=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;874&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;y=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;213&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;on=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;pt&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;x=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;528&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;y=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1200&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;on=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;pt&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;x=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;528&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;y=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1200&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;on=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;pt&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;x=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;220&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;y=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;292&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;on=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;pt&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;x=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;184&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;y=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;186&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;on=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;0&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;pt&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;x=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;170&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;y=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;66&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;on=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;0&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;pt&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;x=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;224&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;y=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;11&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;on=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;0&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;pt&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;x=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;290&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;y=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;on=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;pt&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;x=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;290&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;y=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;0&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;on=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;pt&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;x=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;-16&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;y=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;0&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;on=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;pt&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;x=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;-16&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;y=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;on=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;pt&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;x=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;27&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;y=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;9&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;on=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;0&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;pt&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;x=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;89&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;y=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;59&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;on=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;0&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;pt&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;x=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;151&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;y=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;181&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;on=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;0&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;pt&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;x=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;193&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;y=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;297&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;on=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;pt&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;x=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;614&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;y=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1444&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;on=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;pt&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;x=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;648&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;y=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1444&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;on=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/contour&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;contour&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;pt&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;x=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;290&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;y=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;532&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;on=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;pt&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;x=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;294&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;y=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;544&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;on=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;pt&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;x=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;859&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;y=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;544&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;on=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;pt&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;x=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;860&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;y=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;532&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;on=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/contour&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;instructions/&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;/TTGlyph&amp;gt;&lt;/span&gt;
  ...
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/glyf&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Glyph Dataï¼ŒçœŸæ­£çš„å­—å½¢è½®å»“ï¼ˆçŸ¢é‡ç‚¹ã€è½®å»“ã€æ§åˆ¶ç‚¹ï¼‰ï¼›cmap è¡¨è´Ÿè´£æŠŠ Unicode å­—ç¬¦æ˜ å°„åˆ° glyphIDï¼Œè€Œ glyf è¡¨å‘Šè¯‰æ¸²æŸ“ç³»ç»Ÿè¯¥ glyph çš„å…·ä½“å½¢çŠ¶ã€‚&lt;/p&gt;

&lt;h2 id=&quot;29-name&quot;&gt;2.9 name&lt;/h2&gt;

&lt;div class=&quot;language-xml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;name&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;namerecord&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;nameID=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;0&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;platformID=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;3&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;platEncID=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;langID=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;0x409&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
    Â© 2017-2024 Apple Inc. All rights reserved.
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;/namerecord&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;namerecord&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;nameID=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;platformID=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;3&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;platEncID=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;langID=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;0x409&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
    .New York
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;/namerecord&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;namerecord&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;nameID=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;2&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;platformID=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;3&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;platEncID=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;langID=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;0x409&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
    Regular
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;/namerecord&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;namerecord&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;nameID=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;3&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;platformID=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;3&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;platEncID=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;langID=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;0x409&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
    .New York; 20.0d1e1; 2024-05-06
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;/namerecord&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;namerecord&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;nameID=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;4&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;platformID=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;3&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;platEncID=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;langID=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;0x409&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
    .New York
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;/namerecord&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;namerecord&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;nameID=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;5&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;platformID=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;3&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;platEncID=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;langID=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;0x409&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
    20.0d1e1
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;/namerecord&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;namerecord&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;nameID=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;6&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;platformID=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;3&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;platEncID=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;langID=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;0x409&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
    .NewYork-Regular
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;/namerecord&amp;gt;&lt;/span&gt;
  ...
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/name&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;nameè¡¨ä¸­å®šä¹‰çš„æ˜¯å­—ä½“åç§°ã€å­—ä½“å®¶æ—ã€PostScript Nameã€å‚å•†ä¿¡æ¯ç­‰ã€‚&lt;/p&gt;

&lt;p&gt;nameIDå¯¹åº”çš„å«ä¹‰å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;nameID&lt;/th&gt;
      &lt;th&gt;å«ä¹‰&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;Copyright notice&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;Font Family nameï¼ˆå­—ä½“å®¶æ—åï¼Œæ¯”å¦‚ &lt;em&gt;New York&lt;/em&gt;ï¼‰&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;Font Subfamily nameï¼ˆå­—é‡/æ ·å¼ï¼Œæ¯”å¦‚ &lt;em&gt;Regular&lt;/em&gt;ã€&lt;em&gt;Bold&lt;/em&gt;ï¼‰&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;3&lt;/td&gt;
      &lt;td&gt;Unique font identifierï¼ˆå”¯ä¸€IDï¼Œé€šå¸¸åŒ…å«å‚å•†å+ç‰ˆæœ¬å·ï¼‰&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;Full font nameï¼ˆfamily + subfamilyï¼Œæ¯”å¦‚ &lt;em&gt;New York Regular&lt;/em&gt;ï¼‰&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;5&lt;/td&gt;
      &lt;td&gt;Version string&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;6&lt;/td&gt;
      &lt;td&gt;PostScript nameï¼ˆå”¯ä¸€çš„ã€æ— ç©ºæ ¼çš„åå­—ï¼‰&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;â€¦&lt;/td&gt;
      &lt;td&gt;â€¦&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;è¿™é‡Œéœ€è¦é‡ç‚¹ä»‹ç»ä¸‹PostScript Nameï¼šPostScript Nameæ˜¯å­—ä½“åœ¨ä¸€ä¸ªç³»ç»Ÿé‡Œçš„&lt;strong&gt;å”¯ä¸€æ ‡è¯†&lt;/strong&gt;ï¼Œæ˜¯å•ä¸ªå­—ç¬¦ä¸²ï¼Œä¸å…è®¸æœ‰ç©ºæ ¼ï¼Œä¸€èˆ¬æ˜¯ FamilyName-StyleName å½¢å¼ï¼Œæ¯”å¦‚ï¼š&lt;code class=&quot;highlighter-rouge&quot;&gt;.NewYork-Regular&lt;/code&gt;ï¼Œ&lt;code class=&quot;highlighter-rouge&quot;&gt;Helvetica-Bold&lt;/code&gt;ï¼Œ&lt;code class=&quot;highlighter-rouge&quot;&gt;NotoSansCJKsc-Regular&lt;/code&gt;ç­‰ã€‚&lt;/p&gt;

&lt;p&gt;åœ¨CoreTextçš„APIé‡Œï¼Œä¸€èˆ¬éƒ½è¦æ±‚ä¼ PostScript Nameï¼Œæ¯”å¦‚ï¼š&lt;a href=&quot;https://developer.apple.com/documentation/coretext/ctfontcreatewithname(_:_:_:)&quot;&gt;CTFontCreateWithName&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&quot;210-gdef&quot;&gt;2.10 GDEF&lt;/h2&gt;

&lt;p&gt;Glyph Definition Tableï¼Œç®€å•ç†è§£GDEFè¡¨å°±æ˜¯æ˜¯GPOS / GSUBçš„è¾…åŠ©è¡¨ï¼Œæ¯”å¦‚GPOSå’Œ GSUBéœ€è¦çŸ¥é“ã€Œå“ªäº›å­—å½¢æ˜¯ markã€å“ªäº›èƒ½è¿æ¥ã€å“ªäº›æœ‰å˜ä½“ã€ç­‰ä¿¡æ¯ï¼Œè¿™äº›å…ƒæ•°æ®å°±æ˜¯æ”¾åœ¨GDEF è¡¨é‡Œçš„ã€‚&lt;/p&gt;

&lt;h2 id=&quot;211-gpos&quot;&gt;2.11 GPOS&lt;/h2&gt;

&lt;p&gt;Glyph Positioning Tableï¼Œæ§åˆ¶å­—å½¢çš„ç›¸å¯¹ä½ç½®ï¼ˆå¦‚kerningã€ä¸Šä¸‹æ ‡ç­‰ï¼‰ï¼Œæ¯”å¦‚ã€ŒA + Vã€ä¹‹é—´è¦å‡å°‘é—´è·ï¼Œæˆ–è€…éŸ³æ ‡æ”¾åœ¨å…ƒéŸ³æ­£ä¸Šæ–¹ç­‰ã€‚&lt;/p&gt;

&lt;h2 id=&quot;212-gsub&quot;&gt;2.12 GSUB&lt;/h2&gt;

&lt;p&gt;Glyph Substitution Tableï¼Œæ§åˆ¶å­—å½¢æ›¿æ¢ï¼ˆè¿å­—ã€ã€é˜¿æ‹‰ä¼¯æ–‡å˜ä½“ã€ç›´è§’å¼•å·æ¢å¼¯å¼•å·ç­‰ï¼‰ï¼Œæ¯”å¦‚&lt;code class=&quot;highlighter-rouge&quot;&gt;f&lt;/code&gt; + &lt;code class=&quot;highlighter-rouge&quot;&gt;i&lt;/code&gt; â†’ &lt;code class=&quot;highlighter-rouge&quot;&gt;ï¬&lt;/code&gt;ï¼Œ&lt;code class=&quot;highlighter-rouge&quot;&gt;'quoteleft'&lt;/code&gt; â†’ &lt;code class=&quot;highlighter-rouge&quot;&gt;â€˜&lt;/code&gt;ç­‰ã€‚&lt;/p&gt;

&lt;h2 id=&quot;213-hvar--mvar--avar--fvar--gvar&quot;&gt;2.13 HVAR &amp;amp; MVAR &amp;amp; avar &amp;amp; fvar &amp;amp; gvarâ€¦&lt;/h2&gt;

&lt;p&gt;è¿™å‡ ä¸ªè¡¨æ˜¯ç”¨äºè½¬æ¢å¯å˜å­—ä½“çš„ï¼Œå¯å˜å­—ä½“ä¸åœ¨æœ¬æ–‡èŒƒå›´å†…ï¼Œä¸å†è¯¦è¿°ã€‚&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;æ›´å¤šç²¾å½©å†…å®¹æ¬¢è¿å…³æ³¨ğŸŒå…¬ä¼—å·ï¼šéä¸“ä¸šç¨‹åºå‘˜Ping&lt;/p&gt;
&lt;/blockquote&gt;
</description>
        <pubDate>Wed, 17 Sep 2025 00:00:00 +0800</pubDate>
        <link>http://localhost:4000/2025/09/17/%E4%B8%80%E6%96%87%E8%AF%BB%E6%87%82Font%E6%96%87%E4%BB%B6/</link>
        <guid isPermaLink="true">http://localhost:4000/2025/09/17/%E4%B8%80%E6%96%87%E8%AF%BB%E6%87%82Font%E6%96%87%E4%BB%B6/</guid>
        
        <category>è·¨ç«¯æ¸²æŸ“</category>
        
        <category>Font</category>
        
        
      </item>
    
      <item>
        <title>Typoraæ¿€æ´»</title>
        <description>&lt;p&gt;å‚è€ƒäº†ç½‘ä¸Šå…³äºTyporaçš„æ¿€æ´»æ–¹å¼ï¼Œä¿®æ”¹&lt;code class=&quot;highlighter-rouge&quot;&gt;hasActivated=&quot;true&quot;==e.hasActivated&lt;/code&gt;ä¸º&lt;code class=&quot;highlighter-rouge&quot;&gt;hasActivated=&quot;true&quot;==&quot;true&quot;&lt;/code&gt;ï¼Œåœ¨æ–°ç‰ˆæœ¬ï¼ˆV1.11.7ï¼‰å·²ç»ä¸ç”Ÿæ•ˆï¼Œç ”ç©¶äº†ä¸‹å‘ç°å¦å¤–ä¸€ç§è§„é¿æ–¹å¼ï¼Œæœ¬æ–‡è®°å½•ä¸‹ã€‚&lt;/p&gt;

&lt;p&gt;MacOSä¸Šæ‰¾åˆ°ï¼š&lt;code class=&quot;highlighter-rouge&quot;&gt;/Applications/Typora.app/Contents/Resources/TypeMark/page-dist/static/js/LicenseIndex.180dd4c7.54684560.chunk.js&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/post/Typora/dir.png&quot; alt=&quot;dir&quot; /&gt;&lt;/p&gt;

&lt;p&gt;æ–‡æœ¬ç¼–è¾‘å™¨æ‰“å¼€è¯¥æ–‡ä»¶ï¼Œä¿®æ”¹ &lt;code class=&quot;highlighter-rouge&quot;&gt;quit:function(){window.Setting.invoke(&quot;quit&quot;)}&lt;/code&gt;ä¸­çš„quitä¸ºcloseå³å¯ï¼Œå³ï¼š&lt;code class=&quot;highlighter-rouge&quot;&gt;quit:function(){window.Setting.invoke(&quot;close&quot;)}&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/post/Typora/quit.png&quot; alt=&quot;quit&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ä¿®æ”¹å®Œåä¿å­˜ï¼Œå†æ¬¡æ‰“å¼€Typoraï¼Œç‚¹å‡»é€€å‡ºå°±ä¸ä¼šå†é€€å‡ºåº”ç”¨ç¨‹åºäº†ã€‚&lt;/p&gt;
</description>
        <pubDate>Sun, 14 Sep 2025 00:00:00 +0800</pubDate>
        <link>http://localhost:4000/2025/09/14/Typora%E6%BF%80%E6%B4%BB/</link>
        <guid isPermaLink="true">http://localhost:4000/2025/09/14/Typora%E6%BF%80%E6%B4%BB/</guid>
        
        <category>å…¶ä»–</category>
        
        
      </item>
    
      <item>
        <title>ä¸€æ–‡è¯»æ‡‚å­—ç¬¦ã€å­—å½¢ã€å­—ä½“</title>
        <description>&lt;h1 id=&quot;ä¸€å¼•è¨€&quot;&gt;ä¸€ã€å¼•è¨€&lt;/h1&gt;

&lt;p&gt;ä»€ä¹ˆæ˜¯Characterï¼Ÿä»€ä¹ˆæ˜¯Glyphï¼ŸCharacterå’ŒGlyphæ˜¯å¦ä¸€ä¸€å¯¹åº”ï¼Ÿæˆ‘ä»¬å¸¸è¯´çš„FontåˆåŒ…å«å“ªäº›ä¸œè¥¿ï¼Ÿå¦‚æœè¦è‡ªå·±å®ç°ä¸€å¥—æ–‡æœ¬çš„åˆ†è¯ã€æµ‹é‡å’Œå¸ƒå±€ï¼Œåˆéœ€è¦ç†æ¸…æ¥šå“ªäº›æ¦‚å¿µï¼Ÿascentã€descentã€lineHeightä¹‹é—´çš„å…³ç³»æ˜¯æ€ä¹ˆæ ·çš„ï¼Ÿ&lt;/p&gt;

&lt;p&gt;æœ¬æ–‡å°†å°½é‡ä»¥ç®€æ´æ˜“æ‡‚çš„æ–¹å¼æ¥è§£é‡Šä»¥ä¸Šé—®é¢˜ï¼Œä¹Ÿå¯ä»¥æå‰Markèµ·æ¥ï¼Œä½œä¸ºæ—¥åçš„é€ŸæŸ¥æ‰‹å†Œã€‚&lt;/p&gt;

&lt;h1 id=&quot;äºŒcharacter&quot;&gt;äºŒã€Character&lt;/h1&gt;

&lt;p&gt;Characterä¹Ÿå«å­—ç¬¦ï¼Œæ˜¯ä¸€ä¸ªæŠ½è±¡æ¦‚å¿µï¼Œæ¯”å¦‚å­—æ¯&lt;code class=&quot;highlighter-rouge&quot;&gt;A&lt;/code&gt;ã€ä¸­æ–‡&lt;code class=&quot;highlighter-rouge&quot;&gt;ä½ &lt;/code&gt;ç­‰éƒ½å¯ä»¥è§†ä¸ºä¸€ä¸ªå­—ç¬¦ï¼Œå®ƒåªæ˜¯ä¸€ä¸ªè¯­ä¹‰å•ä½ï¼Œä¸å…³å¿ƒå…·ä½“é•¿ä»€ä¹ˆæ ·ã€‚&lt;/p&gt;

&lt;h1 id=&quot;ä¸‰glpyh&quot;&gt;ä¸‰ã€Glpyh&lt;/h1&gt;

&lt;p&gt;Glpyhä¹Ÿå«å­—å½¢ï¼Œè¡¨ç¤ºå­—ç¬¦çš„ç»˜åˆ¶æ–¹å¼ï¼›ä¸€ä¸ªå­—ç¬¦å¯ä»¥æœ‰å¤šç§æ–¹å¼ç»˜åˆ¶ï¼Œæ¯”å¦‚å­—æ¯Aï¼Œå¯ä»¥æœ‰ä¸åŒçš„å¤§å°ã€ç²—ç»†ã€æ–œä½“ã€è¡¬çº¿ç­‰ï¼Œä½†éƒ½æ˜¯åŒä¸€ä¸ªå­—ç¬¦ï¼›è¿™äº›ä¸åŒçš„ç»˜åˆ¶æ–¹å¼ï¼Œéƒ½å«å­—å½¢ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/post/ä¸€æ–‡è¯»æ‡‚å­—ç¬¦ã€å­—å½¢ã€å­—ä½“/glyph_A.png&quot; alt=&quot;glyph_A&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;31-characterä¸glyphçš„å…³ç³»&quot;&gt;3.1 Characterä¸Glyphçš„å…³ç³»&lt;/h2&gt;

&lt;p&gt;å­—ç¬¦ä¸å­—å½¢å¹¶éä¸€ä¸€å¯¹åº”å…³ç³»ï¼Œä¸€ä¸ªå­—ç¬¦å¯ä»¥ç”±å¤šä¸ªå­—å½¢è¡¨ç¤ºï¼Œæ¯”å¦‚&lt;code class=&quot;highlighter-rouge&quot;&gt;Ã©&lt;/code&gt;å¯ä»¥æ˜¯&lt;code class=&quot;highlighter-rouge&quot;&gt;e&lt;/code&gt;å’Œé‡éŸ³ç¬¦å·&lt;code class=&quot;highlighter-rouge&quot;&gt;Â´&lt;/code&gt;çš„ç»„åˆï¼Œåœ¨ä¸€äº›è¿å­—æƒ…å†µä¸‹ï¼Œä¸€ä¸ªå­—å½¢ä¹Ÿå¯ä»¥ä»£è¡¨å¤šä¸ªå­—ç¬¦ï¼Œå¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/post/ä¸€æ–‡è¯»æ‡‚å­—ç¬¦ã€å­—å½¢ã€å­—ä½“/ligatures.png&quot; alt=&quot;ligatures&quot; /&gt;&lt;/p&gt;

&lt;h1 id=&quot;å››font&quot;&gt;å››ã€Font&lt;/h1&gt;

&lt;h2 id=&quot;41-typeface&quot;&gt;4.1 Typeface&lt;/h2&gt;

&lt;p&gt;æŒ‡ä¸€å¥—å…·æœ‰ç»Ÿä¸€è®¾è®¡é£æ ¼çš„Fonté›†åˆï¼Œå®ƒæ˜¯ä¸€ç§è®¾è®¡æ¦‚å¿µï¼Œè€Œä¸æ˜¯å…·ä½“çš„æ–‡ä»¶&lt;/p&gt;

&lt;h2 id=&quot;42-font&quot;&gt;4.2 Font&lt;/h2&gt;

&lt;p&gt;Fontå¯ä»¥ç†è§£æˆTypefaceçš„æŸä¸ªå…·ä½“å®ç°ã€‚&lt;/p&gt;

&lt;p&gt;ä»¥Helveticaä¸ºä¾‹ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Typefaceï¼šHelvetica&lt;/li&gt;
  &lt;li&gt;Fontï¼š
    &lt;ul&gt;
      &lt;li&gt;Helvetica Regular.ttf&lt;/li&gt;
      &lt;li&gt;Helvetica Bold.ttf&lt;/li&gt;
      &lt;li&gt;Helvetica Italic.ttf&lt;/li&gt;
      &lt;li&gt;Helvetica Bold Italic.ttf&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;43-font-family&quot;&gt;4.3 Font Family&lt;/h2&gt;

&lt;p&gt;Font Familyæ˜¯ä¸€ç»„å±äºåŒä¸€ä¸ªTypefaceçš„å­—ä½“ï¼ˆFontsï¼‰ï¼Œå®ƒä»¬å…±äº«è®¾è®¡é£æ ¼ï¼Œåªæ˜¯å­—é‡/å®½åº¦/æ ·å¼ä¸åŒã€‚&lt;/p&gt;

&lt;p&gt;æ¯”å¦‚ï¼šHelveticaæ˜¯ä¸€ä¸ªFont Familyï¼Œé‡Œé¢åŒ…å«å­—ä½“ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Helvetica Regular&lt;/li&gt;
  &lt;li&gt;Helvetica Bold&lt;/li&gt;
  &lt;li&gt;Helvetica Italic&lt;/li&gt;
  &lt;li&gt;Helvetica Bold Italic&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;44-font-descriptor&quot;&gt;4.4 Font Descriptor&lt;/h2&gt;

&lt;p&gt;Font Descriptorï¼ˆå­—ä½“æè¿°ç¬¦ï¼‰æ˜¯ä¸€ç§å±æ€§é›†åˆï¼ˆFont Familyã€Font Weightã€æ ·å¼ (italic/oblique)ã€å¤§å°ç­‰ï¼‰ï¼Œç”¨æ¥æè¿°æˆ–æŸ¥è¯¢ä¸€ä¸ªå­—ä½“ï¼›å®ƒä¸æ˜¯å­—ä½“æ–‡ä»¶ï¼Œè€Œæ˜¯ä¸€ä¸ªâ€œè¿‡æ»¤æ¡ä»¶â€æˆ–â€œé…ç½®å¯¹è±¡â€ï¼Œåœ¨ CoreText é‡Œå¯¹åº” &lt;code class=&quot;highlighter-rouge&quot;&gt;CTFontDescriptor&lt;/code&gt;ã€‚&lt;/p&gt;

&lt;p&gt;Font Descriptorå¯ä»¥ç”¨äºåŒ¹é…ç³»ç»Ÿä¸­ç¬¦åˆæ¡ä»¶çš„å­—ä½“ï¼Œä¹Ÿå¯ä»¥ç”¨å®ƒæ¥æ´¾ç”Ÿä¸€ä¸ªå…·ä½“çš„CTFontï¼Œå¦‚ï¼š&lt;/p&gt;

&lt;div class=&quot;language-swift highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// è¿™é‡Œçš„ descriptor åªæ˜¯æè¿°æ¡ä»¶ï¼ŒçœŸæ­£çš„å­—ä½“å¯¹è±¡æ˜¯ font&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;descriptor&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;CTFontDescriptorCreateWithAttributes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;kCTFontFamilyNameAttribute&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;Microsoft YaHei&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;kCTFontWeightTrait&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.8&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;font&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;CTFontCreateWithFontDescriptor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;descriptor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;14&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;nil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;45-font-collections&quot;&gt;4.5 Font Collections&lt;/h2&gt;

&lt;p&gt;Font Collectionsæ˜¯ä¸€ç»„å­—ä½“çš„é›†åˆï¼Œé€šå¸¸ç”¨äºæ£€ç´¢å’Œç­›é€‰ï¼Œåœ¨ CoreText é‡Œå¯¹åº”CTFontCollectionã€‚&lt;/p&gt;

&lt;p&gt;å®ƒå¯ä»¥åŒ…å«ç³»ç»Ÿä¸­æ‰€æœ‰å¯ç”¨å­—ä½“ï¼Œä¹Ÿå¯ä»¥æŒ‰æ¡ä»¶è¿‡æ»¤å‡ºå­é›†ï¼Œä¸»è¦ç”¨é€”æœ‰ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;æšä¸¾ç³»ç»Ÿå®‰è£…çš„å­—ä½“&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;æ ¹æ® &lt;code class=&quot;highlighter-rouge&quot;&gt;Font Descriptor&lt;/code&gt; æ‰¾åˆ°æ‰€æœ‰åŒ¹é…çš„å­—ä½“&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;åšå­—ä½“é€‰æ‹©å™¨ UIï¼ˆæ¯”å¦‚ Word é‡Œçš„å­—ä½“ä¸‹æ‹‰æ¡†ï¼‰&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;46-å°ç»“&quot;&gt;4.6 å°ç»“&lt;/h2&gt;

&lt;p&gt;&lt;img src=&quot;/img/post/ä¸€æ–‡è¯»æ‡‚å­—ç¬¦ã€å­—å½¢ã€å­—ä½“/Font.png&quot; alt=&quot;Font&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;47-glyphä¸fontçš„å…³ç³»&quot;&gt;4.7 Glyphä¸Fontçš„å…³ç³»&lt;/h2&gt;

&lt;p&gt;ç®€å•ç†è§£ï¼ŒFonté‡Œå­˜å‚¨äº†Glyphçš„ç»˜åˆ¶æ ·å¼ï¼ŒGlyphä¸Unicodeçš„æ˜ å°„å…³ç³»ç­‰ã€‚&lt;/p&gt;

&lt;p&gt;Fonté‡Œæœ‰å„ç§å„æ ·çš„è¡¨ï¼Œå­˜å‚¨äº†Unicode code pointä¸GlyphIDçš„æ˜ å°„å…³ç³»ï¼Œæ¯ä¸ªGlyphç»˜åˆ¶æ—¶çš„advance width å’Œleft side bearingç­‰ï¼Œåç»­ä¼šæœ‰å•ç‹¬çš„æ–‡ç« è¯¦ç»†è§£æFontæ–‡ä»¶å†…å®¹ï¼Œè¿™é‡Œå…ˆç†è§£äºŒè€…çš„æ¦‚å¿µã€‚&lt;/p&gt;

&lt;h1 id=&quot;äº”æ–‡å­—æ’ç‰ˆçš„åŸºæœ¬æ¦‚å¿µ&quot;&gt;äº”ã€æ–‡å­—æ’ç‰ˆçš„åŸºæœ¬æ¦‚å¿µ&lt;/h1&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;åŸºæœ¬æ¦‚å¿µ&lt;/th&gt;
      &lt;th&gt;è§£é‡Š&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;metrics&lt;/td&gt;
      &lt;td&gt;ç”±å­—ä½“è®¾è®¡å¸ˆæä¾›ï¼Œç”¨äºæè¿°æ¯ä¸ªGlyphå‘¨å›´çš„é—´è·&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;advance width&lt;/td&gt;
      &lt;td&gt;å‰è¿›å®½åº¦ï¼ŒåŸºçº¿æ–¹å‘åˆ°ä¸‹ä¸€ä¸ªGlyph originçš„è·ç¦»ï¼Œæˆ–è€…ç†è§£ä¸ºå­—å½¢ç»˜åˆ¶å®Œåï¼Œå…‰æ ‡åº”è¯¥å‰è¿›å¤šå°‘è·ç¦»&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;left-side bearing&lt;/td&gt;
      &lt;td&gt;Glyph originä¸Glyphå·¦ä¾§çš„é—´è·&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;right-side bearing&lt;/td&gt;
      &lt;td&gt;Glyphå³ä¾§ä¸advance widthç»ˆç‚¹çš„è·ç¦»&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;ascent&lt;/td&gt;
      &lt;td&gt;Glyph originåˆ°Fontä¸­æœ€é«˜Glyphçš„é¡¶éƒ¨è·ç¦»&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;descent&lt;/td&gt;
      &lt;td&gt;Glyph originåˆ°Fontä¸­æœ€ä½Glyphçš„åº•éƒ¨è·ç¦»&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;bounding box&lt;br /&gt;bounding rectangle&lt;/td&gt;
      &lt;td&gt;åŒ…å«Glyphå¯è§†åŒºåŸŸï¼ˆæ³¨æ„éadvance widthï¼‰æœ€å°rect&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;kerning&lt;/td&gt;
      &lt;td&gt;é€šå¸¸ï¼ŒGlyphä¸€èˆ¬æŒ‰advance widthæ’åˆ—ï¼Œä½†ä¸ºäº†æé«˜å¯è¯»æ€§ï¼Œé€šå¸¸ä¼šå¼•å…¥kerningæ¥æ‰©å¤§æˆ–ç¼©å°ä¸¤ä¸ªglyphä¹‹é—´çš„é—´è·ï¼Œæ¯”å¦‚Wå’ŒAï¼š&lt;br /&gt;&lt;img src=&quot;/img/post/ä¸€æ–‡è¯»æ‡‚å­—ç¬¦ã€å­—å½¢ã€å­—ä½“/kerning.png&quot; alt=&quot;kerning&quot; /&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;leading/linegap&lt;/td&gt;
      &lt;td&gt;lineä¹‹é—´çš„æ·»åŠ çš„è·ç¦»&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;lineHeight&lt;/td&gt;
      &lt;td&gt;lineHeight = ascent + descent + leading&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;ä¸€å›¾èƒœè¿‡åƒè¨€ï¼Œè´´ä¸¤å¼ ç»å…¸çš„å›¾ï¼š&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;å›¾ä¸€&lt;/th&gt;
      &lt;th&gt;å›¾äºŒ&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;img src=&quot;/img/post/ä¸€æ–‡è¯»æ‡‚å­—ç¬¦ã€å­—å½¢ã€å­—ä½“/glyph_1.png&quot; alt=&quot;glyph_1&quot; /&gt;&lt;/td&gt;
      &lt;td&gt;&lt;img src=&quot;/img/post/ä¸€æ–‡è¯»æ‡‚å­—ç¬¦ã€å­—å½¢ã€å­—ä½“/glyph_2.png&quot; alt=&quot;glyph_2&quot; /&gt;&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;blockquote&gt;
  &lt;p&gt;æ›´å¤šç²¾å½©å†…å®¹æ¬¢è¿å…³æ³¨ğŸŒå…¬ä¼—å·ï¼šéä¸“ä¸šç¨‹åºå‘˜Ping&lt;/p&gt;
&lt;/blockquote&gt;
</description>
        <pubDate>Sat, 13 Sep 2025 00:00:00 +0800</pubDate>
        <link>http://localhost:4000/2025/09/13/%E4%B8%80%E6%96%87%E8%AF%BB%E6%87%82%E5%AD%97%E7%AC%A6-%E5%AD%97%E5%BD%A2-%E5%AD%97%E4%BD%93/</link>
        <guid isPermaLink="true">http://localhost:4000/2025/09/13/%E4%B8%80%E6%96%87%E8%AF%BB%E6%87%82%E5%AD%97%E7%AC%A6-%E5%AD%97%E5%BD%A2-%E5%AD%97%E4%BD%93/</guid>
        
        <category>è·¨ç«¯æ¸²æŸ“</category>
        
        <category>Font</category>
        
        
      </item>
    
      <item>
        <title>ç¬¬ä¸€ä¸ªFlutteråº”ç”¨</title>
        <description>&lt;h1 id=&quot;ä¸€ç¯å¢ƒæ­å»º&quot;&gt;ä¸€ã€ç¯å¢ƒæ­å»º&lt;/h1&gt;

&lt;p&gt;æ·»åŠ Flutteré•œåƒï¼š&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;export &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;PUB_HOSTED_URL&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;https://pub.flutter-io.cn
&lt;span class=&quot;nb&quot;&gt;export &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;FLUTTER_STORAGE_BASE_URL&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;https://storage.flutter-io.cn
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ä¸‹è½½Flutter SDKï¼šhttps://docs.flutter.cn/install/archive&lt;/p&gt;

&lt;p&gt;æ·»åŠ Flutter SDKç¯å¢ƒå˜é‡ï¼š&lt;code class=&quot;highlighter-rouge&quot;&gt;export PATH=&quot;$PWD/flutter/bin:$PATH&quot;&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;è¿è¡Œ&lt;code class=&quot;highlighter-rouge&quot;&gt;flutter doctor&lt;/code&gt;éªŒè¯å®‰è£…æ˜¯å¦æˆåŠŸï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/post/Flutter/Flutter Doctor.png&quot; alt=&quot;Flutter Doctor&quot; /&gt;&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;æˆ‘ä½¿ç”¨çš„æ˜¯iOSå¼€å‘ç¯å¢ƒï¼Œæ²¡è£…Androidç¯å¢ƒï¼Œä¹ŸOK&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h1 id=&quot;äºŒæ„å»ºç¬¬ä¸€ä¸ªflutteråº”ç”¨&quot;&gt;äºŒã€æ„å»ºç¬¬ä¸€ä¸ªFlutteråº”ç”¨&lt;/h1&gt;

&lt;p&gt;VSCodeå®‰è£…flutteræ’ä»¶ï¼Œé€šè¿‡&lt;code class=&quot;highlighter-rouge&quot;&gt;command + shift + p&lt;/code&gt;é€‰æ‹©&lt;code class=&quot;highlighter-rouge&quot;&gt;Flutter: New Project&lt;/code&gt;ï¼Œä¹‹åæŒ‰éœ€é€‰æ‹©&lt;code class=&quot;highlighter-rouge&quot;&gt;Application&lt;/code&gt;ï¼ˆè‡ªå¸¦ä¸€ä¸ªè®¡æ•°å™¨çš„Appï¼‰æˆ–è€…&lt;code class=&quot;highlighter-rouge&quot;&gt;Empty Application&lt;/code&gt;ï¼š&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;New Project&lt;/th&gt;
      &lt;th&gt;Project Template&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;img src=&quot;/img/post/Flutter/New Project.png&quot; alt=&quot;New Project&quot; /&gt;&lt;/td&gt;
      &lt;td&gt;&lt;img src=&quot;/img/post/Flutter/Project Template.png&quot; alt=&quot;Project Template&quot; /&gt;&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;æˆ‘è¿™é‡Œé€‰çš„Applicationï¼Œç‚¹å‡»main.dartä¸‹çš„runï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/post/Flutter/run.png&quot; alt=&quot;run&quot; /&gt;&lt;/p&gt;

&lt;p&gt;å¯ä»¥çœ‹åˆ°è¿è¡Œæ•ˆæœï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/post/Flutter/FlutterDemo.png&quot; alt=&quot;FlutterDemo&quot; /&gt;&lt;/p&gt;
</description>
        <pubDate>Sun, 31 Aug 2025 00:00:00 +0800</pubDate>
        <link>http://localhost:4000/2025/08/31/%E7%AC%AC%E4%B8%80%E4%B8%AAFlutter%E5%BA%94%E7%94%A8/</link>
        <guid isPermaLink="true">http://localhost:4000/2025/08/31/%E7%AC%AC%E4%B8%80%E4%B8%AAFlutter%E5%BA%94%E7%94%A8/</guid>
        
        <category>è·¨ç«¯æ¸²æŸ“</category>
        
        <category>Flutter</category>
        
        
      </item>
    
      <item>
        <title>ä¸€æ–‡è¯»æ‡‚å­—ç¬¦ä¸ç¼–ç </title>
        <description>&lt;h1 id=&quot;ä¸€å­—ç¬¦character&quot;&gt;ä¸€ã€å­—ç¬¦/Character&lt;/h1&gt;

&lt;p&gt;å¯¹ç”¨æˆ·å¯è§çš„â€œä¸€ä¸ªå­—ç¬¦â€ï¼Œé€šå¸¸æ˜¯æˆ‘ä»¬åœ¨å±å¹•ä¸Šçœ‹åˆ°çš„ä¸€ä¸ªå­—æ¯ã€æ•°å­—ã€emoji æˆ–ç»„åˆå­—ç¬¦ã€‚&lt;/p&gt;

&lt;p&gt;æ¯”å¦‚ï¼š&lt;code class=&quot;highlighter-rouge&quot;&gt;a&lt;/code&gt;ã€&lt;code class=&quot;highlighter-rouge&quot;&gt;Ã©&lt;/code&gt;ã€&lt;code class=&quot;highlighter-rouge&quot;&gt;ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦&lt;/code&gt;&lt;/p&gt;

&lt;h1 id=&quot;äºŒå­—ç¬¦ç¼–ç æ ‡å‡†å­—ç¬¦é›†&quot;&gt;äºŒã€å­—ç¬¦ç¼–ç æ ‡å‡†/å­—ç¬¦é›†&lt;/h1&gt;

&lt;p&gt;å­—ç¬¦ç¼–ç æ ‡å‡†å®šä¹‰çš„æ˜¯å¦‚ä½•å°†å­—ç¬¦æ˜ å°„åˆ°å”¯ä¸€ç¼–ç ï¼Œå¸¸è§çš„å­—ç¬¦ç¼–ç æ ‡å‡†æ¯”å¦‚&lt;code class=&quot;highlighter-rouge&quot;&gt;ASCII&lt;/code&gt;ã€&lt;code class=&quot;highlighter-rouge&quot;&gt;Unicode&lt;/code&gt;ã€&lt;code class=&quot;highlighter-rouge&quot;&gt;GBK&lt;/code&gt;ç­‰&lt;/p&gt;

&lt;h2 id=&quot;21-ascii&quot;&gt;2.1 ASCII&lt;/h2&gt;

&lt;p&gt;ASCIIï¼ˆ7ä½ï¼‰å®šä¹‰äº† 128 ä¸ªå­—ç¬¦çš„å”¯ä¸€ç¼–ç ï¼ŒåŒ…æ‹¬æ•°å­—0åˆ°9ã€å°å†™å­—æ¯aåˆ°zã€å¤§å†™å­—æ¯Aåˆ°Zä»¥åŠå¸¸ç”¨æ ‡ç‚¹ç¬¦å·ç­‰ã€‚&lt;/p&gt;

&lt;h2 id=&quot;22-unicode&quot;&gt;2.2 Unicode&lt;/h2&gt;

&lt;p&gt;Unicodeåˆå«ä¸‡å›½ç ï¼Œç›®æ ‡æ˜¯ä¸ºæ‰€æœ‰å­—ç¬¦å®šä¹‰å”¯ä¸€ç¼–ç ï¼ˆCode Pointï¼‰ã€‚ä¸ºäº†è§£å†³ASCII/GBKä¸èƒ½å®šä¹‰å…¨éƒ¨å­—ç¬¦çš„é—®é¢˜ã€‚&lt;/p&gt;

&lt;p&gt;æ¯”å¦‚ï¼š&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;a&lt;/code&gt; -&amp;gt; &lt;code class=&quot;highlighter-rouge&quot;&gt;U+0061&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;ğŸ‘¨&lt;/code&gt; -&amp;gt; &lt;code class=&quot;highlighter-rouge&quot;&gt;U+1F468&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;æ³¨æ„&lt;/strong&gt;ï¼š&lt;/p&gt;

&lt;p&gt;Unicodeåªè´Ÿè´£åˆ†é…ç ä½ï¼ˆCode Pointï¼‰ï¼Œå¹¶ä¸å†³å®šå…·ä½“çš„å­˜å‚¨å½¢å¼ã€‚&lt;/p&gt;

&lt;p&gt;Unicodeçš„å‰ 128 ä¸ªç ç‚¹ä¸ASCIIç›¸åŒã€‚&lt;/p&gt;

&lt;h3 id=&quot;221-code-point&quot;&gt;2.2.1 Code Point&lt;/h3&gt;

&lt;p&gt;Code Pointä¹Ÿå«ç ä½ï¼ŒUnicodeä¸­ä¸ºæ¯ä¸ªå­—ç¬¦åˆ†é…çš„å”¯ä¸€ç¼–ç ã€‚&lt;/p&gt;

&lt;p&gt;ä¸€ä¸ªå­—ç¬¦å¯ä»¥å¯¹åº”ä¸€ä¸ªæˆ–å¤šä¸ªCode Pointï¼Œæ¯”å¦‚ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;a&lt;/code&gt;ï¼š&lt;code class=&quot;highlighter-rouge&quot;&gt;U+0061&lt;/code&gt;ï¼Œå¯¹åº” 1 ä¸ªCode Point&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦&lt;/code&gt;ï¼š&lt;code class=&quot;highlighter-rouge&quot;&gt;U+1F468 (ğŸ‘¨) + U+200D (ZWJ) + U+1F469 (ğŸ‘©) + U+200D (ZWJ) + U+1F467 (ğŸ‘§) + U+200D (ZWJ) + U+1F466 (ğŸ‘¦)&lt;/code&gt;å¯¹åº” 7 ä¸ªCode Point&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Ã©&lt;/code&gt;ï¼š&lt;code class=&quot;highlighter-rouge&quot;&gt;U+00E9&lt;/code&gt;æˆ–&lt;code class=&quot;highlighter-rouge&quot;&gt;U+0065 + U+0301&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;blockquote&gt;
  &lt;p&gt;å¤‡æ³¨ï¼š&lt;/p&gt;

  &lt;p&gt;åœ¨Unicodeä¸­ï¼Œ&lt;code class=&quot;highlighter-rouge&quot;&gt;Ã©&lt;/code&gt;å®é™…ä¸Šæœ‰ä¸¤ç§è¡¨ç¤ºæ–¹å¼ï¼š&lt;/p&gt;

  &lt;p&gt;&lt;strong&gt;å•ä¸€å­—ç¬¦è¡¨ç¤ºæ³•&lt;/strong&gt;ï¼šå³ç›´æ¥ä½¿ç”¨&lt;code class=&quot;highlighter-rouge&quot;&gt;U+00E9&lt;/code&gt;è¿™ä¸ªå•ç‹¬çš„Unicodeç ä½è¡¨ç¤º&lt;code class=&quot;highlighter-rouge&quot;&gt;Ã©&lt;/code&gt;ã€‚&lt;/p&gt;

  &lt;p&gt;&lt;strong&gt;ç»„åˆå­—ç¬¦è¡¨ç¤ºæ³•&lt;/strong&gt;ï¼šä½¿ç”¨&lt;code class=&quot;highlighter-rouge&quot;&gt;U+0065&lt;/code&gt;ï¼ˆå­—æ¯&lt;code class=&quot;highlighter-rouge&quot;&gt;e&lt;/code&gt;ï¼‰å’Œ&lt;code class=&quot;highlighter-rouge&quot;&gt;U+0301&lt;/code&gt;ï¼ˆé‡éŸ³ç¬¦å·ï¼‰ä¸¤ä¸ªUnicodeç ä½æ¥è¡¨ç¤ºä¸€ä¸ª&lt;code class=&quot;highlighter-rouge&quot;&gt;Ã©&lt;/code&gt;å­—ç¬¦ã€‚&lt;/p&gt;

  &lt;p&gt;&lt;strong&gt;ä¸ºä»€ä¹ˆä¼šæœ‰è¿™ä¸¤ç§è¡¨ç¤ºæ³•ï¼Ÿ&lt;/strong&gt;&lt;/p&gt;

  &lt;p&gt;&lt;strong&gt;å†å²åŸå› &lt;/strong&gt;ï¼šUnicodeè®¾è®¡æ—¶è€ƒè™‘åˆ°äº†ä¸åŒè¯­è¨€çš„éœ€æ±‚ï¼Œè®¸å¤šè¯­è¨€ï¼ˆå¦‚æ³•è¯­ã€è¥¿ç­ç‰™è¯­ç­‰ï¼‰ä½¿ç”¨å¸¦æœ‰é‡éŸ³ç¬¦å·çš„å­—ç¬¦ï¼Œå› æ­¤ï¼ŒUnicodeåŒæ—¶æ”¯æŒè¿™ä¸¤ç§è¡¨ç¤ºæ–¹å¼ã€‚&lt;/p&gt;

  &lt;p&gt;&lt;strong&gt;å…¼å®¹æ€§&lt;/strong&gt;ï¼šä¸€äº›æ—§çš„ç³»ç»Ÿæˆ–å­—ä½“å¯èƒ½åªæ”¯æŒåˆ†è§£å­—ç¬¦è¡¨ç¤ºæ³•ï¼Œå› æ­¤ï¼ŒUnicodeä¹Ÿä¿ç•™äº†è¿™ç§ç»„åˆå­—ç¬¦çš„æ–¹å¼ï¼Œä»¥æé«˜å…¼å®¹æ€§ã€‚&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;222-code-unit&quot;&gt;2.2.2 Code Unit&lt;/h3&gt;

&lt;p&gt;Code Unitä¹Ÿå«ç å…ƒï¼ˆä»£ç å•å…ƒï¼‰ï¼Œè¡¨ç¤ºè®¡ç®—æœºä¸­å®é™…å­˜å‚¨Unicodeçš„åŸºæœ¬å•ä½ï¼Œå–å†³äºç¼–ç æ–¹å¼ã€‚&lt;/p&gt;

&lt;p&gt;æ¯”å¦‚ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;UTF-8&lt;/code&gt;ï¼š &lt;code class=&quot;highlighter-rouge&quot;&gt;Code Unit&lt;/code&gt;æ˜¯ 1 å­—èŠ‚ï¼ˆ8 Bitï¼‰ï¼›æ¯”å¦‚ï¼š&lt;code class=&quot;highlighter-rouge&quot;&gt;a&lt;/code&gt;åœ¨UTF-8ç¼–ç ä¸‹å  1 ä¸ªå­—èŠ‚ï¼Œè¡¨ç¤ºä¸º&lt;code class=&quot;highlighter-rouge&quot;&gt;0x61&lt;/code&gt;ã€‚&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;UTF-16&lt;/code&gt;ï¼š &lt;code class=&quot;highlighter-rouge&quot;&gt;Code Unit&lt;/code&gt;æ˜¯ 2 å­—èŠ‚ï¼ˆ16 Bitï¼‰ï¼›æ¯”å¦‚ï¼š&lt;code class=&quot;highlighter-rouge&quot;&gt;a&lt;/code&gt;åœ¨UTF-16ç¼–ç ä¸‹å  2 ä¸ªå­—èŠ‚ï¼Œè¡¨ç¤ºä¸º&lt;code class=&quot;highlighter-rouge&quot;&gt;0x0061&lt;/code&gt;ã€‚&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;UTF-32&lt;/code&gt;ï¼š &lt;code class=&quot;highlighter-rouge&quot;&gt;Code Unit&lt;/code&gt;æ˜¯ 4 å­—èŠ‚ï¼ˆ32 Bitï¼‰ï¼›æ¯”å¦‚ï¼š&lt;code class=&quot;highlighter-rouge&quot;&gt;a&lt;/code&gt;åœ¨UTF-32ç¼–ç ä¸‹å  4 ä¸ªå­—èŠ‚ï¼Œè¡¨ç¤ºä¸º&lt;code class=&quot;highlighter-rouge&quot;&gt;0x00000061&lt;/code&gt;ã€‚&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&quot;ä¸‰å­—ç¬¦ç¼–ç æ–¹å¼&quot;&gt;ä¸‰ã€å­—ç¬¦ç¼–ç æ–¹å¼&lt;/h1&gt;

&lt;p&gt;å­—ç¬¦ç¼–ç æ–¹å¼å†³å®šäº†å­—ç¬¦å¦‚ä½•å­˜å‚¨ã€ä¼ è¾“å’Œè§£ç ï¼›å¸¸è§çš„ç¼–ç æ–¹å¼æœ‰ï¼šUTF-8ã€UTF-16ã€UTF-32ç­‰&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;UTF-8&lt;/code&gt;ï¼šå¯å˜é•¿åº¦ï¼Œç”¨ 1 åˆ° 4 ä¸ªå­—èŠ‚æ¥å­˜å‚¨ Unicode å­—ç¬¦ï¼›ä¸ºäº†èŠ‚çœå­˜å‚¨èµ„æºã€‚&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;UTF-16&lt;/code&gt;ï¼šå¯å˜é•¿åº¦ï¼Œç”¨ 2 æˆ– 4 ä¸ªå­—èŠ‚å­˜å‚¨å­—ç¬¦ã€‚&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;UTF-32&lt;/code&gt;ï¼šå›ºå®šé•¿åº¦ï¼Œæ¯ä¸ªå­—ç¬¦å§‹ç»ˆä½¿ç”¨ 4 å­—èŠ‚å­˜å‚¨ã€‚&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;æ¯”å¦‚ï¼š&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Ã©&lt;/code&gt;çš„Code Pointæ˜¯ï¼š&lt;code class=&quot;highlighter-rouge&quot;&gt;U+0065 + U+0301&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;å½“ä»¥&lt;code class=&quot;highlighter-rouge&quot;&gt;UTF-32&lt;/code&gt;æ–¹å¼ç¼–ç æ—¶ï¼Œæ¯ä¸ªCode Pointæœªè¶…è¿‡4å­—èŠ‚ï¼Œæ‰€ä»¥è¡¨ç¤ºä¸ºï¼š0x00000065ï¼Œ0x00000301&lt;/p&gt;

&lt;p&gt;å½“ä»¥&lt;code class=&quot;highlighter-rouge&quot;&gt;UTF-16&lt;/code&gt;æ–¹å¼ç¼–ç æ—¶ï¼Œæ¯ä¸ªCode Pointæœªè¶…è¿‡2å­—èŠ‚ï¼Œæ‰€ä»¥è¡¨ç¤ºä¸ºï¼š0x0065ï¼Œ0x0301&lt;/p&gt;

&lt;p&gt;å½“ä»¥&lt;code class=&quot;highlighter-rouge&quot;&gt;UTF-8&lt;/code&gt;æ–¹å¼ç¼–ç æ—¶ï¼Œ0x0301å€¼è¶…è¿‡äº†128ï¼Œéœ€è¦æŒ‰&lt;code class=&quot;highlighter-rouge&quot;&gt;UTF-8&lt;/code&gt;æ ¼å¼æ‹†åˆ†ä¸º0xCCï¼Œ0x81ï¼Œæ‰€ä»¥è¡¨ç¤ºä¸ºï¼š0x65ï¼Œ0xCCï¼Œ0x81&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Qï¼š&lt;code class=&quot;highlighter-rouge&quot;&gt;UTF-8&lt;/code&gt;ç¼–ç ä¸ºä»€ä¹ˆæ˜¯æŒ‰128åšæ¯”è¾ƒï¼ŒæŒ‰ç†è¯´1å­—èŠ‚ï¼ˆ0xFFï¼‰è¡¨ç¤ºçš„æœ€å¤§å€¼æ˜¯255ï¼Ÿ&lt;/p&gt;

  &lt;p&gt;Aï¼šæœ‰ä¸¤ä¸ªåŸå› ï¼šä¸€æ˜¯ä¸ºäº†ä¸&lt;code class=&quot;highlighter-rouge&quot;&gt;ASCII&lt;/code&gt;å…¼å®¹ï¼Œ&lt;code class=&quot;highlighter-rouge&quot;&gt;ASCII&lt;/code&gt;åªæ”¯æŒäº†128ä¸ªå­—ç¬¦ç¼–ç ï¼Œåœ¨&lt;code class=&quot;highlighter-rouge&quot;&gt;UTF-8&lt;/code&gt;ç¼–ç ä¸­ï¼Œå‰128ä½ä¸&lt;code class=&quot;highlighter-rouge&quot;&gt;ASCII&lt;/code&gt;ç¼–ç ç›¸åŒï¼›äºŒæ˜¯&lt;code class=&quot;highlighter-rouge&quot;&gt;UTF-8&lt;/code&gt;ç¼–ç ä¸­ï¼Œä¼šå°†ç¬¬ä¸€ä¸ªå­—èŠ‚çš„é«˜ä½éƒ¨åˆ†ç”¨æ¥æ ‡è¯†è¿™ä¸ªå­—ç¬¦çš„ç¼–ç é•¿åº¦ï¼Œå…·ä½“ä¸ºï¼š&lt;/p&gt;

  &lt;ul&gt;
    &lt;li&gt;
      &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;0xxxxxxx&lt;/code&gt;ï¼šè¡¨ç¤º 1 å­—èŠ‚å­—ç¬¦ï¼ˆ&lt;code class=&quot;highlighter-rouge&quot;&gt;ASCII&lt;/code&gt; èŒƒå›´ï¼‰&lt;/p&gt;
    &lt;/li&gt;
    &lt;li&gt;
      &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;110xxxxx&lt;/code&gt;ï¼šè¡¨ç¤º 2 å­—èŠ‚å­—ç¬¦&lt;/p&gt;
    &lt;/li&gt;
    &lt;li&gt;
      &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;1110xxxx&lt;/code&gt;ï¼šè¡¨ç¤º 3 å­—èŠ‚å­—ç¬¦&lt;/p&gt;
    &lt;/li&gt;
    &lt;li&gt;
      &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;11110xxx&lt;/code&gt;ï¼šè¡¨ç¤º 4 å­—èŠ‚å­—ç¬¦&lt;/p&gt;
    &lt;/li&gt;
  &lt;/ul&gt;

  &lt;p&gt;&lt;img src=&quot;/img/post/Font/UTF-8ç¼–ç è§„åˆ™.png&quot; alt=&quot;UTF-8ç¼–ç è§„åˆ™&quot; /&gt;&lt;/p&gt;
&lt;/blockquote&gt;
</description>
        <pubDate>Sat, 30 Aug 2025 00:00:00 +0800</pubDate>
        <link>http://localhost:4000/2025/08/30/%E4%B8%80%E6%96%87%E8%AF%BB%E6%87%82%E5%AD%97%E7%AC%A6%E4%B8%8E%E7%BC%96%E7%A0%81/</link>
        <guid isPermaLink="true">http://localhost:4000/2025/08/30/%E4%B8%80%E6%96%87%E8%AF%BB%E6%87%82%E5%AD%97%E7%AC%A6%E4%B8%8E%E7%BC%96%E7%A0%81/</guid>
        
        <category>è·¨ç«¯æ¸²æŸ“</category>
        
        <category>Font</category>
        
        
      </item>
    
  </channel>
</rss>
